const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DpA4kskq.js","assets/index-BpJXTtAJ.js","assets/index-p1ihFugn.css","assets/index-CEWaqLPw.js","assets/index-B9ZcXFYD.js","assets/index-CqXAStKb.js","assets/index-QgvgPLsJ.js","assets/index-DBtHm1U6.js","assets/index-CUy69ErP.js","assets/index-B_ud9Ues.js","assets/index-xzdjK3O5.js","assets/index-Cxr3E9bt.js","assets/index-BZc4-Gui.js","assets/index-CQnBVDN3.js","assets/index-B5Fb3rON.js","assets/dockerfile-BKs6k2Af.js","assets/simple-mode-GW_nhZxv.js","assets/factor-kuTfRLto.js","assets/nsis-LdVXkNf5.js","assets/pug-CIGw5rlb.js","assets/javascript-BO_2ioGC.js"])))=>i.map(i=>d[i]);
import{l as Ef,i as km,j as B,S as zr,U as wm,k as Sm,J as $n,n as Os,_ as S,m as Cm,g as Ka,o as Ge,p as Ze,q as _m,s as Am,t as Wo}from"./index-BpJXTtAJ.js";function Tm(r){return r.map(e=>e&&typeof e=="object"?Object.keys(e).map(t=>!!e[t]&&t):typeof e=="string"?e.split(/\s+/):[]).reduce((e,t)=>e.concat(t),[]).filter(e=>!!e)}function Ai(...r){return Tm(r).join(" ")}function Em(r,{ignore:e=[]}={}){return r.getAttributeNames().reduce((t,i)=>(i==="style"||e.includes(i)||(i.startsWith("data")||i.startsWith("aria")?t[i]=r.getAttribute(i):t[Ef.Text.camelCase(i)]=r.getAttribute(i)),t),{})}const Om="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%3e%3cpath%20class='jp-icon0'%20fill='%23000'%20d='M24%2020.188l-8.315-8.209%208.2-8.282-3.697-3.697-8.212%208.318-8.31-8.203-3.666%203.666%208.321%208.24-8.206%208.313%203.666%203.666%208.237-8.318%208.285%208.203z'%20/%3e%3c/svg%3e",Mm="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23000'%20fill-opacity='0.0'%20d='M24%2020.188l-8.315-8.209%208.2-8.282-3.697-3.697-8.212%208.318-8.31-8.203-3.666%203.666%208.321%208.24-8.206%208.313%203.666%203.666%208.237-8.318%208.285%208.203z'%20/%3e%3c/svg%3e",Rm="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20viewBox='0%200%2018%2018'%3e%3cpath%20fill='%23616161'%20d='M9%2013.5c-2.49%200-4.5-2.01-4.5-4.5S6.51%204.5%209%204.5c1.24%200%202.36.52%203.17%201.33L10%208h5V3l-1.76%201.76A6%206%200%200%200%209%203C5.69%203%203.01%205.69%203.01%209S5.69%2015%209%2015a5.98%205.98%200%200%200%205.9-5h-1.52c-.46%202-2.24%203.5-4.38%203.5'%20class='jp-icon3'/%3e%3c/svg%3e";var Oe={},kr={};let Of=0;const Mf=Object.create(null),Dm=["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","columns","counter-increment","counter-reset","flex","flex-grow","flex-positive","flex-shrink","flex-negative","flex-order","font-weight","grid-area","grid-column","grid-column-end","grid-column-span","grid-column-start","grid-row","grid-row-end","grid-row-span","grid-row-start","line-clamp","line-height","opacity","order","orphans","tab-size","widows","z-index","zoom","fill-opacity","flood-opacity","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width"];for(const r of Dm)for(const e of["-webkit-","-ms-","-moz-","-o-",""])Mf[e+r]=!0;function Pm(r){return r.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`).replace(/^ms-/,"-ms-")}function Lm(r){let e=5381,t=r.length;for(;t--;)e=e*33^r.charCodeAt(t);return(e>>>0).toString(36)}function Gl(r,e){return e&&typeof e=="number"&&!Mf[r]?`${r}:${e}px`:`${r}:${e}`}function Ul(r){return r.sort((e,t)=>e[0]>t[0]?1:-1)}function Im(r,e){const t=[],i=[];for(const n of Object.keys(r)){const s=n.trim(),o=r[n];s.charCodeAt(0)!==36&&o!=null&&(typeof o=="object"&&!Array.isArray(o)?i.push([s,o]):t.push([Pm(s),o]))}return{style:Nm(Ul(t)),nested:e?i:Ul(i),isUnique:!!r.$unique}}function Nm(r){return r.map(([e,t])=>Array.isArray(t)?t.map(i=>Gl(e,i)).join(";"):Gl(e,t)).join(";")}function Rf(r,e){return r.indexOf("&")===-1?`${e} ${r}`:r.replace(/&/g,e)}function On(r,e,t,i,n){const{style:s,nested:o,isUnique:a}=Im(e,r!=="");let l=s;if(r.charCodeAt(0)===64){const h={selector:r,styles:[],rules:[],style:n?"":s};t.push(h),s&&n&&h.styles.push({selector:n,style:s,isUnique:a});for(const[c,f]of o)l+=c+On(c,f,h.rules,h.styles,n)}else{const h=n?Rf(r,n):r;s&&i.push({selector:h,style:s,isUnique:a});for(const[c,f]of o)l+=c+On(c,f,t,i,h)}return l}function Vr(r,e,t,i,n,s){for(const{selector:o,style:a,isUnique:l}of i){const h=s?Rf(o,n):o,c=l?`u\0${(++Of).toString(36)}`:`s\0${e}\0${a}`,f=new Ms(a,c);f.add(new Pf(h,`k\0${e}\0${h}`)),r.add(f)}for(const{selector:o,style:a,rules:l,styles:h}of t){const c=new Ja(o,a,`r\0${e}\0${o}\0${a}`);Vr(c,e,l,h,n,s),r.add(c)}}function Df(r){let e="";for(let t=0;t<r.length;t++)e+=r[t];return e}const Bm={add:()=>{},change:()=>{},remove:()=>{}};class Lt{constructor(e=Bm){this.changes=e,this.sheet=[],this.changeId=0,this._keys=[],this._children=Object.create(null),this._counters=Object.create(null)}add(e){const t=this._counters[e.id]||0,i=this._children[e.id]||e.clone();if(this._counters[e.id]=t+1,t===0)this._children[i.id]=i,this._keys.push(i.id),this.sheet.push(i.getStyles()),this.changeId++,this.changes.add(i,this._keys.length-1);else if(i instanceof Lt&&e instanceof Lt){const n=this._keys.indexOf(e.id),s=i.changeId;i.merge(e),i.changeId!==s&&(this.sheet.splice(n,1,i.getStyles()),this.changeId++,this.changes.change(i,n,n))}}remove(e){const t=this._counters[e.id];if(t){this._counters[e.id]=t-1;const i=this._children[e.id],n=this._keys.indexOf(i.id);if(t===1)delete this._counters[e.id],delete this._children[e.id],this._keys.splice(n,1),this.sheet.splice(n,1),this.changeId++,this.changes.remove(i,n);else if(i instanceof Lt&&e instanceof Lt){const s=i.changeId;i.unmerge(e),i.changeId!==s&&(this.sheet.splice(n,1,i.getStyles()),this.changeId++,this.changes.change(i,n,n))}}}values(){return this._keys.map(e=>this._children[e])}merge(e){for(const t of e.values())this.add(t);return this}unmerge(e){for(const t of e.values())this.remove(t);return this}clone(){return new Lt().merge(this)}}class Pf{constructor(e,t){this.selector=e,this.id=t}getStyles(){return this.selector}clone(){return this}}class Ms extends Lt{constructor(e,t){super(),this.style=e,this.id=t}getStyles(){return`${this.sheet.join(",")}{${this.style}}`}clone(){return new Ms(this.style,this.id).merge(this)}}let Ja=class Lf extends Lt{constructor(e,t,i){super(),this.rule=e,this.style=t,this.id=i}getStyles(){return`${this.rule}{${this.style}${Df(this.sheet)}}`}clone(){return new Lf(this.rule,this.style,this.id).merge(this)}};function Kl(r,e){return`f${Lm(r)}`}class Rs extends Lt{constructor(e,t){super(t),this.id=e}registerStyle(e){const t=[],i=[],n=On("&",e,t,i),s=Kl(n),o=`.${s}`;return Vr(this,n,t,i,o,!0),s}registerKeyframes(e){return this.registerHashRule("@keyframes",e)}registerHashRule(e,t){const i=[],n=[],s=On("",t,i,n),o=Kl(s),a=`${e} ${o}`,l=new Ja(a,"",`h\0${s}\0${e}`);return Vr(l,s,i,n,"",!1),this.add(l),o}registerRule(e,t){const i=[],n=[],s=On(e,t,i,n);Vr(this,s,i,n,"",!1)}registerCss(e){return this.registerRule("",e)}getStyles(){return Df(this.sheet)}clone(){return new Rs(this.id,this.changes).merge(this)}}function jm(r){return new Rs(`f${(++Of).toString(36)}`,r)}const Fm=Object.freeze(Object.defineProperty({__proto__:null,Cache:Lt,FreeStyle:Rs,Rule:Ja,Selector:Pf,Style:Ms,create:jm},Symbol.toStringTag,{value:"Module"})),$m=km(Fm);var pn={},Jl;function zm(){if(Jl)return pn;Jl=1,Object.defineProperty(pn,"__esModule",{value:!0});function r(t){var i={};for(var n in t){var s=t[n];if(n==="$nest"){var o=s;for(var a in o){var l=o[a];i[a]=r(l)}}else n==="$debugName"?i.$displayName=s:i[n]=s}return i}pn.convertToStyles=r;function e(t){var i={};for(var n in t)n!=="$debugName"&&(i[n]=t[n]);return t.$debugName&&(i.$displayName=t.$debugName),i}return pn.convertToKeyframes=e,pn}var vi={},Yl;function If(){if(Yl)return vi;Yl=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.raf=typeof requestAnimationFrame>"u"?function(i){return setTimeout(i)}:typeof window>"u"?requestAnimationFrame:requestAnimationFrame.bind(window);function r(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.map(function(s){return s&&typeof s=="object"?Object.keys(s).map(function(o){return!!s[o]&&o}):[s]}).reduce(function(s,o){return s.concat(o)},[]).filter(function(s){return!!s}).join(" ")}vi.classes=r;function e(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];for(var s={},o=0,a=i;o<a.length;o++){var l=a[o];if(!(l==null||l===!1))for(var h in l){var c=l[h];!c&&c!==0||(h==="$nest"&&c?s[h]=s.$nest?e(s.$nest,c):c:h.indexOf("&")!==-1||h.indexOf("@media")===0?s[h]=s[h]?e(s[h],c):c:s[h]=c)}}return s}vi.extend=e,vi.media=function(i){for(var n,s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];var a=[];i.type&&a.push(i.type),i.orientation&&a.push("(orientation: "+i.orientation+")"),i.minWidth&&a.push("(min-width: "+t(i.minWidth)+")"),i.maxWidth&&a.push("(max-width: "+t(i.maxWidth)+")"),i.minHeight&&a.push("(min-height: "+t(i.minHeight)+")"),i.maxHeight&&a.push("(max-height: "+t(i.maxHeight)+")"),i.prefersColorScheme&&a.push("(prefers-color-scheme: "+i.prefersColorScheme+")");var l="@media "+a.join(" and "),h={$nest:(n={},n[l]=e.apply(void 0,s),n)};return h};var t=function(i){return typeof i=="string"?i:i+"px"};return vi}var Xl;function Vm(){if(Xl)return kr;Xl=1,Object.defineProperty(kr,"__esModule",{value:!0});var r=$m,e=zm(),t=If(),i=function(){return r.create()},n=(function(){function s(o){var a=this,l=o.autoGenerateTag;this.cssRaw=function(c){c&&(a._raw+=c||"",a._pendingRawChange=!0,a._styleUpdated())},this.cssRule=function(c){for(var f=[],u=1;u<arguments.length;u++)f[u-1]=arguments[u];var d=e.convertToStyles(t.extend.apply(void 0,f));a._freeStyle.registerRule(c,d),a._styleUpdated()},this.forceRenderStyles=function(){var c=a._getTag();c&&(c.textContent=a.getStyles())},this.fontFace=function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];for(var u=a._freeStyle,d=0,p=c;d<p.length;d++){var m=p[d];u.registerRule("@font-face",m)}a._styleUpdated()},this.getStyles=function(){return(a._raw||"")+a._freeStyle.getStyles()},this.keyframes=function(c){var f=e.convertToKeyframes(c),u=a._freeStyle.registerKeyframes(f);return a._styleUpdated(),u},this.reinit=function(){var c=i();a._freeStyle=c,a._lastFreeStyleChangeId=c.changeId,a._raw="",a._pendingRawChange=!1;var f=a._getTag();f&&(f.textContent="")},this.setStylesTarget=function(c){a._tag&&(a._tag.textContent=""),a._tag=c,a.forceRenderStyles()},this.stylesheet=function(c){for(var f=Object.getOwnPropertyNames(c),u={},d=0,p=f;d<p.length;d++){var m=p[d],g=c[m];g&&(g.$debugName=m,u[m]=a.style(g))}return u};var h=i();this._autoGenerateTag=l,this._freeStyle=h,this._lastFreeStyleChangeId=h.changeId,this._pending=0,this._pendingRawChange=!1,this._raw="",this._tag=void 0,this.style=this.style.bind(this)}return s.prototype._afterAllSync=function(o){var a=this;this._pending++;var l=this._pending;t.raf(function(){l===a._pending&&o()})},s.prototype._getTag=function(){if(this._tag)return this._tag;if(this._autoGenerateTag){var o=typeof window>"u"?{textContent:""}:document.createElement("style");return typeof document<"u"&&document.head.appendChild(o),this._tag=o,o}},s.prototype._styleUpdated=function(){var o=this,a=this._freeStyle.changeId,l=this._lastFreeStyleChangeId;!this._pendingRawChange&&a===l||(this._lastFreeStyleChangeId=a,this._pendingRawChange=!1,this._afterAllSync(function(){return o.forceRenderStyles()}))},s.prototype.style=function(){var o=this._freeStyle.registerStyle(e.convertToStyles(t.extend.apply(void 0,arguments)));return this._styleUpdated(),o},s})();return kr.TypeStyle=n,kr}var Ys={},Ql;function Wm(){return Ql||(Ql=1,Object.defineProperty(Ys,"__esModule",{value:!0})),Ys}var Zl;function Hm(){if(Zl)return Oe;Zl=1,Object.defineProperty(Oe,"__esModule",{value:!0});var r=Vm();Oe.TypeStyle=r.TypeStyle;var e=Wm();Oe.types=e;var t=If();Oe.extend=t.extend,Oe.classes=t.classes,Oe.media=t.media;var i=new r.TypeStyle({autoGenerateTag:!0});Oe.setStylesTarget=i.setStylesTarget,Oe.cssRaw=i.cssRaw,Oe.cssRule=i.cssRule,Oe.forceRenderStyles=i.forceRenderStyles,Oe.fontFace=i.fontFace,Oe.getStyles=i.getStyles,Oe.keyframes=i.keyframes,Oe.reinit=i.reinit,Oe.style=i.style,Oe.stylesheet=i.stylesheet;function n(s){var o=new r.TypeStyle({autoGenerateTag:!1});return s&&o.setStylesTarget(s),o}return Oe.createTypeStyle=n,Oe}var qm=Hm(),Zi;(function(r){const e={breadCrumb:{container:{$nest:{"&:first-child svg":{bottom:"1px",marginLeft:"0px",position:"relative"},"&:hover":{backgroundColor:"var(--jp-layout-color2)"},".jp-mod-dropTarget&":{backgroundColor:"var(--jp-brand-color2)",opacity:.7}}},element:{borderRadius:"var(--jp-border-radius)",cursor:"pointer",margin:"0px 2px",padding:"0px 2px",height:"16px",width:"16px",verticalAlign:"middle"}},commandPaletteHeader:{container:{height:"14px",margin:"0 14px 0 auto"},element:{height:"14px",width:"14px"},options:{elementPosition:"center"}},commandPaletteItem:{element:{height:"16px",width:"16px"},options:{elementPosition:"center"}},launcherCard:{container:{height:"52px",width:"52px"},element:{height:"52px",width:"52px"},options:{elementPosition:"center"}},launcherSection:{container:{boxSizing:"border-box",marginRight:"12px",height:"32px",width:"32px"},element:{height:"32px",width:"32px"},options:{elementPosition:"center"}},listing:{container:{flex:"0 0 20px",marginRight:"4px",position:"relative"},element:{height:"16px",width:"16px"},options:{elementPosition:"center"}},listingHeaderItem:{container:{display:"inline",height:"16px",width:"16px"},element:{height:"auto",margin:"-2px 0 0 0",width:"20px"},options:{elementPosition:"center"}},mainAreaTab:{container:{$nest:{".lm-DockPanel-tabBar &":{marginRight:"4px"}}},element:{$nest:{".lm-DockPanel-tabBar &":{height:"14px",width:"14px"}}},options:{elementPosition:"center"}},menuItem:{container:{display:"inline-block",verticalAlign:"middle"},element:{height:"16px",width:"16px"},options:{elementPosition:"center"}},runningItem:{container:{margin:"0px 4px 0px 4px"},element:{height:"16px",width:"16px"},options:{elementPosition:"center"}},select:{container:{pointerEvents:"none"},element:{position:"absolute",height:"auto",width:"16px"}},settingsEditor:{container:{display:"flex",flex:"0 0 20px",margin:"0 3px 0 0",position:"relative",height:"20px",width:"20px"},element:{height:"16px",width:"16px"},options:{elementPosition:"center"}},sideBar:{element:{height:"auto",width:"20px"},options:{elementPosition:"center"}},splash:{container:{animation:"0.3s fade-in linear forwards",height:"100%",width:"100%",zIndex:1},element:{width:"100px"},options:{elementPosition:"center"}},statusBar:{element:{left:"0px",top:"0px",height:"18px",width:"20px",position:"relative"}},toolbarButton:{container:{display:"inline-block",verticalAlign:"middle"},element:{height:"16px",width:"16px"},options:{elementPosition:"center"}}};function t(u){return{container:{alignItems:"center",display:"flex"},element:{display:"block",...u}}}const i={center:t({margin:"0 auto",width:"100%"}),top:t({margin:"0 0 auto 0"}),right:t({margin:"0 0 0 auto"}),bottom:t({margin:"auto 0 0 0"}),left:t({margin:"0 auto 0 0"}),"top right":t({margin:"0 0 auto auto"}),"bottom right":t({margin:"auto 0 0 auto"}),"bottom left":t({margin:"auto auto 0 0"}),"top left":t({margin:"0 auto 0 auto"})};function n(u){return{element:{height:u,width:u}}}const s={small:n("14px"),normal:n("16px"),large:n("20px"),xlarge:n("24px")};function o(u){return{container:Object.assign({},...u.map(d=>d.container)),element:Object.assign({},...u.map(d=>d.element))}}function a(u){return u?(Array.isArray(u)||(u=[u]),u.map(d=>typeof d=="string"?e[d]:d)):[]}function l(u){const d=Object.assign({},...u.map(p=>p.options));return d.elementPosition&&u.unshift(i[d.elementPosition]),d.elementSize&&u.unshift(s[d.elementSize]),o(u)}function h(u){var d;return qm.style({...u.container,$nest:{...(d=u.container)===null||d===void 0?void 0:d.$nest,svg:u.element}})}const c=new Map;function f(u){if(!u||Object.keys(u).length===0)return"";let{elementPosition:d,elementSize:p,stylesheet:m,...g}=u;const b={...d&&{elementPosition:d},...p&&{elementSize:p}},y=typeof m=="string"&&Object.keys(g).length===0,x=y?[m,d,p].join(","):"";if(y&&c.has(x))return c.get(x);const E=a(m);E.push({element:g,options:b});const A=h(l(E));return y&&c.set(x,A),A}r.styleClass=f})(Zi||(Zi={}));class _e{static remove(e){for(;e.firstChild;)e.firstChild.remove();return e.className="",e}static resolve({icon:e}){if(e instanceof _e)return e;if(typeof e=="string"){const t=_e._instances.get(e);return t||(_e._debug&&console.warn(`Lookup failed for icon, creating loading icon. icon: ${e}`),new _e({name:e,svgstr:Rm,_loading:!0}))}return new _e(e)}static resolveElement({icon:e,iconClass:t,fallback:i,...n}){return Pt.isResolvable(e)?_e.resolve({icon:e}).element(n):!t&&i?i.element(n):(n.className=Ai(t,n.className),Pt.blankElement(n))}static resolveReact({icon:e,iconClass:t,fallback:i,...n}){if(!Pt.isResolvable(e))return!t&&i?B.createElement(i.react,{...n}):(n.className=Ai(t,n.className),B.createElement(Pt.blankReact,{...n}));const s=_e.resolve({icon:e});return B.createElement(s.react,{...n})}static resolveSvg({name:e,svgstr:t}){const i=new DOMParser().parseFromString(Pt.svgstrShim(t),"image/svg+xml"),n=i.querySelector("parsererror");if(n){const s=`SVG HTML was malformed for LabIcon instance.
name: ${e}, svgstr: ${t}`;return _e._debug?(console.error(s),n):(console.warn(s),null)}else return i.documentElement}static toggleDebug(e){_e._debug=e??!_e._debug}constructor({name:e,svgstr:t,render:i,unrender:n,_loading:s=!1}){if(this._props={},this._svgReplaced=new zr(this),this._svgElement=void 0,this._svgInnerHTML=void 0,this._svgReactAttrs=void 0,!(e&&t))return console.error(`When defining a new LabIcon, name and svgstr must both be non-empty strings. name: ${e}, svgstr: ${t}`),Gm;if(this._loading=s,_e._instances.has(e)){const o=_e._instances.get(e);return this._loading?(o.svgstr=t,this._loading=!1,o):(_e._debug&&console.warn(`Redefining previously loaded icon svgstr. name: ${e}, svgstrOld: ${o.svgstr}, svgstr: ${t}`),o.svgstr=t,o)}this.name=e,this.react=this._initReact(e),this.svgstr=t,this._initRender({render:i,unrender:n}),_e._instances.set(this.name,this)}bindprops(e){const t=Object.create(this);return t._props=e,t.react=t._initReact(t.name+"_bind"),t}element(e={}){var t;let{className:i,container:n,label:s,title:o,tag:a="div",...l}={...this._props,...e};const h=n?.firstChild;if(((t=h?.dataset)===null||t===void 0?void 0:t.iconId)===this._uuid)return h;if(!this.svgElement)return document.createElement("div");if(n)for(;n.firstChild;)n.firstChild.remove();else a&&(n=document.createElement(a));const c=this.svgElement.cloneNode(!0);return n?(s!=null&&(n.textContent=s),Pt.initContainer({container:n,className:i,styleProps:l,title:o}),n.appendChild(c),n):(s&&console.warn(),c)}render(e,t){var i;let n=(i=t?.children)===null||i===void 0?void 0:i[0];typeof n!="string"&&(n=void 0),this.element({container:e,label:n,...t?.props})}get svgElement(){return this._svgElement===void 0&&(this._svgElement=this._initSvg({uuid:this._uuid})),this._svgElement}get svgInnerHTML(){return this._svgInnerHTML===void 0&&(this.svgElement===null?this._svgInnerHTML=null:this._svgInnerHTML=this.svgElement.innerHTML),this._svgInnerHTML}get svgReactAttrs(){return this._svgReactAttrs===void 0&&(this.svgElement===null?this._svgReactAttrs=null:this._svgReactAttrs=Em(this.svgElement,{ignore:["data-icon-id"]})),this._svgReactAttrs}get svgstr(){return this._svgstr}set svgstr(e){this._svgstr=e;const t=wm.uuid4(),i=this._uuid;this._uuid=t,this._svgElement=void 0,this._svgInnerHTML=void 0,this._svgReactAttrs=void 0,document.querySelectorAll(`[data-icon-id="${i}"]`).forEach(n=>{this.svgElement&&n.replaceWith(this.svgElement.cloneNode(!0))}),this._svgReplaced.emit()}_initReact(e){const t=B.forwardRef((i={},n)=>{const{className:s,container:o,label:a,title:l,slot:h,tag:c="div",...f}={...this._props,...i},[,u]=B.useState(this._uuid);B.useEffect(()=>{const g=()=>{u(this._uuid)};return this._svgReplaced.connect(g),()=>{this._svgReplaced.disconnect(g)}});const d=c??B.Fragment;if(!(this.svgInnerHTML&&this.svgReactAttrs))return B.createElement(B.Fragment,null);const p={...this.svgReactAttrs};c||Object.assign(p,{className:s||f?Ai(s,Zi.styleClass(f)):void 0,title:l,slot:h});const m=B.createElement("svg",{...p,...this.svgReactAttrs,dangerouslySetInnerHTML:{__html:this.svgInnerHTML},ref:n});if(o)return Pt.initContainer({container:o,className:s,styleProps:f,title:l}),B.createElement(B.Fragment,null,m,a);{let g={};return d!==B.Fragment&&(g={className:s||f?Ai(s,Zi.styleClass(f)):void 0,title:l,slot:h}),B.createElement(d,{...g},m,a)}});return t.displayName=`LabIcon_${e}`,t}_initRender({render:e,unrender:t}){e?(this.render=e,t&&(this.unrender=t)):t&&console.warn("In _initRender, ignoring unrender arg since render is undefined")}_initSvg({title:e,uuid:t}={}){const i=_e.resolveSvg(this);return i&&(i.tagName!=="parsererror"&&(i.dataset.icon=this.name,t&&(i.dataset.iconId=t),e?Pt.setTitleSvg(i,e):i.setAttribute("aria-hidden","true")),i)}}_e._debug=!1;_e._instances=new Map;var Pt;(function(r){function e({className:h="",container:c,label:f,title:u,tag:d="div",slot:p,...m}){if(c?.className===h)return c;if(c)for(;c.firstChild;)c.firstChild.remove();else c=document.createElement(d??"div");return f!=null&&(c.textContent=f),r.initContainer({container:c,className:h,styleProps:m,title:u}),c}r.blankElement=e,r.blankReact=B.forwardRef(({className:h="",container:c,label:f,title:u,tag:d="div",...p},m)=>{const g=d??"div";return c?(t({container:c,className:h,styleProps:p,title:u}),B.createElement(B.Fragment,null)):B.createElement(g,{className:Ai(h,Zi.styleClass(p))},m&&Um.react({ref:m}),f)}),r.blankReact.displayName="BlankReact";function t({container:h,className:c,styleProps:f,title:u}){u!=null&&(h.title=u);const d=Zi.styleClass(f);if(c!=null){const p=Ai(c,d);return h.className=p,p}else return d?(h.classList.add(d),d):""}r.initContainer=t;function i(h){return!!(h&&(typeof h=="string"||h.name&&h.svgstr))}r.isResolvable=i;function n(h,c){const f=h.getElementsByTagName("title");if(f.length)f[0].textContent=c;else{const u=document.createElement("title");u.textContent=c,h.appendChild(u)}}r.setTitleSvg=n;function s(h,c=!0){const[,f,u]=decodeURIComponent(h).replace(/>\s*\n\s*</g,"><").replace(/\s*\n\s*/g," ").match(c?/^(?:data:.*?(;base64)?,)?(.*)/:/(?:(base64).*)?(<svg.*)/);return f?atob(u):u}r.svgstrShim=s;class o{constructor(c,f){this._icon=c,this._rendererOptions=f}render(c,f){}}r.Renderer=o;class a extends o{render(c,f){var u,d;let p=(u=f?.children)===null||u===void 0?void 0:u[0];typeof p!="string"&&(p=void 0),this._icon.element({container:c,label:p,...(d=this._rendererOptions)===null||d===void 0?void 0:d.props,...f?.props})}}r.ElementRenderer=a;class l extends o{constructor(){super(...arguments),this._rootDOM=null}render(c,f){var u,d;let p=(u=f?.children)===null||u===void 0?void 0:u[0];typeof p!="string"&&(p=void 0);const m=this._icon;this._rootDOM!==null&&this._rootDOM.unmount(),this._rootDOM=Sm.createRoot(c),this._rootDOM.render(B.createElement(m.react,{container:c,label:p,...(d=this._rendererOptions)===null||d===void 0?void 0:d.props,...f?.props}))}unrender(c){this._rootDOM!==null&&(this._rootDOM.unmount(),this._rootDOM=null)}}r.ReactRenderer=l})(Pt||(Pt={}));const Gm=new _e({name:"ui-components:bad",svgstr:Om}),Um=new _e({name:"ui-components:blank",svgstr:Mm});function Km(r){const{className:e,inputRef:t,rightIcon:i,...n}=r;return B.createElement("div",{className:Ai("jp-InputGroup",e)},B.createElement("input",{ref:t,...n}),i&&B.createElement("span",{className:"jp-InputGroupAction"},typeof i=="string"?B.createElement(_e.resolveReact,{icon:i,elementPosition:"center",tag:"span"}):B.createElement(i.react,{elementPosition:"center",tag:"span"})))}var Ho;(function(r){r.defaultMimeType="text/plain"})(Ho||(Ho={}));const Jm="jp-mod-completer-enabled",Ym="jp-mod-completer-active",Xm="jp-mod-at-line-beginning";let qo=[],Nf=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?Nf:qo).push(t=t+r[e])})();function Qm(r){if(r<768)return!1;for(let e=0,t=qo.length;;){let i=e+t>>1;if(r<qo[i])t=i;else if(r>=Nf[i])e=i+1;else return!0;if(e==t)return!1}}function eh(r){return r>=127462&&r<=127487}const th=8205;function Zm(r,e,t=!0,i=!0){return(t?Bf:eg)(r,e,i)}function Bf(r,e,t){if(e==r.length)return e;e&&jf(r.charCodeAt(e))&&Ff(r.charCodeAt(e-1))&&e--;let i=Xs(r,e);for(e+=ih(i);e<r.length;){let n=Xs(r,e);if(i==th||n==th||t&&Qm(n))e+=ih(n),i=n;else if(eh(n)){let s=0,o=e-2;for(;o>=0&&eh(Xs(r,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function eg(r,e,t){for(;e>0;){let i=Bf(r,e-2,t);if(i<e)return i;e--}return 0}function Xs(r,e){let t=r.charCodeAt(e);if(!Ff(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return jf(i)?(t-55296<<10)+(i-56320)+65536:t}function jf(r){return r>=56320&&r<57344}function Ff(r){return r>=55296&&r<56320}function ih(r){return r<65536?1:2}class fe{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=en(this,e,t);let n=[];return this.decompose(0,e,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(t,this.length,n,1),It.from(n,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=en(this,e,t);let i=[];return this.decompose(e,t,i,0),It.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),n=new Mn(this),s=new Mn(e);for(let o=t,a=t;;){if(n.next(o),s.next(o),o=0,n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return!1;if(a+=n.value.length,n.done||a>=i)return!0}}iter(e=1){return new Mn(this,e)}iterRange(e,t=this.length){return new $f(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let n=this.line(e).from;i=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new zf(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?fe.empty:e.length<=32?new Ae(e):It.from(Ae.split(e,[]))}}class Ae extends fe{constructor(e,t=tg(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,n){for(let s=0;;s++){let o=this.text[s],a=n+o.length;if((t?i:a)>=e)return new ig(n,a,i,o);n=a+1,i++}}decompose(e,t,i,n){let s=e<=0&&t>=this.length?this:new Ae(nh(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(n&1){let o=i.pop(),a=Wr(s.text,o.text.slice(),0,s.length);if(a.length<=32)i.push(new Ae(a,o.length+s.length));else{let l=a.length>>1;i.push(new Ae(a.slice(0,l)),new Ae(a.slice(l)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Ae))return super.replace(e,t,i);[e,t]=en(this,e,t);let n=Wr(this.text,Wr(i.text,nh(this.text,0,e)),t),s=this.length+i.length-(t-e);return n.length<=32?new Ae(n,s):It.from(Ae.split(n,[]),s)}sliceString(e,t=this.length,i=`
`){[e,t]=en(this,e,t);let n="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(n+=i),e<l&&t>s&&(n+=a.slice(Math.max(0,e-s),t-s)),s=l+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],n=-1;for(let s of e)i.push(s),n+=s.length+1,i.length==32&&(t.push(new Ae(i,n)),i=[],n=-1);return n>-1&&t.push(new Ae(i,n)),t}}class It extends fe{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,n){for(let s=0;;s++){let o=this.children[s],a=n+o.length,l=i+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,i,n);n=a+1,i=l+1}}decompose(e,t,i,n){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&t>=o){let h=n&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!h?i.push(a):a.decompose(e-o,t-o,i,h)}o=l+1}}replace(e,t,i){if([e,t]=en(this,e,t),i.lines<this.lines)for(let n=0,s=0;n<this.children.length;n++){let o=this.children[n],a=s+o.length;if(e>=s&&t<=a){let l=o.replace(e-s,t-s,i),h=this.lines-o.lines+l.lines;if(l.lines<h>>4&&l.lines>h>>6){let c=this.children.slice();return c[n]=l,new It(c,this.length-(t-e)+i.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=en(this,e,t);let n="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(n+=i),e<l&&t>o&&(n+=a.sliceString(e-o,t-o,i)),o=l+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof It))return 0;let i=0,[n,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,s+=t){if(n==o||s==a)return i;let l=this.children[n],h=e.children[s];if(l!=h)return i+l.scanIdentical(h,t);i+=l.length+1}}static from(e,t=e.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let d of e)i+=d.lines;if(i<32){let d=[];for(let p of e)p.flatten(d);return new Ae(d,t)}let n=Math.max(32,i>>5),s=n<<1,o=n>>1,a=[],l=0,h=-1,c=[];function f(d){let p;if(d.lines>s&&d instanceof It)for(let m of d.children)f(m);else d.lines>o&&(l>o||!l)?(u(),a.push(d)):d instanceof Ae&&l&&(p=c[c.length-1])instanceof Ae&&d.lines+p.lines<=32?(l+=d.lines,h+=d.length+1,c[c.length-1]=new Ae(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>n&&u(),l+=d.lines,h+=d.length+1,c.push(d))}function u(){l!=0&&(a.push(c.length==1?c[0]:It.from(c,h)),h=-1,l=c.length=0)}for(let d of e)f(d);return u(),a.length==1?a[0]:new It(a,t)}}fe.empty=new Ae([""],0);function tg(r){let e=-1;for(let t of r)e+=t.length+1;return e}function Wr(r,e,t=0,i=1e9){for(let n=0,s=0,o=!0;s<r.length&&n<=i;s++){let a=r[s],l=n+a.length;l>=t&&(l>i&&(a=a.slice(0,i-n)),n<t&&(a=a.slice(t-n)),o?(e[e.length-1]+=a,o=!1):e.push(a)),n=l+1}return e}function nh(r,e,t){return Wr(r,[""],e,t)}class Mn{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Ae?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],s=this.offsets[i],o=s>>1,a=n instanceof Ae?n.text.length:n.children.length;if(o==(t>0?a:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(n instanceof Ae){let l=n.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=n.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof Ae?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class $f{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Mn(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*t,this.value=n.length<=i?n:t<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class zf{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:n}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(fe.prototype[Symbol.iterator]=function(){return this.iter()},Mn.prototype[Symbol.iterator]=$f.prototype[Symbol.iterator]=zf.prototype[Symbol.iterator]=function(){return this});class ig{constructor(e,t,i,n){this.from=e,this.to=t,this.number=i,this.text=n}get length(){return this.to-this.from}}function en(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function Me(r,e,t=!0,i=!0){return Zm(r,e,t,i)}function ng(r){return r>=56320&&r<57344}function rg(r){return r>=55296&&r<56320}function gi(r,e){let t=r.charCodeAt(e);if(!rg(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return ng(i)?(t-55296<<10)+(i-56320)+65536:t}function Vf(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function rr(r){return r<65536?1:2}const Go=/\r\n?|\n/;var Je=(function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r})(Je||(Je={}));class qt{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,n=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,n,s),n+=s):n+=o,i+=s}}iterChangedRanges(e,t=!1){Uo(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];n<0?e.push(i,n):e.push(n,i)}return new qt(e)}composeDesc(e){return this.empty?e:e.empty?this:Wf(this,e)}mapDesc(e,t=!1){return e.empty?this:Ko(this,e,t)}mapPos(e,t=-1,i=Je.Simple){let n=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],h=n+a;if(l<0){if(h>e)return s+(e-n);s+=a}else{if(i!=Je.Simple&&h>=e&&(i==Je.TrackDel&&n<e&&h>e||i==Je.TrackBefore&&n<e||i==Je.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!a)return e==n||t<0?s:s+l;s+=l}n=h}if(e>n)throw new RangeError(`Position ${e} is out of range for changeset of length ${n}`);return s}touchesRange(e,t=e){for(let i=0,n=0;i<this.sections.length&&n<=t;){let s=this.sections[i++],o=this.sections[i++],a=n+s;if(o>=0&&n<=t&&a>=e)return n<e&&a>t?"cover":!0;n=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+i+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new qt(e)}static create(e){return new qt(e)}}class Ie extends qt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Uo(this,(t,i,n,s,o)=>e=e.replace(n,n+(i-t),o),!1),e}mapDesc(e,t=!1){return Ko(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let n=0,s=0;n<t.length;n+=2){let o=t[n],a=t[n+1];if(a>=0){t[n]=a,t[n+1]=o;let l=n>>1;for(;i.length<l;)i.push(fe.empty);i.push(o?e.slice(s,s+o):fe.empty)}s+=o}return new Ie(t,i)}compose(e){return this.empty?e:e.empty?this:Wf(this,e,!0)}map(e,t=!1){return e.empty?this:Ko(this,e,t,!0)}iterChanges(e,t=!1){Uo(this,e,t)}get desc(){return qt.create(this.sections)}filter(e){let t=[],i=[],n=[],s=new zn(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);Ue(n,c,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;Ue(t,c,f),f>0&&ii(i,t,s.text),s.forward(c),a+=c}let h=e[o++];for(;a<h;){if(s.done)break e;let c=Math.min(s.len,h-a);Ue(t,c,-1),Ue(n,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new Ie(t,i),filtered:qt.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],n=this.sections[t+1];n<0?e.push(i):n==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let n=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!n.length)return;o<t&&Ue(n,t-o,-1);let f=new Ie(n,s);a=a?a.compose(f.map(a)):f,n=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let f of c)h(f);else if(c instanceof Ie){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:f,to:u=f,insert:d}=c;if(f>u||f<0||u>t)throw new RangeError(`Invalid change range ${f} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?fe.of(d.split(i||Go)):d:fe.empty,m=p.length;if(f==u&&m==0)return;f<o&&l(),f>o&&Ue(n,f-o,-1),Ue(n,u-f,m),ii(s,n,p),o=u}}return h(e),l(!a),a}static empty(e){return new Ie(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let n=0;n<e.length;n++){let s=e[n];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<n;)i.push(fe.empty);i[n]=fe.of(s.slice(1)),t.push(s[0],i[n].length)}}}return new Ie(t,i)}static createSet(e,t){return new Ie(e,t)}}function Ue(r,e,t,i=!1){if(e==0&&t<=0)return;let n=r.length-2;n>=0&&t<=0&&t==r[n+1]?r[n]+=e:n>=0&&e==0&&r[n]==0?r[n+1]+=t:i?(r[n]+=e,r[n+1]+=t):r.push(e,t)}function ii(r,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<i;)r.push(fe.empty);r.push(t)}}function Uo(r,e,t){let i=r.inserted;for(let n=0,s=0,o=0;o<r.sections.length;){let a=r.sections[o++],l=r.sections[o++];if(l<0)n+=a,s+=a;else{let h=n,c=s,f=fe.empty;for(;h+=a,c+=l,l&&i&&(f=f.append(i[o-2>>1])),!(t||o==r.sections.length||r.sections[o+1]<0);)a=r.sections[o++],l=r.sections[o++];e(n,h,s,c,f),n=h,s=c}}}function Ko(r,e,t,i=!1){let n=[],s=i?[]:null,o=new zn(r),a=new zn(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let h=Math.min(o.len,a.len);Ue(n,h,-1),o.forward(h),a.forward(h)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let h=a.len;for(Ue(n,a.ins,-1);h;){let c=Math.min(o.len,h);o.ins>=0&&l<o.i&&o.len<=c&&(Ue(n,0,o.ins),s&&ii(s,n,o.text),l=o.i),o.forward(c),h-=c}a.next()}else if(o.ins>=0){let h=0,c=o.len;for(;c;)if(a.ins==-1){let f=Math.min(c,a.len);h+=f,c-=f,a.forward(f)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;Ue(n,h,l<o.i?o.ins:0),s&&l<o.i&&ii(s,n,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?Ie.createSet(n,s):qt.create(n);throw new Error("Mismatched change set lengths")}}}function Wf(r,e,t=!1){let i=[],n=t?[]:null,s=new zn(r),o=new zn(e);for(let a=!1;;){if(s.done&&o.done)return n?Ie.createSet(i,n):qt.create(i);if(s.ins==0)Ue(i,s.len,0,a),s.next();else if(o.len==0&&!o.done)Ue(i,0,o.ins,a),n&&ii(n,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),h=i.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Ue(i,l,c,a),n&&c&&ii(n,i,o.text)}else o.ins==-1?(Ue(i,s.off?0:s.len,l,a),n&&ii(n,i,s.textBit(l))):(Ue(i,s.off?0:s.len,o.off?0:o.ins,a),n&&!o.off&&ii(n,i,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>h),s.forward2(l),o.forward(l)}}}}class zn{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?fe.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?fe.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Ti{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,n;return this.empty?i=n=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new Ti(i,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return _.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return _.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return _.range(e.anchor,e.head)}static create(e,t,i){return new Ti(e,t,i)}}class _{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:_.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new _([this.main],0)}addRange(e,t=!0){return _.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,_.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new _(e.ranges.map(t=>Ti.fromJSON(t)),e.main)}static single(e,t=e){return new _([_.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<e.length;n++){let s=e[n];if(s.empty?s.from<=i:s.from<i)return _.normalized(e.slice(),t);i=s.to}return new _(e,t)}static cursor(e,t=0,i,n){return Ti.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(n??16777215)<<6)}static range(e,t,i,n){let s=(i??16777215)<<6|(n==null?7:Math.min(6,n));return t<e?Ti.create(t,e,48|s):Ti.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let i=e[t];e.sort((n,s)=>n.from-s.from),t=e.indexOf(i);for(let n=1;n<e.length;n++){let s=e[n],o=e[n-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);n<=t&&t--,e.splice(--n,2,s.anchor>s.head?_.range(l,a):_.range(a,l))}}return new _(e,t)}}function Hf(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Ya=0;class I{constructor(e,t,i,n,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=n,this.id=Ya++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new I(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:Xa),!!e.static,e.enables)}of(e){return new Hr([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hr(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Hr(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function Xa(r,e){return r==e||r.length==e.length&&r.every((t,i)=>t===e[i])}class Hr{constructor(e,t,i,n){this.dependencies=e,this.facet=t,this.type=i,this.value=n,this.id=Ya++}dynamicSlot(e){var t;let i=this.value,n=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,h=!1,c=[];for(let f of this.dependencies)f=="doc"?l=!0:f=="selection"?h=!0:(((t=e[f.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[f.id]);return{create(f){return f.values[o]=i(f),1},update(f,u){if(l&&u.docChanged||h&&(u.docChanged||u.selection)||Jo(f,c)){let d=i(f);if(a?!rh(d,f.values[o],n):!n(d,f.values[o]))return f.values[o]=d,1}return 0},reconfigure:(f,u)=>{let d,p=u.config.address[s];if(p!=null){let m=ns(u,p);if(this.dependencies.every(g=>g instanceof I?u.facet(g)===f.facet(g):g instanceof ft?u.field(g,!1)==f.field(g,!1):!0)||(a?rh(d=i(f),m,n):n(d=i(f),m)))return f.values[o]=m,0}else d=i(f);return f.values[o]=d,1}}}}function rh(r,e,t){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!t(r[i],e[i]))return!1;return!0}function Jo(r,e){let t=!1;for(let i of e)Rn(r,i)&1&&(t=!0);return t}function sg(r,e,t){let i=t.map(l=>r[l.id]),n=t.map(l=>l.type),s=i.filter(l=>!(l&1)),o=r[e.id]>>1;function a(l){let h=[];for(let c=0;c<i.length;c++){let f=ns(l,i[c]);if(n[c]==2)for(let u of f)h.push(u);else h.push(f)}return e.combine(h)}return{create(l){for(let h of i)Rn(l,h);return l.values[o]=a(l),1},update(l,h){if(!Jo(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,h){let c=Jo(l,i),f=h.config.facets[e.id],u=h.facet(e);if(f&&!c&&Xa(t,f))return l.values[o]=u,0;let d=a(l);return e.compare(d,u)?(l.values[o]=u,0):(l.values[o]=d,1)}}}const wr=I.define({static:!0});class ft{constructor(e,t,i,n,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=n,this.spec=s,this.provides=void 0}static define(e){let t=new ft(Ya++,e.create,e.update,e.compare||((i,n)=>i===n),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(wr).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,n)=>{let s=i.values[t],o=this.updateF(s,n);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,n)=>{let s=i.facet(wr),o=n.facet(wr),a;return(a=s.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(i.values[t]=a.create(i),1):n.config.address[this.id]!=null?(i.values[t]=n.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,wr.of({field:this,create:e})]}get extension(){return this}}const Ci={lowest:4,low:3,default:2,high:1,highest:0};function mn(r){return e=>new qf(e,r)}const Bi={highest:mn(Ci.highest),high:mn(Ci.high),default:mn(Ci.default),low:mn(Ci.low),lowest:mn(Ci.lowest)};class qf{constructor(e,t){this.inner=e,this.prec=t}}class sr{of(e){return new Yo(this,e)}reconfigure(e){return sr.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Yo{constructor(e,t){this.compartment=e,this.inner=t}}class is{constructor(e,t,i,n,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=n,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let n=[],s=Object.create(null),o=new Map;for(let u of og(e,t,o))u instanceof ft?n.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let a=Object.create(null),l=[],h=[];for(let u of n)a[u.id]=h.length<<1,h.push(d=>u.slot(d));let c=i?.config.facets;for(let u in s){let d=s[u],p=d[0].facet,m=c&&c[u]||[];if(d.every(g=>g.type==0))if(a[p.id]=l.length<<1|1,Xa(m,d))l.push(i.facet(p));else{let g=p.combine(d.map(b=>b.value));l.push(i&&p.compare(g,i.facet(p))?i.facet(p):g)}else{for(let g of d)g.type==0?(a[g.id]=l.length<<1|1,l.push(g.value)):(a[g.id]=h.length<<1,h.push(b=>g.dynamicSlot(b)));a[p.id]=h.length<<1,h.push(g=>sg(g,p,d))}}let f=h.map(u=>u(a));return new is(e,o,f,a,l,s)}}function og(r,e,t){let i=[[],[],[],[],[]],n=new Map;function s(o,a){let l=n.get(o);if(l!=null){if(l<=a)return;let h=i[l].indexOf(o);h>-1&&i[l].splice(h,1),o instanceof Yo&&t.delete(o.compartment)}if(n.set(o,a),Array.isArray(o))for(let h of o)s(h,a);else if(o instanceof Yo){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,a)}else if(o instanceof qf)s(o.inner,o.prec);else if(o instanceof ft)i[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Hr)i[a].push(o),o.facet.extensions&&s(o.facet.extensions,Ci.default);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,a)}}return s(r,Ci.default),i.reduce((o,a)=>o.concat(a))}function Rn(r,e){if(e&1)return 2;let t=e>>1,i=r.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[t]=4;let n=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|n}function ns(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const Gf=I.define(),Xo=I.define({combine:r=>r.some(e=>e),static:!0}),Uf=I.define({combine:r=>r.length?r[0]:void 0,static:!0}),Kf=I.define(),Jf=I.define(),Yf=I.define(),Xf=I.define({combine:r=>r.length?r[0]:!1});class bi{constructor(e,t){this.type=e,this.value=t}static define(){return new ag}}class ag{of(e){return new bi(this,e)}}class lg{constructor(e){this.map=e}of(e){return new de(this,e)}}class de{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new de(this.type,t)}is(e){return this.type==e}static define(e={}){return new lg(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let n of e){let s=n.map(t);s&&i.push(s)}return i}}de.reconfigure=de.define();de.appendConfig=de.define();class ze{constructor(e,t,i,n,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=n,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Hf(i,t.newLength),s.some(a=>a.type==ze.time)||(this.annotations=s.concat(ze.time.of(Date.now())))}static create(e,t,i,n,s,o){return new ze(e,t,i,n,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(ze.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}ze.time=bi.define();ze.userEvent=bi.define();ze.addToHistory=bi.define();ze.remote=bi.define();function hg(r,e){let t=[];for(let i=0,n=0;;){let s,o;if(i<r.length&&(n==e.length||e[n]>=r[i]))s=r[i++],o=r[i++];else if(n<e.length)s=e[n++],o=e[n++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Qf(r,e,t){var i;let n,s,o;return t?(n=e.changes,s=Ie.empty(e.changes.length),o=r.changes.compose(e.changes)):(n=e.changes.map(r.changes),s=r.changes.mapDesc(e.changes,!0),o=r.changes.compose(n)),{changes:o,selection:e.selection?e.selection.map(s):(i=r.selection)===null||i===void 0?void 0:i.map(n),effects:de.mapEffects(r.effects,n).concat(de.mapEffects(e.effects,s)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function Qo(r,e,t){let i=e.selection,n=Gi(e.annotations);return e.userEvent&&(n=n.concat(ze.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ie?e.changes:Ie.of(e.changes||[],t,r.facet(Uf)),selection:i&&(i instanceof _?i:_.single(i.anchor,i.head)),effects:Gi(e.effects),annotations:n,scrollIntoView:!!e.scrollIntoView}}function Zf(r,e,t){let i=Qo(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=Qf(i,Qo(r,e[s],o?i.changes.newLength:r.doc.length),o)}let n=ze.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return fg(t?cg(n):n)}function cg(r){let e=r.startState,t=!0;for(let n of e.facet(Kf)){let s=n(r);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:hg(t,s))}if(t!==!0){let n,s;if(t===!1)s=r.changes.invertedDesc,n=Ie.empty(e.doc.length);else{let o=r.changes.filter(t);n=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}r=ze.create(e,n,r.selection&&r.selection.map(s),de.mapEffects(r.effects,s),r.annotations,r.scrollIntoView)}let i=e.facet(Jf);for(let n=i.length-1;n>=0;n--){let s=i[n](r);s instanceof ze?r=s:Array.isArray(s)&&s.length==1&&s[0]instanceof ze?r=s[0]:r=Zf(e,Gi(s),!1)}return r}function fg(r){let e=r.startState,t=e.facet(Yf),i=r;for(let n=t.length-1;n>=0;n--){let s=t[n](r);s&&Object.keys(s).length&&(i=Qf(i,Qo(e,s,r.changes.newLength),!0))}return i==r?r:ze.create(e,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const ug=[];function Gi(r){return r==null?ug:Array.isArray(r)?r:[r]}var Ee=(function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r})(Ee||(Ee={}));const dg=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Zo;try{Zo=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function pg(r){if(Zo)return Zo.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||dg.test(t)))return!0}return!1}function mg(r){return e=>{if(!/\S/.test(e))return Ee.Space;if(pg(e))return Ee.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return Ee.Word;return Ee.Other}}class ie{constructor(e,t,i,n,s,o){this.config=e,this.doc=t,this.selection=i,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Rn(this,a<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return Rn(this,i),ns(this,i)}update(...e){return Zf(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:n}=t;for(let a of e.effects)a.is(sr.reconfigure)?(t&&(n=new Map,t.compartments.forEach((l,h)=>n.set(h,l)),t=null),n.set(a.value.compartment,a.value.extension)):a.is(de.reconfigure)?(t=null,i=a.value):a.is(de.appendConfig)&&(t=null,i=Gi(i).concat(a.value));let s;t?s=e.startState.values.slice():(t=is.resolve(i,n,this),s=new ie(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,h)=>h.reconfigure(l,this),null).values);let o=e.startState.facet(Xo)?e.newSelection:e.newSelection.asSingle();new ie(t,e.newDoc,o,s,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:_.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),n=this.changes(i.changes),s=[i.range],o=Gi(i.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),h=this.changes(l.changes),c=h.map(n);for(let u=0;u<a;u++)s[u]=s[u].map(c);let f=n.mapDesc(h,!0);s.push(l.range.map(f)),n=n.compose(c),o=de.mapEffects(o,c).concat(de.mapEffects(Gi(l.effects),f))}return{changes:n,selection:_.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ie?e:Ie.of(e,this.doc.length,this.facet(ie.lineSeparator))}toText(e){return fe.of(e.split(this.facet(ie.lineSeparator)||Go))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Rn(this,t),ns(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let n=e[i];n instanceof ft&&this.config.address[n.id]!=null&&(t[i]=n.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let o=i[s],a=e[s];n.push(o.init(l=>o.spec.fromJSON(a,l)))}}return ie.create({doc:e.doc,selection:_.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=is.resolve(e.extensions||[],new Map),i=e.doc instanceof fe?e.doc:fe.of((e.doc||"").split(t.staticFacet(ie.lineSeparator)||Go)),n=e.selection?e.selection instanceof _?e.selection:_.single(e.selection.anchor,e.selection.head):_.single(0);return Hf(n,i.length),t.staticFacet(Xo)||(n=n.asSingle()),new ie(t,i,n,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ie.tabSize)}get lineBreak(){return this.facet(ie.lineSeparator)||`
`}get readOnly(){return this.facet(Xf)}phrase(e,...t){for(let i of this.facet(ie.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let s=+(n||1);return!s||s>t.length?i:t[s-1]})),e}languageDataAt(e,t,i=-1){let n=[];for(let s of this.facet(Gf))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&n.push(o[e]);return n}charCategorizer(e){return mg(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:n}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=Me(t,o,!1);if(s(t.slice(l,o))!=Ee.Word)break;o=l}for(;a<n;){let l=Me(t,a);if(s(t.slice(a,l))!=Ee.Word)break;a=l}return o==a?null:_.range(o+i,a+i)}}ie.allowMultipleSelections=Xo;ie.tabSize=I.define({combine:r=>r.length?r[0]:4});ie.lineSeparator=Uf;ie.readOnly=Xf;ie.phrases=I.define({compare(r,e){let t=Object.keys(r),i=Object.keys(e);return t.length==i.length&&t.every(n=>r[n]==e[n])}});ie.languageData=Gf;ie.changeFilter=Kf;ie.transactionFilter=Jf;ie.transactionExtender=Yf;sr.reconfigure=de.define();function ji(r,e,t={}){let i={};for(let n of r)for(let s of Object.keys(n)){let o=n[s],a=i[s];if(a===void 0)i[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let n in e)i[n]===void 0&&(i[n]=e[n]);return i}class ai{eq(e){return this==e}range(e,t=e){return ea.create(e,t,this)}}ai.prototype.startSide=ai.prototype.endSide=0;ai.prototype.point=!1;ai.prototype.mapMode=Je.TrackDel;let ea=class eu{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new eu(e,t,i)}};function ta(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class Qa{constructor(e,t,i,n){this.from=e,this.to=t,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,n=0){let s=i?this.to:this.from;for(let o=n,a=s.length;;){if(o==a)return o;let l=o+a>>1,h=s[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return h>=0?o:a;h>=0?a=l:o=l+1}}between(e,t,i,n){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(n(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],n=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let h=this.value[l],c=this.from[l]+e,f=this.to[l]+e,u,d;if(c==f){let p=t.mapPos(c,h.startSide,h.mapMode);if(p==null||(u=d=p,h.startSide!=h.endSide&&(d=t.mapPos(c,h.endSide),d<u)))continue}else if(u=t.mapPos(c,h.startSide),d=t.mapPos(f,h.endSide),u>d||u==d&&h.startSide>0&&h.endSide<=0)continue;(d-u||h.endSide-h.startSide)<0||(o<0&&(o=u),h.point&&(a=Math.max(a,d-u)),i.push(h),n.push(u-o),s.push(d-o))}return{mapped:i.length?new Qa(n,s,i,a):null,pos:o}}}class se{constructor(e,t,i,n){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=n}static create(e,t,i,n){return new se(e,t,i,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:n=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(ta)),this.isEmpty)return t.length?se.of(t):this;let a=new tu(this,null,-1).goto(0),l=0,h=[],c=new Kt;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let f=t[l++];c.addInner(f.from,f.to,f.value)||h.push(f)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||n>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||n>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||h.push(ea.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?se.empty:this.nextLayer.update({add:h,filter:o,filterFrom:n,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],h=e.touchesRange(a,a+l.length);if(h===!1)n=Math.max(n,l.maxPoint),t.push(l),i.push(e.mapPos(a));else if(h===!0){let{mapped:c,pos:f}=l.map(a,e);c&&(n=Math.max(n,c.maxPoint),t.push(c),i.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new se(i,t,s||se.empty,n)}between(e,t,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],o=this.chunk[n];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Vn.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Vn.from(e).goto(t)}static compare(e,t,i,n,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=sh(o,a,i),h=new gn(o,l,s),c=new gn(a,l,s);i.iterGaps((f,u,d)=>oh(h,f,c,u,d,n)),i.empty&&i.length==0&&oh(h,0,c,0,0,n)}static eq(e,t,i=0,n){n==null&&(n=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=sh(s,o),l=new gn(s,a,0).goto(i),h=new gn(o,a,0).goto(i);for(;;){if(l.to!=h.to||!ia(l.active,h.active)||l.point&&(!h.point||!l.point.eq(h.point)))return!1;if(l.to>n)return!0;l.next(),h.next()}}static spans(e,t,i,n,s=-1){let o=new gn(e,null,s).goto(t),a=t,l=o.openStart;for(;;){let h=Math.min(o.to,i);if(o.point){let c=o.activeForPoint(o.to),f=o.pointFrom<t?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,l);n.point(a,h,o.point,c,f,o.pointRank),l=Math.min(o.openEnd(h),c.length)}else h>a&&(n.span(a,h,o.active,l),l=o.openEnd(h));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,t=!1){let i=new Kt;for(let n of e instanceof ea?[e]:t?gg(e):e)i.add(n.from,n.to,n.value);return i.finish()}static join(e){if(!e.length)return se.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let n=e[i];n!=se.empty;n=n.nextLayer)t=new se(n.chunkPos,n.chunk,t,Math.max(n.maxPoint,t.maxPoint));return t}}se.empty=new se([],[],null,-1);function gg(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let i=r[t];if(ta(e,i)>0)return r.slice().sort(ta);e=i}return r}se.empty.nextLayer=se.empty;class Kt{finishChunk(e){this.chunks.push(new Qa(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Kt)).add(e,t,i)}addInner(e,t,i){let n=e-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(se.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=se.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function sh(r,e,t){let i=new Map;for(let s of r)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let n=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=i.get(s.chunk[o]);a!=null&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!t?.touchesRange(a,a+s.chunk[o].length)&&n.add(s.chunk[o])}return n}class tu{constructor(e,t,i,n=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Vn{constructor(e){this.heap=e}static from(e,t=null,i=-1){let n=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new tu(o,t,i,s));return n.length==1?n[0]:new Vn(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Qs(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Qs(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Qs(this.heap,0)}}}function Qs(r,e){for(let t=r[e];;){let i=(e<<1)+1;if(i>=r.length)break;let n=r[i];if(i+1<r.length&&n.compare(r[i+1])>=0&&(n=r[i+1],i++),t.compare(n)<0)break;r[i]=t,r[e]=n,e=i}}class gn{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Vn.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Sr(this.active,e),Sr(this.activeTo,e),Sr(this.activeRank,e),this.minActive=ah(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:n,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||n-this.activeTo[t])>0;)t++;Cr(this.active,t,i),Cr(this.activeTo,t,n),Cr(this.activeRank,t,s),e&&Cr(e,t,this.cursor.from),this.minActive=ah(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&Sr(i,n)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<e;n--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function oh(r,e,t,i,n,s){r.goto(e),t.goto(i);let o=i+n,a=i,l=i-e;for(;;){let h=r.to+l-t.to,c=h||r.endSide-t.endSide,f=c<0?r.to+l:t.to,u=Math.min(f,o);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&ia(r.activeForPoint(r.to),t.activeForPoint(t.to))||s.comparePoint(a,u,r.point,t.point):u>a&&!ia(r.active,t.active)&&s.compareRange(a,u,r.active,t.active),f>o)break;(h||r.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(f),a=f,c<=0&&r.next(),c>=0&&t.next()}}function ia(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function Sr(r,e){for(let t=e,i=r.length-1;t<i;t++)r[t]=r[t+1];r.pop()}function Cr(r,e,t){for(let i=r.length-1;i>=e;i--)r[i+1]=r[i];r[e]=t}function ah(r,e){let t=-1,i=1e9;for(let n=0;n<e.length;n++)(e[n]-i||r[n].endSide-r[t].endSide)<0&&(t=n,i=e[n]);return t}function hn(r,e,t=r.length){let i=0;for(let n=0;n<t&&n<r.length;)r.charCodeAt(n)==9?(i+=e-i%e,n++):(i++,n=Me(r,n));return i}function na(r,e,t,i){for(let n=0,s=0;;){if(s>=e)return n;if(n==r.length)break;s+=r.charCodeAt(n)==9?t-s%t:1,n=Me(r,n)}return i===!0?-1:r.length}const ra="",lh=typeof Symbol>"u"?"__"+ra:Symbol.for(ra),sa=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Jt{constructor(e,t){this.rules=[];let{finish:i}=t||{};function n(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,h){let c=[],f=/^@(\w+)\b/.exec(o[0]),u=f&&f[1]=="keyframes";if(f&&a==null)return l.push(o[0]+";");for(let d in a){let p=a[d];if(/&/.test(d))s(d.split(/,\s*/).map(m=>o.map(g=>m.replace(/&/,g))).reduce((m,g)=>m.concat(g)),p,l);else if(p&&typeof p=="object"){if(!f)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(n(d),p,c,u)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||u)&&l.push((i&&!f&&!h?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(n(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=hh[lh]||1;return hh[lh]=e+1,ra+e.toString(36)}static mount(e,t,i){let n=e[sa],s=i&&i.nonce;n?s&&n.setNonce(s):n=new bg(e,s),n.mount(Array.isArray(t)?t:[t],e)}}let ch=new Map;class bg{constructor(e,t){let i=e.ownerDocument||e,n=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){let s=ch.get(i);if(s)return e[sa]=s;this.sheet=new n.CSSStyleSheet,ch.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[sa]=this}mount(e,t){let i=this.sheet,n=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),l==-1){if(this.modules.splice(s++,0,a),i)for(let h=0;h<a.rules.length;h++)i.insertRule(a.rules[h],n++)}else{for(;s<l;)n+=this.modules[s++].rules.length;n+=a.rules.length,s++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=t.head||t;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var li={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wn={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yg=typeof navigator<"u"&&/Mac/.test(navigator.platform),vg=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var $e=0;$e<10;$e++)li[48+$e]=li[96+$e]=String($e);for(var $e=1;$e<=24;$e++)li[$e+111]="F"+$e;for(var $e=65;$e<=90;$e++)li[$e]=String.fromCharCode($e+32),Wn[$e]=String.fromCharCode($e);for(var Zs in li)Wn.hasOwnProperty(Zs)||(Wn[Zs]=li[Zs]);function xg(r){var e=yg&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||vg&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?Wn:li)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function ut(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];typeof n=="string"?r.setAttribute(i,n):n!=null&&(r[i]=n)}e++}for(;e<arguments.length;e++)iu(r,arguments[e]);return r}function iu(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)iu(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}let et=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},oa=typeof document<"u"?document:{documentElement:{style:{}}};const aa=/Edge\/(\d+)/.exec(et.userAgent),nu=/MSIE \d/.test(et.userAgent),la=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(et.userAgent),Ds=!!(nu||la||aa),fh=!Ds&&/gecko\/(\d+)/i.test(et.userAgent),eo=!Ds&&/Chrome\/(\d+)/.exec(et.userAgent),kg="webkitFontSmoothing"in oa.documentElement.style,ha=!Ds&&/Apple Computer/.test(et.vendor),uh=ha&&(/Mobile\/\w+/.test(et.userAgent)||et.maxTouchPoints>2);var L={mac:uh||/Mac/.test(et.platform),windows:/Win/.test(et.platform),linux:/Linux|X11/.test(et.platform),ie:Ds,ie_version:nu?oa.documentMode||6:la?+la[1]:aa?+aa[1]:0,gecko:fh,gecko_version:fh?+(/Firefox\/(\d+)/.exec(et.userAgent)||[0,0])[1]:0,chrome:!!eo,chrome_version:eo?+eo[1]:0,ios:uh,android:/Android\b/.test(et.userAgent),webkit_version:kg?+(/\bAppleWebKit\/(\d+)/.exec(et.userAgent)||[0,0])[1]:0,safari:ha,safari_version:ha?+(/\bVersion\/(\d+(\.\d+)?)/.exec(et.userAgent)||[0,0])[1]:0,tabSize:oa.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Za(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const rs=Object.create(null);function el(r,e,t){if(r==e)return!0;r||(r=rs),e||(e=rs);let i=Object.keys(r),n=Object.keys(e);if(i.length-0!=n.length-0)return!1;for(let s of i)if(s!=t&&(n.indexOf(s)==-1||r[s]!==e[s]))return!1;return!0}function wg(r,e){for(let t=r.attributes.length-1;t>=0;t--){let i=r.attributes[t].name;e[i]==null&&r.removeAttribute(i)}for(let t in e){let i=e[t];t=="style"?r.style.cssText=i:r.getAttribute(t)!=i&&r.setAttribute(t,i)}}function dh(r,e,t){let i=!1;if(e)for(let n in e)t&&n in t||(i=!0,n=="style"?r.style.cssText="":r.removeAttribute(n));if(t)for(let n in t)e&&e[n]==t[n]||(i=!0,n=="style"?r.style.cssText=t[n]:r.setAttribute(n,t[n]));return i}function Sg(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let i=r.attributes[t];e[i.name]=i.value}return e}class Xt{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var We=(function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r})(We||(We={}));class J extends ai{constructor(e,t,i,n){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(e){return new or(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Pi(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,n;if(e.isBlockGap)i=-5e8,n=4e8;else{let{start:s,end:o}=ru(e,t);i=(s?t?-3e8:-1:5e8)-1,n=(o?t?2e8:1:-6e8)+1}return new Pi(e,i,n,t,e.widget||null,!0)}static line(e){return new ar(e)}static set(e,t=!1){return se.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}J.none=se.empty;class or extends J{constructor(e){let{start:t,end:i}=ru(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?Za(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||rs}eq(e){return this==e||e instanceof or&&this.tagName==e.tagName&&el(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}or.prototype.point=!1;class ar extends J{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ar&&this.spec.class==e.spec.class&&el(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ar.prototype.mapMode=Je.TrackBefore;ar.prototype.point=!0;class Pi extends J{constructor(e,t,i,n,s,o){super(t,i,s,e),this.block=n,this.isReplace=o,this.mapMode=n?t<=0?Je.TrackBefore:Je.TrackAfter:Je.TrackDel}get type(){return this.startSide!=this.endSide?We.WidgetRange:this.startSide<=0?We.WidgetBefore:We.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Pi&&Cg(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Pi.prototype.point=!0;function ru(r,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=r;return t==null&&(t=r.inclusive),i==null&&(i=r.inclusive),{start:t??e,end:i??e}}function Cg(r,e){return r==e||!!(r&&e&&r.compare(e))}function Ui(r,e,t,i=0){let n=t.length-1;n>=0&&t[n]+i>=r?t[n]=Math.max(t[n],e):t.push(r,e)}class Hn extends ai{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof Hn&&this.tagName==e.tagName&&el(this.attributes,e.attributes)}static create(e){return new Hn(e.tagName,e.attributes||rs)}static set(e,t=!1){return se.of(e,t)}}Hn.prototype.startSide=Hn.prototype.endSide=-1;function qn(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function ca(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function qr(r,e){if(!e.anchorNode)return!1;try{return ca(r,e.anchorNode)}catch{return!1}}function Gr(r){return r.nodeType==3?Gn(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function Dn(r,e,t,i){return t?ph(r,e,t,i,-1)||ph(r,e,t,i,1):!1}function hi(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function ss(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function ph(r,e,t,i,n){for(;;){if(r==t&&e==i)return!0;if(e==(n<0?0:Yt(r))){if(r.nodeName=="DIV")return!1;let s=r.parentNode;if(!s||s.nodeType!=1)return!1;e=hi(r)+(n<0?0:1),r=s}else if(r.nodeType==1){if(r=r.childNodes[e+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=n<0?Yt(r):0}else return!1}}function Yt(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function os(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function _g(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function su(r,e){let t=e.width/r.offsetWidth,i=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-r.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function Ag(r,e,t,i,n,s,o,a){let l=r.ownerDocument,h=l.defaultView||window;for(let c=r,f=!1;c&&!f;)if(c.nodeType==1){let u,d=c==l.body,p=1,m=1;if(d)u=_g(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(f=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let y=c.getBoundingClientRect();({scaleX:p,scaleY:m}=su(c,y)),u={left:y.left,right:y.left+c.clientWidth*p,top:y.top,bottom:y.top+c.clientHeight*m}}let g=0,b=0;if(n=="nearest")e.top<u.top?(b=e.top-(u.top+o),t>0&&e.bottom>u.bottom+b&&(b=e.bottom-u.bottom+o)):e.bottom>u.bottom&&(b=e.bottom-u.bottom+o,t<0&&e.top-b<u.top&&(b=e.top-(u.top+o)));else{let y=e.bottom-e.top,x=u.bottom-u.top;b=(n=="center"&&y<=x?e.top+y/2-x/2:n=="start"||n=="center"&&t<0?e.top-o:e.bottom-x+o)-u.top}if(i=="nearest"?e.left<u.left?(g=e.left-(u.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=e.left-(u.left+s))):g=(i=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:i=="start"==a?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||b)if(d)h.scrollBy(g,b);else{let y=0,x=0;if(b){let E=c.scrollTop;c.scrollTop+=b/m,x=(c.scrollTop-E)*m}if(g){let E=c.scrollLeft;c.scrollLeft+=g/p,y=(c.scrollLeft-E)*p}e={left:e.left-y,top:e.top-x,right:e.right-y,bottom:e.bottom-x},y&&Math.abs(y-g)<1&&(i="nearest"),x&&Math.abs(x-b)<1&&(n="nearest")}if(d)break;(e.top<u.top||e.bottom>u.bottom||e.left<u.left||e.right>u.right)&&(e={left:Math.max(e.left,u.left),right:Math.min(e.right,u.right),top:Math.max(e.top,u.top),bottom:Math.min(e.bottom,u.bottom)}),c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function Tg(r){let e=r.ownerDocument,t,i;for(let n=r.parentNode;n&&!(n==e.body||t&&i);)if(n.nodeType==1)!i&&n.scrollHeight>n.clientHeight&&(i=n),!t&&n.scrollWidth>n.clientWidth&&(t=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:t,y:i}}class Eg{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?Yt(t):0),i,Math.min(e.focusOffset,i?Yt(i):0))}set(e,t,i,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=n}}let Si=null;L.safari&&L.safari_version>=26&&(Si=!1);function ou(r){if(r.setActive)return r.setActive();if(Si)return r.focus(Si);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(Si==null?{get preventScroll(){return Si={preventScroll:!0},!0}}:void 0),!Si){Si=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let mh;function Gn(r,e,t=e){let i=mh||(mh=document.createRange());return i.setEnd(r,t),i.setStart(r,e),i}function Ki(r,e,t,i){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=i);let s=new KeyboardEvent("keydown",n);s.synthetic=!0,r.dispatchEvent(s);let o=new KeyboardEvent("keyup",n);return o.synthetic=!0,r.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function Og(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function Mg(r,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,Yt(t));;)if(i){if(t.nodeType!=1)return!1;let n=t.childNodes[i-1];n.contentEditable=="false"?i--:(t=n,i=Yt(t))}else{if(t==r)return!0;i=hi(t),t=t.parentNode}}function au(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function lu(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=Yt(t)}else if(t.parentNode&&!ss(t))i=hi(t),t=t.parentNode;else return null}}function hu(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!ss(t))i=hi(t)+1,t=t.parentNode;else return null}}class St{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new St(e.parentNode,hi(e),t)}static after(e,t){return new St(e.parentNode,hi(e)+1,t)}}var ve=(function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r})(ve||(ve={}));const Li=ve.LTR,tl=ve.RTL;function cu(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const Rg=cu("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Dg=cu("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),fa=Object.create(null),Ot=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);fa[e]=t,fa[t]=-e}function fu(r){return r<=247?Rg[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?Dg[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const Pg=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ht{get dir(){return this.level%2?tl:Li}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,n){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==i)return o;(s<0||(n!=0?n<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function uu(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let i=r[t],n=e[t];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!uu(i.inner,n.inner))return!1}return!0}const ge=[];function Lg(r,e,t,i,n){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:e,a=s<i.length?i[s].from:t,l=s?256:n;for(let h=o,c=l,f=l;h<a;h++){let u=fu(r.charCodeAt(h));u==512?u=c:u==8&&f==4&&(u=16),ge[h]=u==4?2:u,u&7&&(f=u),c=u}for(let h=o,c=l,f=l;h<a;h++){let u=ge[h];if(u==128)h<a-1&&c==ge[h+1]&&c&24?u=ge[h]=c:ge[h]=256;else if(u==64){let d=h+1;for(;d<a&&ge[d]==64;)d++;let p=h&&c==8||d<t&&ge[d]==8?f==1?1:8:256;for(let m=h;m<d;m++)ge[m]=p;h=d-1}else u==8&&f==1&&(ge[h]=1);c=u,u&7&&(f=u)}}}function Ig(r,e,t,i,n){let s=n==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let h=o?i[o-1].to:e,c=o<i.length?i[o].from:t;for(let f=h,u,d,p;f<c;f++)if(d=fa[u=r.charCodeAt(f)])if(d<0){for(let m=a-3;m>=0;m-=3)if(Ot[m+1]==-d){let g=Ot[m+2],b=g&2?n:g&4?g&1?s:n:0;b&&(ge[f]=ge[Ot[m]]=b),a=m;break}}else{if(Ot.length==189)break;Ot[a++]=f,Ot[a++]=u,Ot[a++]=l}else if((p=ge[f])==2||p==1){let m=p==n;l=m?0:1;for(let g=a-3;g>=0;g-=3){let b=Ot[g+2];if(b&2)break;if(m)Ot[g+2]|=2;else{if(b&4)break;Ot[g+2]|=4}}}}}function Ng(r,e,t,i){for(let n=0,s=i;n<=t.length;n++){let o=n?t[n-1].to:r,a=n<t.length?t[n].from:e;for(let l=o;l<a;){let h=ge[l];if(h==256){let c=l+1;for(;;)if(c==a){if(n==t.length)break;c=t[n++].to,a=n<t.length?t[n].from:e}else if(ge[c]==256)c++;else break;let f=s==1,u=(c<e?ge[c]:i)==1,d=f==u?f?1:2:i;for(let p=c,m=n,g=m?t[m-1].to:r;p>l;)p==g&&(p=t[--m].from,g=m?t[m-1].to:r),ge[--p]=d;l=c}else s=h,l++}}}function ua(r,e,t,i,n,s,o){let a=i%2?2:1;if(i%2==n%2)for(let l=e,h=0;l<t;){let c=!0,f=!1;if(h==s.length||l<s[h].from){let m=ge[l];m!=a&&(c=!1,f=m==16)}let u=!c&&a==1?[]:null,d=c?i:i+1,p=l;e:for(;;)if(h<s.length&&p==s[h].from){if(f)break e;let m=s[h];if(!c)for(let g=m.to,b=h+1;;){if(g==t)break e;if(b<s.length&&s[b].from==g)g=s[b++].to;else{if(ge[g]==a)break e;break}}if(h++,u)u.push(m);else{m.from>l&&o.push(new Ht(l,m.from,d));let g=m.direction==Li!=!(d%2);da(r,g?i+1:i,n,m.inner,m.from,m.to,o),l=m.to}p=m.to}else{if(p==t||(c?ge[p]!=a:ge[p]==a))break;p++}u?ua(r,l,p,i+1,n,u,o):l<p&&o.push(new Ht(l,p,d)),l=p}else for(let l=t,h=s.length;l>e;){let c=!0,f=!1;if(!h||l>s[h-1].to){let m=ge[l-1];m!=a&&(c=!1,f=m==16)}let u=!c&&a==1?[]:null,d=c?i:i+1,p=l;e:for(;;)if(h&&p==s[h-1].to){if(f)break e;let m=s[--h];if(!c)for(let g=m.from,b=h;;){if(g==e)break e;if(b&&s[b-1].to==g)g=s[--b].from;else{if(ge[g-1]==a)break e;break}}if(u)u.push(m);else{m.to<l&&o.push(new Ht(m.to,l,d));let g=m.direction==Li!=!(d%2);da(r,g?i+1:i,n,m.inner,m.from,m.to,o),l=m.from}p=m.from}else{if(p==e||(c?ge[p-1]!=a:ge[p-1]==a))break;p--}u?ua(r,p,l,i+1,n,u,o):p<l&&o.push(new Ht(p,l,d)),l=p}}function da(r,e,t,i,n,s,o){let a=e%2?2:1;Lg(r,n,s,i,a),Ig(r,n,s,i,a),Ng(n,s,i,a),ua(r,n,s,e,t,i,o)}function Bg(r,e,t){if(!r)return[new Ht(0,0,e==tl?1:0)];if(e==Li&&!t.length&&!Pg.test(r))return du(r.length);if(t.length)for(;r.length>ge.length;)ge[ge.length]=256;let i=[],n=e==Li?0:1;return da(r,n,n,t,0,r.length,i),i}function du(r){return[new Ht(0,r,0)]}let pu="";function jg(r,e,t,i,n){var s;let o=i.head-r.from,a=Ht.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc),l=e[a],h=l.side(n,t);if(o==h){let u=a+=n?1:-1;if(u<0||u>=e.length)return null;l=e[a=u],o=l.side(!n,t),h=l.side(n,t)}let c=Me(r.text,o,l.forward(n,t));(c<l.from||c>l.to)&&(c=h),pu=r.text.slice(Math.min(o,c),Math.max(o,c));let f=a==(n?e.length-1:0)?null:e[a+(n?1:-1)];return f&&c==h&&f.level+(n?0:1)<l.level?_.cursor(f.side(!n,t)+r.from,f.forward(n,t)?1:-1,f.level):_.cursor(c+r.from,l.forward(n,t)?-1:1,l.level)}function Fg(r,e,t){for(let i=e;i<t;i++){let n=fu(r.charCodeAt(i));if(n==1)return Li;if(n==2||n==4)return tl}return Li}const mu=I.define(),gu=I.define(),bu=I.define(),yu=I.define(),pa=I.define(),vu=I.define(),xu=I.define(),il=I.define(),nl=I.define(),ku=I.define({combine:r=>r.some(e=>e)}),wu=I.define({combine:r=>r.some(e=>e)}),Su=I.define();class Ji{constructor(e,t="nearest",i="nearest",n=5,s=5,o=!1){this.range=e,this.y=t,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Ji(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ji(_.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const _r=de.define({map:(r,e)=>r.map(e)}),Cu=de.define();function Bt(r,e,t){let i=r.facet(yu);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const Wt=I.define({combine:r=>r.length?r[0]:!0});let $g=0;const Wi=I.define({combine(r){return r.filter((e,t)=>{for(let i=0;i<t;i++)if(r[i].plugin==e.plugin)return!1;return!0})}});class Ce{constructor(e,t,i,n,s){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=n,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Wi.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Wi.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=t||{};return new Ce($g++,e,i,n,a=>{let l=[];return o&&l.push(Un.of(h=>{let c=h.plugin(a);return c?o(c):J.none})),s&&l.push(s(a)),l})}static fromClass(e,t){return Ce.define((i,n)=>new e(i,n),t)}}class to{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Bt(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Bt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Bt(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const _u=I.define(),Ps=I.define(),Un=I.define(),Au=I.define(),Tu=I.define(),lr=I.define(),Eu=I.define();function gh(r,e){let t=r.state.facet(Eu);if(!t.length)return t;let i=t.map(s=>s instanceof Function?s(r):s),n=[];return se.spans(i,e.from,e.to,{point(){},span(s,o,a,l){let h=s-e.from,c=o-e.from,f=n;for(let u=a.length-1;u>=0;u--,l--){let d=a[u].spec.bidiIsolate,p;if(d==null&&(d=Fg(e.text,h,c)),l>0&&f.length&&(p=f[f.length-1]).to==h&&p.direction==d)p.to=c,f=p.inner;else{let m={from:h,to:c,direction:d,inner:[]};f.push(m),f=m.inner}}}}),n}const Ou=I.define();function Mu(r){let e=0,t=0,i=0,n=0;for(let s of r.state.facet(Ou)){let o=s(r);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(n=Math.max(n,o.bottom)))}return{left:e,right:t,top:i,bottom:n}}const xn=I.define();class gt{constructor(e,t,i,n){this.fromA=e,this.toA=t,this.fromB=i,this.toB=n}join(e){return new gt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let n=e[t-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let n=0,s=0,o=0;;){let a=n<e.length?e[n].fromB:1e9,l=s<t.length?t[s]:1e9,h=Math.min(a,l);if(h==1e9)break;let c=h+o,f=h,u=c;for(;;)if(s<t.length&&t[s]<=f){let d=t[s+1];s+=2,f=Math.max(f,d);for(let p=n;p<e.length&&e[p].fromB<=f;p++)o=e[p].toA-e[p].toB;u=Math.max(u,d+o)}else if(n<e.length&&e[n].fromB<=f){let d=e[n++];f=Math.max(f,d.toB),u=Math.max(u,d.toA),o=d.toA-d.toB}else break;i.push(new gt(c,u,h,f))}return i}}class as{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Ie.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let n=[];this.changes.iterChangedRanges((s,o,a,l)=>n.push(new gt(s,o,a,l))),this.changedRanges=n}static create(e,t,i){return new as(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const zg=[];class Re{constructor(e,t,i=0){this.dom=e,this.length=t,this.flags=i,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return zg}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&wg(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let i=t;for(let n of this.children){if(n==e)return i;i+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let i=hi(this.dom),n=this.length?e>0:t>0;return new St(this.parent.dom,i+(n?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Is)return e;return null}static get(e){return e.cmTile}}class Ls extends Re{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,i=null,n,s=e?.node==t?e:null,o=0;for(let a of this.children){if(a.sync(e),o+=a.length+a.breakAfter,n=i?i.nextSibling:t.firstChild,s&&n!=a.dom&&(s.written=!0),a.dom.parentNode==t)for(;n&&n!=a.dom;)n=bh(n);else t.insertBefore(a.dom,n);i=a.dom}for(n=i?i.nextSibling:t.firstChild,s&&n&&(s.written=!0);n;)n=bh(n);this.length=o}}function bh(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class Is extends Ls{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=Re.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],i=this,n=0,s=0;;)if(n==i.children.length){if(!t.length)return;i=i.parent,i.breakAfter&&s++,n=t.pop()}else{let o=i.children[n++];if(o instanceof ri)t.push(n),i=o,n=0;else{let a=s+o.length,l=e(o,s);if(l!==void 0)return l;s=a+o.breakAfter}}}resolveBlock(e,t){let i,n=-1,s,o=-1;if(this.blockTiles((a,l)=>{let h=l+a.length;if(e>=l&&e<=h){if(a.isWidget()&&t>=-1&&t<=1){if(a.flags&32)return!0;a.flags&16&&(i=void 0)}(l<e||e==h&&(t<-1?a.length:a.covers(1)))&&(!i||!a.isWidget()&&i.isWidget())&&(i=a,n=e-l),(h>e||e==l&&(t>1?a.length:a.covers(-1)))&&(!s||!a.isWidget()&&s.isWidget())&&(s=a,o=e-l)}}),!i&&!s)throw new Error("No tile at position "+e);return i&&t<0||!s?{tile:i,offset:n}:{tile:s,offset:o}}}class ri extends Ls{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let i=new ri(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class tn extends Ls{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,i){let n=new tn(t||document.createElement("div"),e);return(!t||!i)&&(n.flags|=4),n}get domAttrs(){return this.attrs}resolveInline(e,t,i){let n=null,s=-1,o=null,a=-1;function l(c,f){for(let u=0,d=0;u<c.children.length&&d<=f;u++){let p=c.children[u],m=d+p.length;m>=f&&(p.isComposite()?l(p,f-d):(!o||o.isHidden&&(t>0||i&&Wg(o,p)))&&(m>f||p.flags&32)?(o=p,a=f-d):(d<f||p.flags&16&&!p.isHidden)&&(n=p,s=f-d)),d=m}}l(this,e);let h=(t<0?n:o)||n||o;return h?{tile:h,offset:h==n?s:a}:null}coordsIn(e,t){let i=this.resolveInline(e,t,!0);return i?i.tile.coordsIn(Math.max(0,i.offset),t):Vg(this)}domIn(e,t){let i=this.resolveInline(e,t);if(i){let{tile:n,offset:s}=i;if(this.dom.contains(n.dom))return n.isText()?new St(n.dom,Math.min(n.dom.nodeValue.length,s)):n.domPosFor(s,n.flags&16?1:n.flags&32?-1:t);let o=i.tile.parent,a=!1;for(let l of o.children){if(a)return new St(l.dom,0);l==i.tile&&(a=!0)}}return new St(this.dom,0)}}function Vg(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=Gr(e);return t[t.length-1]||null}function Wg(r,e){let t=r.coordsIn(0,1),i=e.coordsIn(0,1);return t&&i&&i.top<t.bottom}class rt extends Ls{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let i=new rt(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class Ei extends Re{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let i=this.dom.nodeValue.length;e>i&&(e=i);let n=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?L.chrome||L.gecko||(e?(n--,o=1):s<i&&(s++,o=-1)):t<0?n--:s<i&&s++;let a=Gn(this.dom,n,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:t>=0)?0:a.length-1];return L.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,h=>h.width)||l),o?os(l,o<0):l||null}static of(e,t){let i=new Ei(t||document.createTextNode(e),e);return t||(i.flags|=2),i}}class nn extends Re{constructor(e,t,i,n){super(e,t,n),this.widget=i}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,i){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;if(i)return os(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let s=this.dom.getClientRects(),o=null;if(!s.length)return null;let a=this.flags&16?!0:this.flags&32?!1:e>0;for(let l=a?s.length-1:0;o=s[l],!(e>0?l==0:l==s.length-1||o.top<o.bottom);l+=a?-1:1);return os(o,!a)}}get overrideDOMText(){if(!this.length)return fe.empty;let{root:e}=this;if(!e)return fe.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,i,n,s){return s||(s=e.toDOM(t),e.editable||(s.contentEditable="false")),new nn(s,i,e,n)}}class ls extends Re{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!1}get overrideDOMText(){return fe.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class Hg{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,i){let{tile:n,index:s,beforeBreak:o,parents:a}=this;for(;e||t>0;)if(n.isComposite())if(o){if(!e)break;i&&i.break(),e--,o=!1}else if(s==n.children.length){if(!e&&!a.length)break;i&&i.leave(n),o=!!n.breakAfter,{tile:n,index:s}=a.pop(),s++}else{let l=n.children[s],h=l.breakAfter;(t>0?l.length<=e:l.length<e)&&(!i||i.skip(l,0,l.length)!==!1||!l.isComposite)?(o=!!h,s++,e-=l.length):(a.push({tile:n,index:s}),n=l,s=0,i&&l.isComposite()&&i.enter(l))}else if(s==n.length)o=!!n.breakAfter,{tile:n,index:s}=a.pop(),s++;else if(e){let l=Math.min(e,n.length-s);i&&i.skip(n,s,s+l),e-=l,s+=l}else break;return this.tile=n,this.index=s,this.beforeBreak=o,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class qg{constructor(e,t,i,n){this.from=e,this.to=t,this.wrapper=i,this.rank=n}}class Gg{constructor(e,t,i){this.cache=e,this.root=t,this.blockWrappers=i,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,i,n){var s;this.flushBuffer();let o=this.ensureMarks(t,i),a=o.lastChild;if(a&&a.isText()&&!(a.flags&8)){this.cache.reused.set(a,2);let l=o.children[o.children.length-1]=new Ei(a.dom,a.text+e);l.parent=o}else o.append(n||Ei.of(e,(s=this.cache.find(Ei))===null||s===void 0?void 0:s.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let i=this.curLine;i.dom!=t.line.dom&&(i.setDOM(this.cache.reused.has(t.line)?io(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let n=i;for(let o=t.marks.length-1;o>=0;o--){let a=t.marks[o],l=n.lastChild;if(l instanceof rt&&l.mark.eq(a.mark))l.dom!=a.dom&&l.setDOM(io(a.dom)),n=l;else{if(this.cache.reused.get(a)){let c=Re.get(a.dom);c&&c.setDOM(io(a.dom))}let h=rt.of(a.mark,a.dom);n.append(h),n=h}this.cache.reused.set(a,2)}let s=new Ei(e.text,e.text.nodeValue);s.flags|=8,n.append(s)}addInlineWidget(e,t,i){let n=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);n||this.flushBuffer();let s=this.ensureMarks(t,i);!n&&!(e.flags&16)&&s.append(this.getBuffer(1)),s.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,i){this.flushBuffer(),this.ensureMarks(t,i).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var i;e||(e=Ru);let n=tn.start(e,t||((i=this.cache.find(tn))===null||i===void 0?void 0:i.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=n)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var i;let n=this.curLine;for(let s=e.length-1;s>=0;s--){let o=e[s],a;if(t>0&&(a=n.lastChild)&&a instanceof rt&&a.mark.eq(o))n=a,t--;else{let l=rt.of(o,(i=this.cache.find(rt,h=>h.mark.eq(o)))===null||i===void 0?void 0:i.dom);n.append(l),n=l,t=0}}return n}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!yh(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(L.ios&&yh(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(no,0,32)||new nn(no.toDOM(),0,no,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new qg(e.from,e.to,e.value,e.rank),i=this.wrappers.length;for(;i>0&&(this.wrappers[i-1].rank-t.rank||this.wrappers[i-1].to-t.to)<0;)i--;this.wrappers.splice(i,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let i of this.wrappers){let n=t.lastChild;if(i.from<this.pos&&n instanceof ri&&n.wrapper.eq(i.wrapper))t=n;else{let s=ri.of(i.wrapper,(e=this.cache.find(ri,o=>o.wrapper.eq(i.wrapper)))===null||e===void 0?void 0:e.dom);t.append(s),t=s}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),i=this.cache.find(ls,void 0,1);return i&&(i.flags=t),i||new ls(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class Ug{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:n,lineBreak:s,done:o}=this.cursor.next(this.skipCount);if(this.skipCount=0,o)throw new Error("Ran out of text content when drawing inline views");this.text=n;let a=this.textOff=Math.min(e,n.length);return s?null:n.slice(0,a)}let t=Math.min(this.text.length,this.textOff+e),i=this.text.slice(this.textOff,t);return this.textOff=t,i}}const hs=[nn,tn,Ei,rt,ls,ri,Is];for(let r=0;r<hs.length;r++)hs[r].bucket=r;class Kg{constructor(e){this.view=e,this.buckets=hs.map(()=>[]),this.index=hs.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,i=this.buckets[t];i.length<6?i.push(e):i[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,i=2){let n=e.bucket,s=this.buckets[n],o=this.index[n];for(let a=s.length-1;a>=0;a--){let l=(a+o)%s.length,h=s[l];if((!t||t(h))&&!this.reused.has(h))return s.splice(l,1),l<o&&this.index[n]--,this.reused.set(h,i),h}return null}findWidget(e,t,i){let n=this.buckets[0];if(n.length)for(let s=0,o=0;;s++){if(s==n.length){if(o)return null;o=1,s=0}let a=n[s];if(!this.reused.has(a)&&(o==0?a.widget.compare(e):a.widget.constructor==e.constructor&&e.updateDOM(a.dom,this.view)))return n.splice(s,1),s<this.index[0]&&this.index[0]--,this.reused.set(a,1),a.length=t,a.flags=a.flags&-498|i,a}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}}class Jg{constructor(e,t,i,n,s){this.view=e,this.decorations=n,this.disallowBlockEffectsFor=s,this.openWidget=!1,this.openMarks=0,this.cache=new Kg(e),this.text=new Ug(e.state.doc),this.builder=new Gg(this.cache,new Is(e,e.contentDOM),se.iter(i)),this.cache.reused.set(t,2),this.old=new Hg(t)}run(e,t){let i=t&&this.getCompositionContext(t.text);for(let n=0,s=0,o=0;;){let a=o<e.length?e[o++]:null,l=a?a.fromA:this.old.root.length;if(l>n){let h=l-n;this.preserve(h,!o,!a),n=l,s+=h}if(!a)break;this.forward(a.fromA,a.toA),t&&a.fromA<=t.range.fromA&&a.toA>=t.range.toA?(this.emit(s,t.range.fromB),this.builder.addComposition(t,i),this.emit(t.range.toB,a.toB)):this.emit(s,a.toB),s=a.toB,n=a.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,i){let n=Qg(this.old),s=this.openMarks;this.old.advance(e,i?1:-1,{skip:(o,a,l)=>{if(o.isWidget())if(this.openWidget)this.builder.continueWidget(l-a);else{let h=l>0||a<o.length?nn.of(o.widget,this.view,l-a,o.flags&496,this.cache.maybeReuse(o)):this.cache.reuse(o);h.flags&256?(h.flags&=-2,this.builder.addBlockWidget(h)):(this.builder.ensureLine(null),this.builder.addInlineWidget(h,n,s),s=n.length)}else if(o.isText())this.builder.ensureLine(null),!a&&l==o.length?this.builder.addText(o.text,n,s,this.cache.reuse(o)):(this.cache.add(o),this.builder.addText(o.text.slice(a,l),n,s)),s=n.length;else if(o.isLine())o.flags&=-2,this.cache.reused.set(o,1),this.builder.addLine(o);else if(o instanceof ls)this.cache.add(o);else if(o instanceof rt)this.builder.ensureLine(null),this.builder.addMark(o,n,s),this.cache.reused.set(o,1),s=n.length;else return!1;this.openWidget=!1},enter:o=>{o.isLine()?this.builder.addLineStart(o.attrs,this.cache.maybeReuse(o)):(this.cache.add(o),o instanceof rt&&n.unshift(o.mark)),this.openWidget=!1},leave:o=>{o.isLine()?n.length&&(n.length=s=0):o instanceof rt&&(n.shift(),s=Math.min(s,n.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let i=null,n=this.builder,s=0,o=se.spans(this.decorations,e,t,{point:(a,l,h,c,f,u)=>{if(h instanceof Pi){if(this.disallowBlockEffectsFor[u]){if(h.block)throw new RangeError("Block decorations may not be specified via plugins");if(l>this.view.state.doc.lineAt(a).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(s=c.length,f>c.length)n.continueWidget(l-a);else{let d=h.widget||(h.block?rn.block:rn.inline),p=Yg(h),m=this.cache.findWidget(d,l-a,p)||nn.of(d,this.view,l-a,p);h.block?(h.startSide>0&&n.addLineStartIfNotCovered(i),n.addBlockWidget(m)):(n.ensureLine(i),n.addInlineWidget(m,c,f))}i=null}else i=Xg(i,h);l>a&&this.text.skip(l-a)},span:(a,l,h,c)=>{for(let f=a;f<l;){let u=this.text.next(Math.min(512,l-f));u==null?(n.addLineStartIfNotCovered(i),n.addBreak(),f++):(n.ensureLine(i),n.addText(u,h,c),f+=u.length),i=null}}});n.addLineStartIfNotCovered(i),this.openWidget=o>s,this.openMarks=o}forward(e,t){this.old.advance(t-e,1,{skip:(i,n,s)=>{(i.isText()||s==i.length)&&this.cache.add(i)},enter:i=>this.cache.add(i),leave:()=>{},break:()=>{}})}getCompositionContext(e){let t=[],i=null;for(let n=e.parentNode;;n=n.parentNode){let s=Re.get(n);if(n==this.view.contentDOM)break;s instanceof rt?t.push(s):s?.isLine()?i=s:n.nodeName=="DIV"&&!i&&n!=this.view.contentDOM?i=new tn(n,Ru):t.push(rt.of(new or({tagName:n.nodeName.toLowerCase(),attributes:Sg(n)}),n))}return{line:i,marks:t}}}function yh(r,e){let t=i=>{for(let n of i.children)if((e?n.isText():n.length)||t(n))return!0;return!1};return t(r)}function Yg(r){let e=r.isReplace?(r.startSide<0?64:0)|(r.endSide>0?128:0):r.startSide>0?32:16;return r.block&&(e|=256),e}const Ru={class:"cm-line"};function Xg(r,e){let t=e.spec.attributes,i=e.spec.class;return!t&&!i||(r||(r={class:"cm-line"}),t&&Za(t,r),i&&(r.class+=" "+i)),r}function Qg(r){let e=[];for(let t=r.parents.length;t>1;t--){let i=t==r.parents.length?r.tile:r.parents[t].tile;i instanceof rt&&e.push(i.mark)}return e}function io(r){let e=Re.get(r);return e&&e.setDOM(r.cloneNode()),r}class rn extends Xt{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}rn.inline=new rn("span");rn.block=new rn("div");const no=new class extends Xt{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class vh{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=J.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Is(e,e.contentDOM),this.updateInner([new gt(0,0,0,e.state.doc.length)],null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:c,toA:f})=>f<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?n=this.domChanged.newSel.head:!a0(e.changes,this.hasComposition)&&!e.selectionSet&&(n=e.state.selection.main.head));let s=n>-1?e0(this.view,e.changes,n):null;if(this.domChanged=null,this.hasComposition){let{from:c,to:f}=this.hasComposition;i=new gt(c,f,e.changes.mapPos(c,-1),e.changes.mapPos(f,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(L.ie||L.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.blockWrappers;this.updateDeco();let l=n0(o,this.decorations,e.changes);l.length&&(i=gt.extendWithRanges(i,l));let h=s0(a,this.blockWrappers,e.changes);return h.length&&(i=gt.extendWithRanges(i,h)),s&&!i.some(c=>c.fromA<=s.range.fromA&&c.toA>=s.range.toA)&&(i=s.range.addToSet(i.slice())),this.tile.flags&2&&i.length==0?!1:(this.updateInner(i,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:i}=this.view;i.ignore(()=>{if(t||e.length){let o=this.tile,a=new Jg(this.view,o,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=a.run(e,t),ma(o,a.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=L.chrome||L.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(s),s&&(s.written||i.selectionRange.focusNode!=s.node||!this.tile.dom.contains(s.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.tile.children)s.isWidget()&&s.widget instanceof ro&&n.push(s.dom);i.updateGaps(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(Cu)&&(this.editContextFormatting=i.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:i}=this.tile,n=this.view.root.activeElement,s=n==i,o=!s&&!(this.view.state.facet(Wt)||i.tabIndex>-1)&&qr(i,this.view.observer.selectionRange)&&!(n&&i.contains(n));if(!(s||t||o))return;let a=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,h,c;if(l.empty?c=h=this.inlineDOMNearPos(l.anchor,l.assoc||1):(c=this.inlineDOMNearPos(l.head,l.head==l.from?1:-1),h=this.inlineDOMNearPos(l.anchor,l.anchor==l.from?1:-1)),L.gecko&&l.empty&&!this.hasComposition&&Zg(h)){let u=document.createTextNode("");this.view.observer.ignore(()=>h.node.insertBefore(u,h.node.childNodes[h.offset]||null)),h=c=new St(u,0),a=!0}let f=this.view.observer.selectionRange;(a||!f.focusNode||(!Dn(h.node,h.offset,f.anchorNode,f.anchorOffset)||!Dn(c.node,c.offset,f.focusNode,f.focusOffset))&&!this.suppressWidgetCursorChange(f,l))&&(this.view.observer.ignore(()=>{L.android&&L.chrome&&i.contains(f.focusNode)&&o0(f.focusNode,i)&&(i.blur(),i.focus({preventScroll:!0}));let u=qn(this.view.root);if(u)if(l.empty){if(L.gecko){let d=t0(h.node,h.offset);if(d&&d!=3){let p=(d==1?lu:hu)(h.node,h.offset);p&&(h=new St(p.node,p.offset))}}u.collapse(h.node,h.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(h.node,h.offset);try{u.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();l.anchor>l.head&&([h,c]=[c,h]),d.setEnd(c.node,c.offset),d.setStart(h.node,h.offset),u.removeAllRanges(),u.addRange(d)}o&&this.view.root.activeElement==i&&(i.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(h,c)),this.impreciseAnchor=h.precise?null:new St(f.anchorNode,f.anchorOffset),this.impreciseHead=c.precise?null:new St(f.focusNode,f.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Dn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=qn(e.root),{anchorNode:n,anchorOffset:s}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let o=this.lineAt(t.head,t.assoc);if(!o)return;let a=o.posAtStart;if(t.head==a||t.head==a+o.length)return;let l=this.coordsAt(t.head,-1),h=this.coordsAt(t.head,1);if(!l||!h||l.bottom>h.top)return;let c=this.domAtPos(t.head+t.assoc,t.assoc);i.collapse(c.node,c.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&i.collapse(n,s)}posFromDOM(e,t){let i=this.tile.nearest(e);if(!i)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let n=i.posAtStart;if(i.isComposite()){let s;if(e==i.dom)s=i.dom.childNodes[t];else{let o=Yt(e)==0?0:t==0?-1:1;for(;;){let a=e.parentNode;if(a==i.dom)break;o==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?o=-1:o=1),e=a}o<0?s=e:s=e.nextSibling}if(s==i.dom.firstChild)return n;for(;s&&!Re.get(s);)s=s.nextSibling;if(!s)return n+i.length;for(let o=0,a=n;;o++){let l=i.children[o];if(l.dom==s)return a;a+=l.length+l.breakAfter}}else return i.isText()?e==i.dom?n+t:n+(t?i.length:0):n}domAtPos(e,t){let{tile:i,offset:n}=this.tile.resolveBlock(e,t);return i.isWidget()?i.domPosFor(e,t):i.domIn(n,t)}inlineDOMNearPos(e,t){let i,n=-1,s=!1,o,a=-1,l=!1;return this.tile.blockTiles((h,c)=>{if(h.isWidget()){if(h.flags&32&&c>=e)return!0;h.flags&16&&(s=!0)}else{let f=c+h.length;if(c<=e&&(i=h,n=e-c,s=f<e),f>=e&&!o&&(o=h,a=e-c,l=c>e),c>e&&o)return!0}}),!i&&!o?this.domAtPos(e,t):(s&&o?i=null:l&&i&&(o=null),i&&t<0||!o?i.domIn(n,t):o.domIn(a,t))}coordsAt(e,t){let{tile:i,offset:n}=this.tile.resolveBlock(e,t);return i.isWidget()?i.widget instanceof ro?null:i.coordsInWidget(n,t,!0):i.coordsIn(n,t)}lineAt(e,t){let{tile:i}=this.tile.resolveBlock(e,t);return i.isLine()?i:null}coordsForChar(e){let{tile:t,offset:i}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function n(s,o){if(s.isComposite())for(let a of s.children){if(a.length>=o){let l=n(a,o);if(l)return l}if(o-=a.length,o<0)break}else if(s.isText()&&o<s.length){let a=Me(s.text,o);if(a==o)return null;let l=Gn(s.dom,o,a).getClientRects();for(let h=0;h<l.length;h++){let c=l[h];if(h==l.length-1||c.top<c.bottom&&c.left<c.right)return c}}return null}return n(t,i)}measureVisibleLineHeights(e){let t=[],{from:i,to:n}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==ve.LTR,h=0,c=(f,u,d)=>{for(let p=0;p<f.children.length&&!(u>n);p++){let m=f.children[p],g=u+m.length,b=m.dom.getBoundingClientRect(),{height:y}=b;if(d&&!p&&(h+=b.top-d.top),m instanceof ri)g>i&&c(m,u,b);else if(u>=i&&(h>0&&t.push(-h),t.push(y+h),h=0,o)){let x=m.dom.lastChild,E=x?Gr(x):[];if(E.length){let A=E[E.length-1],O=l?A.right-b.left:b.right-A.left;O>a&&(a=O,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=g)}}d&&p==f.children.length-1&&(h+=d.bottom-b.bottom),u=g+m.breakAfter}};return c(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?ve.RTL:ve.LTR}measureTextSize(){let e=this.tile.blockTiles(o=>{if(o.isLine()&&o.children.length&&o.length<=20){let a=0,l;for(let h of o.children){if(!h.isText()||/[^ -~]/.test(h.text))return;let c=Gr(h.dom);if(c.length!=1)return;a+=c[0].width,l=c[0].height}if(a)return{lineHeight:o.dom.getBoundingClientRect().height,charWidth:a/o.length,textHeight:l}}});if(e)return e;let t=document.createElement("div"),i,n,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let o=Gr(t.firstChild)[0];i=t.getBoundingClientRect().height,n=o&&o.width?o.width/27:7,s=o&&o.height?o.height:i,t.remove()}),{lineHeight:i,charWidth:n,textHeight:s}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,n=0;;n++){let s=n==t.viewports.length?null:t.viewports[n],o=s?s.from-1:this.view.state.doc.length;if(o>i){let a=(t.lineBlockAt(o).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(J.replace({widget:new ro(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return J.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Un).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),i=!1,n=this.view.state.facet(Tu).map((s,o)=>{let a=typeof s=="function";return a&&(i=!0),a?s(this.view):s});for(n.length&&(this.dynamicDecorationMap[e++]=i,t.push(se.join(n))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(Au).map(s=>typeof s=="function"?s(this.view):s)}scrollIntoView(e){if(e.isSnapshot){let h=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=h.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let h of this.view.state.facet(Su))try{if(h(this.view,e.range,e))return!0}catch(c){Bt(this.view.state,c,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!i)return;!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let s=Mu(this.view),o={left:i.left-s.left,top:i.top-s.top,right:i.right+s.right,bottom:i.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;Ag(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==ve.LTR)}lineHasWidget(e){let t=i=>i.isWidget()||i.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){ma(this.tile)}}function ma(r,e){let t=e?.get(r);if(t!=1){t==null&&r.destroy();for(let i of r.children)ma(i,e)}}function Zg(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function Du(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let i=lu(t.focusNode,t.focusOffset),n=hu(t.focusNode,t.focusOffset),s=i||n;if(n&&i&&n.node!=i.node){let a=Re.get(n.node);if(!a||a.isText()&&a.text!=n.node.nodeValue)s=n;else if(r.docView.lastCompositionAfterCursor){let l=Re.get(i.node);!l||l.isText()&&l.text!=i.node.nodeValue||(s=n)}}if(r.docView.lastCompositionAfterCursor=s!=i,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function e0(r,e,t){let i=Du(r,t);if(!i)return null;let{node:n,from:s,to:o}=i,a=n.nodeValue;if(/[\n\r]/.test(a)||r.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc;return{range:new gt(l.mapPos(s),l.mapPos(o),s,o),text:n}}function t0(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let i0=class{constructor(){this.changes=[]}compareRange(e,t){Ui(e,t,this.changes)}comparePoint(e,t){Ui(e,t,this.changes)}boundChange(e){Ui(e,e,this.changes)}};function n0(r,e,t){let i=new i0;return se.compare(r,e,t,i),i.changes}class r0{constructor(){this.changes=[]}compareRange(e,t){Ui(e,t,this.changes)}comparePoint(){}boundChange(e){Ui(e,e,this.changes)}}function s0(r,e,t){let i=new r0;return se.compare(r,e,t,i),i.changes}function o0(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function a0(r,e){let t=!1;return e&&r.iterChangedRanges((i,n)=>{i<e.to&&n>e.from&&(t=!0)}),t}class ro extends Xt{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function l0(r,e,t=1){let i=r.charCategorizer(e),n=r.doc.lineAt(e),s=e-n.from;if(n.length==0)return _.cursor(e);s==0?t=1:s==n.length&&(t=-1);let o=s,a=s;t<0?o=Me(n.text,s,!1):a=Me(n.text,s);let l=i(n.text.slice(o,a));for(;o>0;){let h=Me(n.text,o,!1);if(i(n.text.slice(h,o))!=l)break;o=h}for(;a<n.length;){let h=Me(n.text,a);if(i(n.text.slice(a,h))!=l)break;a=h}return _.range(o+n.from,a+n.from)}function h0(r,e,t,i,n){let s=Math.round((i-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let a=r.viewState.heightOracle.textHeight,l=Math.floor((n-t.top-(r.defaultLineHeight-a)*.5)/a);s+=l*r.viewState.heightOracle.lineLength}let o=r.state.sliceDoc(t.from,t.to);return t.from+na(o,s,r.state.tabSize)}function ga(r,e,t){let i=r.lineBlockAt(e);if(Array.isArray(i.type)){let n;for(let s of i.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!n||s.type==We.Text&&(n.type!=s.type||(t<0?s.from<e:s.to>e)))&&(n=s)}}return n||i}return i}function c0(r,e,t,i){let n=ga(r,e.head,e.assoc||-1),s=!i||n.type!=We.Text||!(r.lineWrapping||n.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>n.from?e.head-1:e.head);if(s){let o=r.dom.getBoundingClientRect(),a=r.textDirectionAt(n.from),l=r.posAtCoords({x:t==(a==ve.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return _.cursor(l,t?-1:1)}return _.cursor(t?n.to:n.from,t?-1:1)}function xh(r,e,t,i){let n=r.state.doc.lineAt(e.head),s=r.bidiSpans(n),o=r.textDirectionAt(n.from);for(let a=e,l=null;;){let h=jg(n,s,o,a,t),c=pu;if(!h){if(n.number==(t?r.state.doc.lines:1))return a;c=`
`,n=r.state.doc.line(n.number+(t?1:-1)),s=r.bidiSpans(n),h=r.visualLineSide(n,!t)}if(l){if(!l(c))return a}else{if(!i)return h;l=i(c)}a=h}}function f0(r,e,t){let i=r.state.charCategorizer(e),n=i(t);return s=>{let o=i(s);return n==Ee.Space&&(n=o),n==o}}function u0(r,e,t,i){let n=e.head,s=t?1:-1;if(n==(t?r.state.doc.length:0))return _.cursor(n,e.assoc);let o=e.goalColumn,a,l=r.contentDOM.getBoundingClientRect(),h=r.coordsAtPos(n,e.assoc||-1),c=r.documentTop;if(h)o==null&&(o=h.left-l.left),a=s<0?h.top:h.bottom;else{let d=r.viewState.lineBlockAt(n);o==null&&(o=Math.min(l.right-l.left,r.defaultCharacterWidth*(n-d.from))),a=(s<0?d.top:d.bottom)+c}let f=l.left+o,u=i??r.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=a+(u+d)*s,m=ba(r,{x:f,y:p},!1,s);return _.cursor(m.pos,m.assoc,void 0,o)}}function Pn(r,e,t){for(;;){let i=0;for(let n of r)n.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=i||t||(e-s<o-e?-1:1);e=l<0?s:o,i=l}});if(!i)return e}}function Pu(r,e){let t=null;for(let i=0;i<e.ranges.length;i++){let n=e.ranges[i],s=null;if(n.empty){let o=Pn(r,n.from,0);o!=n.from&&(s=_.cursor(o,-1))}else{let o=Pn(r,n.from,-1),a=Pn(r,n.to,1);(o!=n.from||a!=n.to)&&(s=_.range(n.from==n.anchor?o:a,n.from==n.head?o:a))}s&&(t||(t=e.ranges.slice()),t[i]=s)}return t?_.create(t,e.mainIndex):e}function so(r,e,t){let i=Pn(r.state.facet(lr).map(n=>n(r)),t.from,e.head>t.from?-1:1);return i==t.from?t:_.cursor(i,i<t.from?1:-1)}class Nt{constructor(e,t){this.pos=e,this.assoc=t}}function ba(r,e,t,i){let n=r.contentDOM.getBoundingClientRect(),s=n.top+r.viewState.paddingTop,{x:o,y:a}=e,l=a-s,h;for(;;){if(l<0)return new Nt(0,1);if(l>r.viewState.docHeight)return new Nt(r.state.doc.length,-1);if(h=r.elementAtHeight(l),i==null)break;if(h.type==We.Text){let u=r.docView.coordsAt(i<0?h.from:h.to,i);if(u&&(i<0?u.top<=l+s:u.bottom>=l+s))break}let f=r.viewState.heightOracle.textHeight/2;l=i>0?h.bottom+f:h.top-f}if(r.viewport.from>=h.to||r.viewport.to<=h.from){if(t)return null;if(h.type==We.Text){let f=h0(r,n,h,o,a);return new Nt(f,f==h.from?1:-1)}}if(h.type!=We.Text)return l<(h.top+h.bottom)/2?new Nt(h.from,1):new Nt(h.to,-1);let c=r.docView.lineAt(h.from,2);return(!c||c.length!=h.length)&&(c=r.docView.lineAt(h.from,-2)),Lu(r,c,h.from,o,a)}function Lu(r,e,t,i,n){let s=-1,o=null,a=1e9,l=1e9,h=n,c=n,f=(u,d)=>{for(let p=0;p<u.length;p++){let m=u[p];if(m.top==m.bottom)continue;let g=m.left>i?m.left-i:m.right<i?i-m.right:0,b=m.top>n?m.top-n:m.bottom<n?n-m.bottom:0;m.top<=c&&m.bottom>=h&&(h=Math.min(m.top,h),c=Math.max(m.bottom,c),b=0),(s<0||(b-l||g-a)<0)&&(s>=0&&l&&a<g&&o.top<=c-2&&o.bottom>=h+2?l=0:(s=d,a=g,l=b,o=m))}};if(e.isText()){for(let d=0;d<e.length;){let p=Me(e.text,d);if(f(Gn(e.dom,d,p).getClientRects(),d),!a&&!l)break;d=p}return i>(o.left+o.right)/2==(kh(r,s+t)==ve.LTR)?new Nt(t+Me(e.text,s),-1):new Nt(t+s,1)}else{if(!e.length)return new Nt(t,1);for(let m=0;m<e.children.length;m++){let g=e.children[m];if(g.flags&48)continue;let b=(g.dom.nodeType==1?g.dom:Gn(g.dom,0,g.length)).getClientRects();if(f(b,m),!a&&!l)break}let u=e.children[s],d=e.posBefore(u,t);return u.isComposite()||u.isText()?Lu(r,u,d,Math.max(o.left,Math.min(o.right,i)),n):i>(o.left+o.right)/2==(kh(r,s+t)==ve.LTR)?new Nt(d+u.length,-1):new Nt(d,1)}}function kh(r,e){let t=r.state.doc.lineAt(e);return r.bidiSpans(t)[Ht.find(r.bidiSpans(t),e-t.from,-1,1)].dir}const kn="";class d0{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ie.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=kn}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let n=e;;){this.findPointBefore(i,n);let s=this.text.length;this.readNode(n);let o=Re.get(n),a=n.nextSibling;if(a==t){o?.breakAfter&&!a&&this.lineBreak();break}let l=Re.get(a);(o&&l?o.breakAfter:(o?o.breakAfter:ss(n))||ss(a)&&(n.nodeName!="BR"||o?.isWidget())&&this.text.length>s)&&!m0(a,t)&&this.lineBreak(),n=a}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=n.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=s+o}}readNode(e){let t=Re.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(p0(e,i.node,i.offset)?t:0))}}function p0(r,e,t){for(;;){if(!e||t<Yt(e))return!1;if(e==r)return!0;t=hi(e)+1,e=e.parentNode}}function m0(r,e){let t;for(;!(r==e||!r);r=r.nextSibling){let i=Re.get(r);if(!i?.isWidget())return!1;i&&(t||(t=[])).push(i)}if(t)for(let i of t){let n=i.overrideDOMText;if(n?.length)return!1}return!0}class wh{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class g0{constructor(e,t,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=Iu(e.docView.tile,t,i,0))){let a=s||o?[]:y0(e),l=new d0(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=v0(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!ca(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),h=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!ca(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),c=e.viewport;if((L.ios||L.chrome)&&e.state.selection.main.empty&&l!=h&&(c.from>0||c.to<e.state.doc.length)){let f=Math.min(l,h),u=Math.max(l,h),d=c.from-f,p=c.to-u;(d==0||d==1||f==0)&&(p==0||p==-1||u==e.state.doc.length)&&(l=0,h=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(_.range(h,l)):this.newSel=_.single(h,l)}}}function Iu(r,e,t,i){if(r.isComposite()){let n=-1,s=-1,o=-1,a=-1;for(let l=0,h=i,c=i;l<r.children.length;l++){let f=r.children[l],u=h+f.length;if(h<e&&u>t)return Iu(f,e,t,h);if(u>=e&&n==-1&&(n=l,s=h),h>t&&f.dom.parentNode==r.dom){o=l,a=c;break}c=u,h=u+f.breakAfter}return{from:s,to:a<0?i+r.length:a,startDOM:(n?r.children[n-1].dom.nextSibling:null)||r.dom.firstChild,endDOM:o<r.children.length&&o>=0?r.children[o].dom:null}}else return r.isText()?{from:i,to:i+r.length,startDOM:r.dom,endDOM:r.dom.nextSibling}:null}function Nu(r,e){let t,{newSel:i}=e,n=r.state.selection.main,s=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=n.from,h=null;(s===8||L.android&&e.text.length<a-o)&&(l=n.to,h="end");let c=Bu(r.state.doc.sliceString(o,a,kn),e.text,l-o,h);c&&(L.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==kn+kn&&c.toB--,t={from:o+c.from,to:o+c.toA,insert:fe.of(e.text.slice(c.from,c.toB).split(kn))})}else i&&(!r.hasFocus&&r.state.facet(Wt)||i.main.eq(n))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!n.empty&&i&&i.main.empty?t={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,n.to)}:(L.mac||L.android)&&t&&t.from==t.to&&t.from==n.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=_.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:fe.of([t.insert.toString().replace("."," ")])}):t&&t.from>=n.from&&t.to<=n.to&&(t.from!=n.from||t.to!=n.to)&&n.to-n.from-(t.to-t.from)<=4?t={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,n.to))}:r.state.doc.lineAt(n.from).to<n.to&&r.docView.lineHasWidget(n.to)&&r.inputState.insertingTextAt>Date.now()-50?t={from:n.from,to:n.to,insert:r.state.toText(r.inputState.insertingText)}:L.chrome&&t&&t.from==t.to&&t.from==n.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=_.single(i.main.anchor-1,i.main.head-1)),t={from:n.from,to:n.to,insert:fe.of([" "])}),t)return rl(r,t,i,s);if(i&&!i.main.eq(n)){let o=!1,a="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(o=!0),a=r.inputState.lastSelectionOrigin,a=="select.pointer"&&(i=Pu(r.state.facet(lr).map(l=>l(r)),i))),r.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function rl(r,e,t,i=-1){if(L.ios&&r.inputState.flushIOSKey(e))return!0;let n=r.state.selection.main;if(L.android&&(e.to==n.to&&(e.from==n.from||e.from==n.from-1&&r.state.sliceDoc(e.from,n.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Ki(r.contentDOM,"Enter",13)||(e.from==n.from-1&&e.to==n.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>n.head)&&Ki(r.contentDOM,"Backspace",8)||e.from==n.from&&e.to==n.to+1&&e.insert.length==0&&Ki(r.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let o,a=()=>o||(o=b0(r,e,t));return r.state.facet(vu).some(l=>l(r,e.from,e.to,s,a))||r.dispatch(a()),!0}function b0(r,e,t){let i,n=r.state,s=n.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let l=e.from<s.from?-1:1,h=l<0?s.from:s.to,c=Pn(n.facet(lr).map(f=>f(r)),h,l);e.from==c&&(o=c)}if(o>-1)i={changes:e,selection:_.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let l=s.from<e.from?n.sliceDoc(s.from,e.from):"",h=s.to>e.to?n.sliceDoc(e.to,s.to):"";i=n.replaceSelection(r.state.toText(l+e.insert.sliceString(0,void 0,r.state.lineBreak)+h))}else{let l=n.changes(e),h=t&&t.main.to<=l.newLength?t.main:void 0;if(n.selection.ranges.length>1&&(r.inputState.composing>=0||r.inputState.compositionPendingChange)&&e.to<=s.to+10&&e.to>=s.to-10){let c=r.state.sliceDoc(e.from,e.to),f,u=t&&Du(r,t.main.head);if(u){let p=e.insert.length-(e.to-e.from);f={from:u.from,to:u.to-p}}else f=r.state.doc.lineAt(s.head);let d=s.to-e.to;i=n.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:l,range:h||p.map(l)};let m=p.to-d,g=m-c.length;if(r.state.sliceDoc(g,m)!=c||m>=f.from&&g<=f.to)return{range:p};let b=n.changes({from:g,to:m,insert:e.insert}),y=p.to-s.to;return{changes:b,range:h?_.range(Math.max(0,h.anchor+y),Math.max(0,h.head+y)):p.map(b)}})}else i={changes:l,selection:h&&n.selection.replaceRange(h)}}let a="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,a+=".compose",r.inputState.compositionFirstChange&&(a+=".start",r.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:a,scrollIntoView:!0})}function Bu(r,e,t,i){let n=Math.min(r.length,e.length),s=0;for(;s<n&&r.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==n&&r.length==e.length)return null;let o=r.length,a=e.length;for(;o>0&&a>0&&r.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,s-Math.min(o,a));t-=o+l-s}if(o<s&&r.length<e.length){let l=t<=s&&t>=o?s-t:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=t<=s&&t>=a?s-t:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function y0(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:n,focusOffset:s}=r.observer.selectionRange;return t&&(e.push(new wh(t,i)),(n!=t||s!=i)&&e.push(new wh(n,s))),e}function v0(r,e){if(r.length==0)return null;let t=r[0].pos,i=r.length==2?r[1].pos:t;return t>-1&&i>-1?_.single(t+e,i+e):null}class x0{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,L.safari&&e.contentDOM.addEventListener("input",()=>null),L.gecko&&I0(e.contentDOM.ownerDocument)}handleEvent(e){!E0(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let n of i.observers)n(this.view,t);for(let n of i.handlers){if(t.defaultPrevented)break;if(n(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=k0(e),i=this.handlers,n=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,a=i[s];a&&o!=!a.handlers.length&&(n.removeEventListener(s,this.handleEvent),a=null),a||n.addEventListener(s,this.handleEvent,{passive:o})}for(let s in i)s!="scroll"&&!t[s]&&n.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Fu.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),L.android&&L.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return L.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=ju.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||w0.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Ki(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:L.safari&&!L.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Sh(r,e){return(t,i)=>{try{return e.call(r,i,t)}catch(n){Bt(t.state,n)}}}function k0(r){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of r){let n=i.spec,s=n&&n.plugin.domEventHandlers,o=n&&n.plugin.domEventObservers;if(s)for(let a in s){let l=s[a];l&&t(a).handlers.push(Sh(i.value,l))}if(o)for(let a in o){let l=o[a];l&&t(a).observers.push(Sh(i.value,l))}}for(let i in _t)t(i).handlers.push(_t[i]);for(let i in xt)t(i).observers.push(xt[i]);return e}const ju=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],w0="dthko",Fu=[16,17,18,20,91,92,224,225],Ar=6;function Tr(r){return Math.max(0,r)*.7+8}function S0(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class C0{constructor(e,t,i,n){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=Tg(e.contentDOM),this.atoms=e.state.facet(lr).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ie.allowMultipleSelections)&&_0(e,t),this.dragging=T0(e,t)&&Vu(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&S0(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,n=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=Mu(this.view);e.clientX-l.left<=n+Ar?t=-Tr(n-e.clientX):e.clientX+l.right>=o-Ar&&(t=Tr(e.clientX-o)),e.clientY-l.top<=s+Ar?i=-Tr(s-e.clientY):e.clientY+l.bottom>=a-Ar&&(i=Tr(e.clientY-a)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=Pu(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function _0(r,e){let t=r.state.facet(mu);return t.length?t[0](e):L.mac?e.metaKey:e.ctrlKey}function A0(r,e){let t=r.state.facet(gu);return t.length?t[0](e):L.mac?!e.altKey:!e.ctrlKey}function T0(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let i=qn(r.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let s=0;s<n.length;s++){let o=n[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function E0(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=Re.get(t))&&i.isWidget()&&!i.isHidden&&i.widget.ignoreEvent(e))return!1;return!0}const _t=Object.create(null),xt=Object.create(null),$u=L.ie&&L.ie_version<15||L.ios&&L.webkit_version<604;function O0(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),zu(r,t.value)},50)}function Ns(r,e,t){for(let i of r.facet(e))t=i(t,r);return t}function zu(r,e){e=Ns(r.state,il,e);let{state:t}=r,i,n=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(ya!=null&&t.selection.ranges.every(l=>l.empty)&&ya==s.toString()){let l=-1;i=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==l)return{range:h};l=c.from;let f=t.toText((o?s.line(n++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:f},range:_.cursor(h.from+f.length)}})}else o?i=t.changeByRange(l=>{let h=s.line(n++);return{changes:{from:l.from,to:l.to,insert:h.text},range:_.cursor(l.from+h.length)}}):i=t.replaceSelection(s);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}xt.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};_t.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);xt.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};xt.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};_t.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of r.state.facet(bu))if(t=i(r,e),t)break;if(!t&&e.button==0&&(t=R0(r,e)),t){let i=!r.hasFocus;r.inputState.startMouseSelection(new C0(r,e,t,i)),i&&r.observer.ignore(()=>{ou(r.contentDOM);let s=r.root.activeElement;s&&!s.contains(r.contentDOM)&&s.blur()});let n=r.inputState.mouseSelection;if(n)return n.start(e),n.dragging===!1}else r.inputState.setSelectionOrigin("select.pointer");return!1};function Ch(r,e,t,i){if(i==1)return _.cursor(e,t);if(i==2)return l0(r.state,e,t);{let n=r.docView.lineAt(e,t),s=r.state.doc.lineAt(n?n.posAtEnd:e),o=n?n.posAtStart:s.from,a=n?n.posAtEnd:s.to;return a<r.state.doc.length&&a==s.to&&a++,_.range(o,a)}}const M0=L.ie&&L.ie_version<=11;let _h=null,Ah=0,Th=0;function Vu(r){if(!M0)return r.detail;let e=_h,t=Th;return _h=r,Th=Date.now(),Ah=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Ah+1)%3:1}function R0(r,e){let t=r.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),i=Vu(e),n=r.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),n=n.map(s.changes))},get(s,o,a){let l=r.posAndSideAtCoords({x:s.clientX,y:s.clientY},!1),h,c=Ch(r,l.pos,l.assoc,i);if(t.pos!=l.pos&&!o){let f=Ch(r,t.pos,t.assoc,i),u=Math.min(f.from,c.from),d=Math.max(f.to,c.to);c=u<c.from?_.range(u,d):_.range(d,u)}return o?n.replaceRange(n.main.extend(c.from,c.to)):a&&i==1&&n.ranges.length>1&&(h=D0(n,l.pos))?h:a?n.addRange(c):_.create([c])}}}function D0(r,e){for(let t=0;t<r.ranges.length;t++){let{from:i,to:n}=r.ranges[t];if(i<=e&&n>=e)return _.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}_t.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let n=r.docView.tile.nearest(e.target);if(n&&n.isWidget()){let s=n.posAtStart,o=s+n.length;(s>=t.to||o<=t.from)&&(t=_.range(s,o))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Ns(r.state,nl,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};_t.dragend=r=>(r.inputState.draggedContent=null,!1);function Eh(r,e,t,i){if(t=Ns(r.state,il,t),!t)return;let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=r.inputState,o=i&&s&&A0(r,e)?{from:s.from,to:s.to}:null,a={from:n,insert:t},l=r.state.changes(o?[o,a]:a);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(n,-1),head:l.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"}),r.inputState.draggedContent=null}_t.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),n=0,s=()=>{++n==t.length&&Eh(r,e,i.filter(o=>o!=null).join(r.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),s()},a.readAsText(t[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return Eh(r,e,i,!0),!0}return!1};_t.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=$u?null:e.clipboardData;return t?(zu(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(O0(r),!1)};function P0(r,e){let t=r.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function L0(r){let e=[],t=[],i=!1;for(let n of r.selection.ranges)n.empty||(e.push(r.sliceDoc(n.from,n.to)),t.push(n));if(!e.length){let n=-1;for(let{from:s}of r.selection.ranges){let o=r.doc.lineAt(s);o.number>n&&(e.push(o.text),t.push({from:o.from,to:Math.min(r.doc.length,o.to+1)})),n=o.number}i=!0}return{text:Ns(r,nl,e.join(r.lineBreak)),ranges:t,linewise:i}}let ya=null;_t.copy=_t.cut=(r,e)=>{let{text:t,ranges:i,linewise:n}=L0(r.state);if(!t&&!n)return!1;ya=n?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=$u?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(P0(r,t),!1)};const Wu=bi.define();function Hu(r,e){let t=[];for(let i of r.facet(xu)){let n=i(r,e);n&&t.push(n)}return t.length?r.update({effects:t,annotations:Wu.of(!0)}):null}function qu(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=Hu(r.state,e);t?r.dispatch(t):r.update([])}},10)}xt.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),qu(r)};xt.blur=r=>{r.observer.clearSelectionRange(),qu(r)};xt.compositionstart=xt.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};xt.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,L.chrome&&L.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};xt.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};_t.beforeinput=(r,e)=>{var t,i;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(r.inputState.insertingText=e.data,r.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&r.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],l=r.posAtDOM(a.startContainer,a.startOffset),h=r.posAtDOM(a.endContainer,a.endOffset);return rl(r,{from:l,to:h,insert:r.state.toText(s)},null),!0}}let n;if(L.chrome&&L.android&&(n=ju.find(s=>s.inputType==e.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return L.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),L.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>xt.compositionend(r,e),20),!1};const Oh=new Set;function I0(r){Oh.has(r)||(Oh.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const Mh=["pre-wrap","normal","pre-line","break-spaces"];let sn=!1;function Rh(){sn=!1}class N0{constructor(e){this.lineWrapping=e,this.doc=fe.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Mh.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let n=e[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(t=!0,this.heightSamples[Math.floor(n*10)]=!0)}return t}refresh(e,t,i,n,s,o){let a=Mh.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let h=0;h<o.length;h++){let c=o[h];c<0?h++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class B0{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class wt{constructor(e,t,i,n,s){this.from=e,this.length=t,this.top=i,this.height=n,this._content=s}get type(){return typeof this._content=="number"?We.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Pi?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new wt(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var be=(function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r})(be||(be={}));const Ur=.001;class tt{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Ur&&(sn=!0),this.height=e)}replace(e,t,i){return tt.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,n){let s=this,o=i.doc;for(let a=n.length-1;a>=0;a--){let{fromA:l,toA:h,fromB:c,toB:f}=n[a],u=s.lineAt(l,be.ByPosNoHeight,i.setDoc(t),0,0),d=u.to>=h?u:s.lineAt(h,be.ByPosNoHeight,i,0,0);for(f+=d.to-h,h=d.to;a>0&&u.from<=n[a-1].toA;)l=n[a-1].fromA,c=n[a-1].fromB,a--,l<u.from&&(u=s.lineAt(l,be.ByPosNoHeight,i,0,0));c+=u.from-l,l=u.from;let p=sl.build(i.setDoc(o),e,c,f);s=cs(s,s.replace(l,h,p))}return s.updateHeight(i,0)}static empty(){return new lt(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,n=0,s=0;for(;;)if(t==i)if(n>s*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),i+=1+a.break,n-=a.size}else if(s>n*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,s-=a.size}else break;else if(n<s){let a=e[t++];a&&(n+=a.size)}else{let a=e[--i];a&&(s+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new F0(tt.of(e.slice(0,t)),o,tt.of(e.slice(i)))}}function cs(r,e){return r==e?r:(r.constructor!=e.constructor&&(sn=!0),e)}tt.prototype.size=1;const j0=J.replace({});class Gu extends tt{constructor(e,t,i){super(e,t),this.deco=i,this.spaceAbove=0}mainBlock(e,t){return new wt(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,i,n){return this.spaceAbove&&e<i+this.spaceAbove?new wt(n,0,i,this.spaceAbove,j0):this.mainBlock(i,n)}lineAt(e,t,i,n,s){let o=this.mainBlock(n,s);return this.spaceAbove?this.blockAt(0,i,n,s).join(o):o}forEachLine(e,t,i,n,s,o){e<=s+this.length&&t>=s&&o(this.lineAt(0,be.ByPos,i,n,s))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more&&this.setMeasuredHeight(n),this.outdated=!1,this}toString(){return`block(${this.length})`}}class lt extends Gu{constructor(e,t,i){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=i}mainBlock(e,t){return new wt(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,i){let n=i[0];return i.length==1&&(n instanceof lt||n instanceof je&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof je?n=new lt(n.length,this.height,this.spaceAbove):n.height=this.height,this.outdated||(n.outdated=!1),n):tt.of(i)}updateHeight(e,t=0,i=!1,n){return n&&n.from<=t&&n.more?this.setMeasuredHeight(n):(i||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class je extends tt{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,n=e.doc.lineAt(t+this.length).number,s=n-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:i,lastLine:n,perLine:o,perChar:a}}blockAt(e,t,i,n){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(t,n);if(t.lineWrapping){let h=n+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),c=t.doc.lineAt(h),f=a+c.length*l,u=Math.max(i,e-f/2);return new wt(c.from,c.length,u,f,0)}else{let h=Math.max(0,Math.min(o-s,Math.floor((e-i)/a))),{from:c,length:f}=t.doc.line(s+h);return new wt(c,f,i+a*h,a,0)}}lineAt(e,t,i,n,s){if(t==be.ByHeight)return this.blockAt(e,i,n,s);if(t==be.ByPosNoHeight){let{from:d,to:p}=i.doc.lineAt(e);return new wt(d,p-d,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s),h=i.doc.lineAt(e),c=a+h.length*l,f=h.number-o,u=n+a*f+l*(h.from-s-f);return new wt(h.from,h.length,Math.max(n,Math.min(u,n+this.height-c)),c,0)}forEachLine(e,t,i,n,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:a,perLine:l,perChar:h}=this.heightMetrics(i,s);for(let c=e,f=n;c<=t;){let u=i.doc.lineAt(c);if(c==e){let p=u.number-a;f+=l*p+h*(e-s-p)}let d=l+h*u.length;o(new wt(u.from,u.length,f,d,0)),f+=d,c=u.to+1}}replace(e,t,i){let n=this.length-t;if(n>0){let s=i[i.length-1];s instanceof je?i[i.length-1]=new je(s.length+n):i.push(null,new je(n-1))}if(e>0){let s=i[0];s instanceof je?i[0]=new je(e+s.length):i.unshift(new je(e-1),null)}return tt.of(i)}decomposeLeft(e,t){t.push(new je(e-1),null)}decomposeRight(e,t){t.push(null,new je(this.length-e-1))}updateHeight(e,t=0,i=!1,n){let s=t+this.length;if(n&&n.from<=t+this.length&&n.more){let o=[],a=Math.max(t,n.from),l=-1;for(n.from>t&&o.push(new je(n.from-t-1).updateHeight(e,t));a<=s&&n.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let f=n.heights[n.index++],u=0;f<0&&(u=-f,f=n.heights[n.index++]),l==-1?l=f:Math.abs(f-l)>=Ur&&(l=-2);let d=new lt(c,f,u);d.outdated=!1,o.push(d),a+=c+1}a<=s&&o.push(null,new je(s-a).updateHeight(e,a));let h=tt.of(o);return(l<0||Math.abs(h.height-this.height)>=Ur||Math.abs(l-this.heightMetrics(e,t).perLine)>=Ur)&&(sn=!0),cs(this,h)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class F0 extends tt{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,n){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,n):this.right.blockAt(e,t,s,n+this.left.length+this.break)}lineAt(e,t,i,n,s){let o=n+this.left.height,a=s+this.left.length+this.break,l=t==be.ByHeight?e<o:e<a,h=l?this.left.lineAt(e,t,i,n,s):this.right.lineAt(e,t,i,o,a);if(this.break||(l?h.to<a:h.from>a))return h;let c=t==be.ByPosNoHeight?be.ByPosNoHeight:be.ByPos;return l?h.join(this.right.lineAt(a,c,i,o,a)):this.left.lineAt(a,c,i,n,s).join(h)}forEachLine(e,t,i,n,s,o){let a=n+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,n,s,o),t>=l&&this.right.forEachLine(e,t,i,a,l,o);else{let h=this.lineAt(l,be.ByPos,i,n,s);e<h.from&&this.left.forEachLine(e,h.from-1,i,n,s,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,i,a,l,o)}}replace(e,t,i){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of i)s.push(a);if(e>0&&Dh(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),Dh(s,a)}return tt.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,n=i+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?tt.of(this.break?[e,null,t]:[e,t]):(this.left=cs(this.left,e),this.right=cs(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,n){let{left:s,right:o}=this,a=t+s.length+this.break,l=null;return n&&n.from<=t+s.length&&n.more?l=s=s.updateHeight(e,t,i,n):s.updateHeight(e,t,i),n&&n.from<=a+o.length&&n.more?l=o=o.updateHeight(e,a,i,n):o.updateHeight(e,a,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Dh(r,e){let t,i;r[e]==null&&(t=r[e-1])instanceof je&&(i=r[e+1])instanceof je&&r.splice(e-1,3,new je(t.length+1+i.length))}const $0=5;class sl{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof lt?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new lt(i-this.pos,-1,0)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=t-e;i.block?this.addBlock(new Gu(o,n,i)):(o||s||n>=$0)&&this.addLineDeco(n,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new lt(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let i=new je(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof lt)return e;let t=new lt(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,e),n.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof lt)&&!this.isCovered?this.nodes.push(new lt(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let n of this.nodes)n instanceof lt&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(e,t,i,n){let s=new sl(i,e);return se.spans(t,i,n,s,0),s.finish(i)}}function z0(r,e,t){let i=new V0;return se.compare(r,e,t,i,0),i.changes}class V0{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,n){(e<t||i&&i.heightRelevant||n&&n.heightRelevant)&&Ui(e,t,this.changes,5)}}function W0(r,e){let t=r.getBoundingClientRect(),i=r.ownerDocument,n=i.defaultView||window,s=Math.max(0,t.left),o=Math.min(n.innerWidth,t.right),a=Math.max(0,t.top),l=Math.min(n.innerHeight,t.bottom);for(let h=r.parentNode;h&&h!=i.body;)if(h.nodeType==1){let c=h,f=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&f.overflow!="visible"){let u=c.getBoundingClientRect();s=Math.max(s,u.left),o=Math.min(o,u.right),a=Math.max(a,u.top),l=Math.min(h==r.parentNode?n.innerHeight:l,u.bottom)}h=f.position=="absolute"||f.position=="fixed"?c.offsetParent:c.parentNode}else if(h.nodeType==11)h=h.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,l)-(t.top+e)}}function H0(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function q0(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class oo{constructor(e,t,i,n){this.from=e,this.to=t,this.size=i,this.displaySize=n}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let n=e[i],s=t[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(e,t){return J.replace({widget:new G0(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class G0 extends Xt{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Ph{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Lh,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ve.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Ps).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new N0(t),this.stateDeco=e.facet(Un).filter(i=>typeof i!="function"),this.heightMap=tt.empty().applyChanges(this.stateDeco,fe.empty,this.heightOracle.setDoc(e.doc),[new gt(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=J.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let n=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>n>=s&&n<=o)){let{from:s,to:o}=this.lineBlockAt(n);e.push(new Er(s,o))}}return this.viewports=e.sort((i,n)=>i.from-n.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Lh:new ol(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(wn(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Un).filter(c=>typeof c!="function");let n=e.changedRanges,s=gt.extendWithRanges(n,z0(i,this.stateDeco,e?e.changes:Ie.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Rh(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||sn)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let h=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(h||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(wu)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?ve.RTL:ve.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let h=0,c=0;if(a.width&&a.height){let{scaleX:E,scaleY:A}=su(t,a);(E>.005&&Math.abs(this.scaleX-E)>.005||A>.005&&Math.abs(this.scaleY-A)>.005)&&(this.scaleX=E,this.scaleY=A,h|=16,o=l=!0)}let f=(parseInt(i.paddingTop)||0)*this.scaleY,u=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=u)&&(this.paddingTop=f,this.paddingBottom=u,h|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=au(e.scrollDOM);let p=(this.printing?q0:W0)(t,this.paddingTop),m=p.top-this.pixelViewport.top,g=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let b=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(b!=this.inView&&(this.inView=b,b&&(l=!0)),!this.inView&&!this.scrollTarget&&!H0(e.dom))return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,h|=16),l){let E=e.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(E)&&(o=!0),o||n.lineWrapping&&Math.abs(y-this.contentDOMWidth)>n.charWidth){let{lineHeight:A,charWidth:O,textHeight:R}=e.docView.measureTextSize();o=A>0&&n.refresh(s,A,O,R,Math.max(5,y/O),E),o&&(e.docView.minWidth=0,h|=16)}m>0&&g>0?c=Math.max(m,g):m<0&&g<0&&(c=Math.min(m,g)),Rh();for(let A of this.viewports){let O=A.from==this.viewport.from?E:e.docView.measureVisibleLineHeights(A);this.heightMap=(o?tt.empty().applyChanges(this.stateDeco,fe.empty,this.heightOracle,[new gt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new B0(A.from,O))}sn&&(h|=2)}let x=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return x&&(h&2&&(h|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),h|=this.updateForViewport()),(h&2||x)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new Er(n.lineAt(o-i*1e3,be.ByHeight,s,0,0).from,n.lineAt(a+(1-i)*1e3,be.ByHeight,s,0,0).to);if(t){let{head:h}=t.range;if(h<l.from||h>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=n.lineAt(h,be.ByPos,s,0,0),u;t.y=="center"?u=(f.top+f.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&h<l.from?u=f.top:u=f.bottom-c,l=new Er(n.lineAt(u-1e3/2,be.ByHeight,s,0,0).from,n.lineAt(u+c+1e3/2,be.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new Er(this.heightMap.lineAt(i,be.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,be.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,be.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,be.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||n<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(i,250)))&&n>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let n of e)t.touchesRange(n.from,n.to)||i.push(new oo(t.mapPos(n.from),t.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=ve.LTR&&!i)return[];let a=[],l=(c,f,u,d)=>{if(f-c<s)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let b of m)if(b>c&&b<f){l(c,b-10,u,d),l(b+10,f,u,d);return}let g=K0(e,b=>b.from>=u.from&&b.to<=u.to&&Math.abs(b.from-c)<s&&Math.abs(b.to-f)<s&&!m.some(y=>b.from<y&&b.to>y));if(!g){if(f<u.to&&t&&i&&t.visibleRanges.some(x=>x.from<=f&&x.to>=f)){let x=t.moveToLineBoundary(_.cursor(f),!1,!0).head;x>c&&(f=x)}let b=this.gapSize(u,c,f,d),y=i||b<2e6?b:2e6;g=new oo(c,f,b,y)}a.push(g)},h=c=>{if(c.length<o||c.type!=We.Text)return;let f=U0(c.from,c.to,this.stateDeco);if(f.total<o)return;let u=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(i){let m=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,b;if(u!=null){let y=Mr(f,u),x=((this.visibleBottom-this.visibleTop)/2+m)/c.height;g=y-x,b=y+x}else g=(this.visibleTop-c.top-m)/c.height,b=(this.visibleBottom-c.top+m)/c.height;d=Or(f,g),p=Or(f,b)}else{let m=f.total*this.heightOracle.charWidth,g=n*this.heightOracle.charWidth,b=0;if(m>2e6)for(let O of e)O.from>=c.from&&O.from<c.to&&O.size!=O.displaySize&&O.from*this.heightOracle.charWidth+b<this.pixelViewport.left&&(b=O.size-O.displaySize);let y=this.pixelViewport.left+b,x=this.pixelViewport.right+b,E,A;if(u!=null){let O=Mr(f,u),R=((x-y)/2+g)/m;E=O-R,A=O+R}else E=(y-g)/m,A=(x+g)/m;d=Or(f,E),p=Or(f,A)}d>c.from&&l(c.from,d,c,f),p<c.to&&l(p,c.to,c,f)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(h):h(c);return a}gapSize(e,t,i,n){let s=Mr(n,i)-Mr(n,t);return this.heightOracle.lineWrapping?e.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(e){oo.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=J.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];se.spans(t,this.viewport.from,this.viewport.to,{span(s,o){i.push({from:s,to:o})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let s=0;s<i.length&&!(n&8);s++){let o=this.visibleRanges[s],a=i[s];(o.from!=a.from||o.to!=a.to)&&(n|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||wn(this.heightMap.lineAt(e,be.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||wn(this.heightMap.lineAt(this.scaler.fromDOM(e),be.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return wn(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Er{constructor(e,t){this.from=e,this.to=t}}function U0(r,e,t){let i=[],n=r,s=0;return se.spans(t,r,e,{span(){},point(o,a){o>n&&(i.push({from:n,to:o}),s+=o-n),n=a}},20),n<e&&(i.push({from:n,to:e}),s+=e-n),{total:s,ranges:i}}function Or({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(r*t);for(let n=0;;n++){let{from:s,to:o}=e[n],a=o-s;if(i<=a)return s+i;i-=a}}function Mr(r,e){let t=0;for(let{from:i,to:n}of r.ranges){if(e<=n){t+=e-i;break}t+=n-i}return t/r.total}function K0(r,e){for(let t of r)if(e(t))return t}const Lh={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class ol{constructor(e,t,i){let n=0,s=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let h=t.lineAt(a,be.ByPos,e,0,0).top,c=t.lineAt(l,be.ByPos,e,0,0).bottom;return n+=c-h,{from:a,to:l,top:h,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(t.height-n);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return n+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,n=s.domBottom}}fromDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-n)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,n=s.domBottom}}eq(e){return e instanceof ol?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function wn(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),i=e.toDOM(r.bottom);return new wt(r.from,r.length,t,i-t,Array.isArray(r._content)?r._content.map(n=>wn(n,e)):r._content)}const Rr=I.define({combine:r=>r.join(" ")}),va=I.define({combine:r=>r.indexOf(!0)>-1}),xa=Jt.newName(),Uu=Jt.newName(),Ku=Jt.newName(),Ju={"&light":"."+Uu,"&dark":"."+Ku};function ka(r,e,t){return new Jt(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return r;if(!t||!t[n])throw new RangeError(`Unsupported selector: ${n}`);return t[n]}):r+" "+i}})}const J0=ka("."+xa,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ju),Y0={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ao=L.ie&&L.ie_version<=11;class X0{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Eg,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(L.ie&&L.ie_version<=11||L.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&L.android&&e.constructor.EDIT_CONTEXT!==!1&&!(L.chrome&&L.chrome_version<126)&&(this.editContext=new Z0(e),e.state.facet(Wt)&&(e.contentDOM.editContext=this.editContext.editContext)),ao&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Wt)?i.root.activeElement!=this.dom:!qr(this.dom,n))return;let s=n.anchorNode&&i.docView.tile.nearest(n.anchorNode);if(s&&s.isWidget()&&s.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(L.ie&&L.ie_version<=11||L.android&&L.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Dn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=qn(e.root);if(!t)return!1;let i=L.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Q0(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let n=qr(this.dom,i);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Mg(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Y0),ao&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ao&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let n=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Ki(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,n=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(n=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:n}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),n=this.selectionChanged&&qr(this.dom,this.selectionRange);if(e<0&&!n)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new g0(this.view,e,t,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,n=Nu(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let i=Ih(t,e.previousSibling||e.target.previousSibling,-1),n=Ih(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Wt)!=e.state.facet(Wt)&&(e.view.contentDOM.editContext=e.state.facet(Wt)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Ih(r,e,t){for(;e;){let i=Re.get(e);if(i&&i.parent==r)return i;let n=e.parentNode;e=n!=r.dom?n:t>0?e.nextSibling:e.previousSibling}return null}function Nh(r,e){let t=e.startContainer,i=e.startOffset,n=e.endContainer,s=e.endOffset,o=r.docView.domAtPos(r.state.selection.main.anchor,1);return Dn(o.node,o.offset,n,s)&&([t,i,n,s]=[n,s,t,i]),{anchorNode:t,anchorOffset:i,focusNode:n,focusOffset:s}}function Q0(r,e){if(e.getComposedRanges){let n=e.getComposedRanges(r.root)[0];if(n)return Nh(r,n)}let t=null;function i(n){n.preventDefault(),n.stopImmediatePropagation(),t=n.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),t?Nh(r,t):null}class Z0{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let n=e.state.selection.main,{anchor:s,head:o}=n,a=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:a,drifted:!1});let h=l-a>i.text.length;a==this.from&&s<this.from?a=s:l==this.to&&s>this.to&&(l=s);let c=Bu(e.state.sliceDoc(a,l),i.text,(h?n.from:n.to)-a,h?"end":null);if(!c){let u=_.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));u.main.eq(n)||e.dispatch({selection:u,userEvent:"select"});return}let f={from:c.from+a,to:c.toA+a,insert:fe.of(i.text.slice(c.from,c.toB).split(`
`))};if((L.mac||L.android)&&f.from==o-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(f={from:a,to:l,insert:fe.of([i.text.replace("."," ")])}),this.pendingContextChange=f,!e.state.readOnly){let u=this.to-this.from+(f.to-f.from+f.insert.length);rl(e,f,_.single(this.toEditorPos(i.selectionStart,u),this.toEditorPos(i.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),f.from<f.to&&!f.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);s=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||s||new DOMRect,n.push(s)}t.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=i=>{let n=[];for(let s of i.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(a)){let l=this.toEditorPos(s.rangeStart),h=this.toEditorPos(s.rangeEnd);if(l<h){let c=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(a)?1:2}px`;n.push(J.mark({attributes:{style:c}}).range(l,h))}}}e.dispatch({effects:Cu.of(J.set(n))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let n=qn(i.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,n=this.pendingContextChange;return e.changes.iterChanges((s,o,a,l,h)=>{if(i)return;let c=h.length-(o-s);if(n&&o>=n.to)if(n.from==s&&n.to==o&&n.insert.eq(h)){n=this.pendingContextChange=null,t+=c,this.to+=c;return}else n=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+h.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),h.toString()),this.to+=c}t+=c}),n&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),n=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(i,n)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class N{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(n=>n.forEach(s=>i(s,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Og(e.parent)||document,this.viewState=new Ph(e.state||ie.create(e)),e.scrollTo&&e.scrollTo.is(_r)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Wi).map(n=>new to(n));for(let n of this.plugins)n.update(this);this.observer=new X0(this),this.inputState=new x0(this),this.inputState.ensureHandlers(this.plugins),this.docView=new vh(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof ze?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,n,s=this.state;for(let u of e){if(u.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=u.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(u=>u.annotation(Wu))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=Hu(s,o),l||(a=1));let h=this.observer.delayedAndroidKey,c=null;if(h?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(ie.phrases)!=this.state.facet(ie.phrases))return this.setState(s);n=as.create(this,s,e),n.flags|=a;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(f&&(f=f.map(u.changes)),u.scrollIntoView){let{main:d}=u.state.selection;f=new Ji(d.empty?d:_.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of u.effects)d.is(_r)&&(f=d.value.clip(this.state))}this.viewState.update(n,f),this.bidiCache=fs.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),t=this.docView.update(n),this.state.facet(xn)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(Rr)!=n.state.facet(Rr)&&(this.viewState.mustMeasureContent=!0),(t||i||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!n.empty)for(let u of this.state.facet(pa))try{u(n)}catch(d){Bt(this.state,d,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!Nu(this,c)&&h.force&&Ki(this.contentDOM,h.key,h.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Ph(e),this.plugins=e.facet(Wi).map(i=>new to(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new vh(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Wi),i=e.state.facet(Wi);if(t!=i){let n=[];for(let s of i){let o=t.indexOf(s);if(o<0)n.push(new to(s));else{let a=this.plugins[o];a.mustUpdate=e,n.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=e;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){Bt(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(au(i))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(n);s=d.from,o=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let h=[];l&4||([this.measureRequests,h]=[h,this.measureRequests]);let c=h.map(d=>{try{return d.read(this)}catch(p){return Bt(this.state,p),Bh}}),f=as.create(this,this.state,[]),u=!1;f.flags|=l,t?t.flags|=l:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),u=this.docView.update(f),u&&this.docViewUpdate());for(let d=0;d<h.length;d++)if(c[d]!=Bh)try{let p=h[d];p.write&&p.write(c[d],this)}catch(p){Bt(this.state,p)}if(u&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){n=n+p,i.scrollTop=n/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(pa))a(t)}get themeClasses(){return xa+" "+(this.state.facet(va)?Ku:Uu)+" "+this.state.facet(Rr)}updateAttrs(){let e=jh(this,_u,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Wt)?"true":"false",class:"cm-content",style:`${L.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),jh(this,Ps,t);let i=this.observer.ignore(()=>{let n=dh(this.contentDOM,this.contentAttrs,t),s=dh(this.dom,this.editorAttrs,e);return n||s});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let n of i.effects)if(n.is(N.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(xn);let e=this.state.facet(N.cspNonce);Jt.mount(this.root,this.styleModules.concat(J0).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return so(this,e,xh(this,e,t,i))}moveByGroup(e,t){return so(this,e,xh(this,e,t,i=>f0(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),n=this.textDirectionAt(e.from),s=i[t?i.length-1:0];return _.cursor(s.side(t,n)+e.from,s.forward(!t,n)?1:-1)}moveToLineBoundary(e,t,i=!0){return c0(this,e,t,i)}moveVertically(e,t,i){return so(this,e,u0(this,e,t,i))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let i=ba(this,e,t);return i&&i.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),ba(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(e),s=this.bidiSpans(n),o=s[Ht.find(s,e-n.from,-1,t)];return os(i,o.dir==ve.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ku)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>eb)return du(e.length);let t=this.textDirectionAt(e.from),i;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||uu(s.isolates,i=gh(this,e))))return s.order;i||(i=gh(this,e));let n=Bg(e.text,t,i);return this.bidiCache.push(new fs(e.from,e.to,t,i,!0,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||L.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{ou(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return _r.of(new Ji(typeof e=="number"?_.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return _r.of(new Ji(_.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Ce.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ce.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=Jt.newName(),n=[Rr.of(i),xn.of(ka(`.${i}`,e))];return t&&t.dark&&n.push(va.of(!0)),n}static baseTheme(e){return Bi.lowest(xn.of(ka("."+xa,e,Ju)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),n=i&&Re.get(i)||Re.get(e);return((t=n?.root)===null||t===void 0?void 0:t.view)||null}}N.styleModule=xn;N.inputHandler=vu;N.clipboardInputFilter=il;N.clipboardOutputFilter=nl;N.scrollHandler=Su;N.focusChangeEffect=xu;N.perLineTextDirection=ku;N.exceptionSink=yu;N.updateListener=pa;N.editable=Wt;N.mouseSelectionStyle=bu;N.dragMovesSelection=gu;N.clickAddsSelectionRange=mu;N.decorations=Un;N.blockWrappers=Au;N.outerDecorations=Tu;N.atomicRanges=lr;N.bidiIsolatedRanges=Eu;N.scrollMargins=Ou;N.darkTheme=va;N.cspNonce=I.define({combine:r=>r.length?r[0]:""});N.contentAttributes=Ps;N.editorAttributes=_u;N.lineWrapping=N.contentAttributes.of({class:"cm-lineWrapping"});N.announce=de.define();const eb=4096,Bh={};class fs{constructor(e,t,i,n,s,o){this.from=e,this.to=t,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let i=[],n=e.length?e[e.length-1].dir:ve.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==n&&!t.touchesRange(o.from,o.to)&&i.push(new fs(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function jh(r,e,t){for(let i=r.state.facet(e),n=i.length-1;n>=0;n--){let s=i[n],o=typeof s=="function"?s(r):s;o&&Za(o,t)}return t}const tb=L.mac?"mac":L.windows?"win":L.linux?"linux":"key";function ib(r,e){const t=r.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let n,s,o,a;for(let l=0;l<t.length-1;++l){const h=t[l];if(/^(cmd|meta|m)$/i.test(h))a=!0;else if(/^a(lt)?$/i.test(h))n=!0;else if(/^(c|ctrl|control)$/i.test(h))s=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+h)}return n&&(i="Alt-"+i),s&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Dr(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const nb=Bi.default(N.domEventHandlers({keydown(r,e){return Xu(Yu(e.state),r,e,"editor")}})),Hi=I.define({enables:nb}),Fh=new WeakMap;function Yu(r){let e=r.facet(Hi),t=Fh.get(e);return t||Fh.set(e,t=ob(e.reduce((i,n)=>i.concat(n),[]))),t}function rb(r,e,t){return Xu(Yu(r.state),e,r,t)}let ti=null;const sb=4e3;function ob(r,e=tb){let t=Object.create(null),i=Object.create(null),n=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,h,c)=>{var f,u;let d=t[o]||(t[o]=Object.create(null)),p=a.split(/ (?!$)/).map(b=>ib(b,e));for(let b=1;b<p.length;b++){let y=p.slice(0,b).join(" ");n(y,!0),d[y]||(d[y]={preventDefault:!0,stopPropagation:!1,run:[x=>{let E=ti={view:x,prefix:y,scope:o};return setTimeout(()=>{ti==E&&(ti=null)},sb),!0}]})}let m=p.join(" ");n(m,!1);let g=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((u=(f=d._any)===null||f===void 0?void 0:f.run)===null||u===void 0?void 0:u.slice())||[]});l&&g.run.push(l),h&&(g.preventDefault=!0),c&&(g.stopPropagation=!0)};for(let o of r){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let h of a){let c=t[h]||(t[h]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:f}=o;for(let u in c)c[u].run.push(d=>f(d,wa))}let l=o[e]||o.key;if(l)for(let h of a)s(h,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(h,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}let wa=null;function Xu(r,e,t,i){wa=e;let n=xg(e),s=gi(n,0),o=rr(s)==n.length&&n!=" ",a="",l=!1,h=!1,c=!1;ti&&ti.view==t&&ti.scope==i&&(a=ti.prefix+" ",Fu.indexOf(e.keyCode)<0&&(h=!0,ti=null));let f=new Set,u=g=>{if(g){for(let b of g.run)if(!f.has(b)&&(f.add(b),b(t)))return g.stopPropagation&&(c=!0),!0;g.preventDefault&&(g.stopPropagation&&(c=!0),h=!0)}return!1},d=r[i],p,m;return d&&(u(d[a+Dr(n,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(L.windows&&e.ctrlKey&&e.altKey)&&!(L.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(p=li[e.keyCode])&&p!=n?(u(d[a+Dr(p,e,!0)])||e.shiftKey&&(m=Wn[e.keyCode])!=n&&m!=p&&u(d[a+Dr(m,e,!1)]))&&(l=!0):o&&e.shiftKey&&u(d[a+Dr(n,e,!0)])&&(l=!0),!l&&u(d._any)&&(l=!0)),h&&(l=!0),l&&c&&e.stopPropagation(),wa=null,l}class hr{constructor(e,t,i,n,s){this.className=e,this.left=t,this.top=i,this.width=n,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let n=e.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let s=Qu(e);return[new hr(t,n.left-s.left,n.top-s.top,null,n.bottom-n.top)]}else return ab(e,t,i)}}function Qu(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==ve.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function $h(r,e,t,i){let n=r.coordsAtPos(e,t*2);if(!n)return i;let s=r.dom.getBoundingClientRect(),o=(n.top+n.bottom)/2,a=r.posAtCoords({x:s.left+1,y:o}),l=r.posAtCoords({x:s.right-1,y:o});return a==null||l==null?i:{from:Math.max(i.from,Math.min(a,l)),to:Math.min(i.to,Math.max(a,l))}}function ab(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let i=Math.max(t.from,r.viewport.from),n=Math.min(t.to,r.viewport.to),s=r.textDirection==ve.LTR,o=r.contentDOM,a=o.getBoundingClientRect(),l=Qu(r),h=o.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),f=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=a.right-(c?parseInt(c.paddingRight):0),d=ga(r,i,1),p=ga(r,n,-1),m=d.type==We.Text?d:null,g=p.type==We.Text?p:null;if(m&&(r.lineWrapping||d.widgetLineBreaks)&&(m=$h(r,i,1,m)),g&&(r.lineWrapping||p.widgetLineBreaks)&&(g=$h(r,n,-1,g)),m&&g&&m.from==g.from&&m.to==g.to)return y(x(t.from,t.to,m));{let A=m?x(t.from,null,m):E(d,!1),O=g?x(null,t.to,g):E(p,!0),R=[];return(m||d).to<(g||p).from-(m&&g?1:0)||d.widgetLineBreaks>1&&A.bottom+r.defaultLineHeight/2<O.top?R.push(b(f,A.bottom,u,O.top)):A.bottom<O.top&&r.elementAtHeight((A.bottom+O.top)/2).type==We.Text&&(A.bottom=O.top=(A.bottom+O.top)/2),y(A).concat(R).concat(y(O))}function b(A,O,R,K){return new hr(e,A-l.left,O-l.top,R-A,K-O)}function y({top:A,bottom:O,horizontal:R}){let K=[];for(let z=0;z<R.length;z+=2)K.push(b(R[z],A,R[z+1],O));return K}function x(A,O,R){let K=1e9,z=-1e9,Y=[];function W(V,H,ae,le,he){let oe=r.coordsAtPos(V,V==R.to?-2:2),ke=r.coordsAtPos(ae,ae==R.from?2:-2);!oe||!ke||(K=Math.min(oe.top,ke.top,K),z=Math.max(oe.bottom,ke.bottom,z),he==ve.LTR?Y.push(s&&H?f:oe.left,s&&le?u:ke.right):Y.push(!s&&le?f:ke.left,!s&&H?u:oe.right))}let T=A??R.from,F=O??R.to;for(let V of r.visibleRanges)if(V.to>T&&V.from<F)for(let H=Math.max(V.from,T),ae=Math.min(V.to,F);;){let le=r.state.doc.lineAt(H);for(let he of r.bidiSpans(le)){let oe=he.from+le.from,ke=he.to+le.from;if(oe>=ae)break;ke>H&&W(Math.max(oe,H),A==null&&oe<=T,Math.min(ke,ae),O==null&&ke>=F,he.dir)}if(H=le.to+1,H>=ae)break}return Y.length==0&&W(T,A==null,F,O==null,r.textDirection),{top:K,bottom:z,horizontal:Y}}function E(A,O){let R=a.top+(O?A.top:A.bottom);return{top:R,bottom:R,horizontal:[]}}}function lb(r,e){return r.constructor==e.constructor&&r.eq(e)}class hb{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Kr)!=e.state.facet(Kr)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(Kr);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!lb(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let n of e)n.update&&t&&n.constructor&&this.drawn[i].constructor&&n.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(n.draw(),t);for(;t;){let n=t.nextSibling;t.remove(),t=n}this.drawn=e,L.safari&&L.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Kr=I.define();function Zu(r){return[Ce.define(e=>new hb(e,r)),Kr.of(r)]}const Kn=I.define({combine(r){return ji(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function cb(r={}){return[Kn.of(r),fb,ub,db,wu.of(!0)]}function ed(r){return r.startState.facet(Kn)!=r.state.facet(Kn)}const fb=Zu({above:!0,markers(r){let{state:e}=r,t=e.facet(Kn),i=[];for(let n of e.selection.ranges){let s=n==e.selection.main;if(n.empty||t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=n.empty?n:_.cursor(n.head,n.head>n.anchor?-1:1);for(let l of hr.forRange(r,o,a))i.push(l)}}return i},update(r,e){r.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=ed(r);return t&&zh(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){zh(e.state,r)},class:"cm-cursorLayer"});function zh(r,e){e.style.animationDuration=r.facet(Kn).cursorBlinkRate+"ms"}const ub=Zu({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:hr.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||ed(r)},class:"cm-selectionLayer"}),db=Bi.highest(N.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),td=de.define({map(r,e){return r==null?null:e.mapPos(r)}}),Sn=ft.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,i)=>i.is(td)?i.value:t,r)}}),pb=Ce.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Sn);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Sn)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Sn),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let i=r.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-i.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Sn)!=r&&this.view.dispatch({effects:td.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function mb(){return[Sn,pb]}function Vh(r,e,t,i,n){e.lastIndex=0;for(let s=r.iterRange(t,i),o=t,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)n(o+a.index,a)}function gb(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let i=[];for(let{from:n,to:s}of t)n=Math.max(r.state.doc.lineAt(n).from,n-e),s=Math.min(r.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=n?i[i.length-1].to=s:i.push({from:n,to:s});return i}class al{constructor(e){const{regexp:t,decoration:i,decorate:n,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,n)this.addMatch=(a,l,h,c)=>n(c,h,h+a[0].length,a,l);else if(typeof i=="function")this.addMatch=(a,l,h,c)=>{let f=i(a,l,h);f&&c(h,h+a[0].length,f)};else if(i)this.addMatch=(a,l,h,c)=>c(h,h+a[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new Kt,i=t.add.bind(t);for(let{from:n,to:s}of gb(e,this.maxLength))Vh(e.state.doc,this.regexp,n,s,(o,a)=>this.addMatch(a,e,o,i));return t.finish()}updateDeco(e,t){let i=1e9,n=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>=e.view.viewport.from&&a<=e.view.viewport.to&&(i=Math.min(a,i),n=Math.max(l,n))}),e.viewportMoved||n-i>1e3?this.createDeco(e.view):n>-1?this.updateRange(e.view,t.map(e.changes),i,n):t}updateRange(e,t,i,n){for(let s of e.visibleRanges){let o=Math.max(s.from,i),a=Math.min(s.to,n);if(a>=o){let l=e.state.doc.lineAt(o),h=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),f=Math.min(s.to,h.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<h.to;a++)if(this.boundary.test(h.text[a-h.from])){f=a;break}}let u=[],d,p=(m,g,b)=>u.push(b.range(m,g));if(l==h)for(this.regexp.lastIndex=c-l.from;(d=this.regexp.exec(l.text))&&d.index<f-l.from;)this.addMatch(d,e,d.index+l.from,p);else Vh(e.state.doc,this.regexp,c,f,(m,g)=>this.addMatch(g,e,m,p));t=t.update({filterFrom:c,filterTo:f,filter:(m,g)=>m<c||g>f,add:u})}}return t}}const Sa=/x/.unicode!=null?"gu":"g",bb=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Sa),yb={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let lo=null;function vb(){var r;if(lo==null&&typeof document<"u"&&document.body){let e=document.body.style;lo=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return lo||!1}const Jr=I.define({combine(r){let e=ji(r,{render:null,specialChars:bb,addSpecialChars:null});return(e.replaceTabs=!vb())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Sa)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Sa)),e}});function xb(r={}){return[Jr.of(r),kb()]}let Wh=null;function kb(){return Wh||(Wh=Ce.fromClass(class{constructor(r){this.view=r,this.decorations=J.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(Jr)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new al({regexp:r.specialChars,decoration:(e,t,i)=>{let{doc:n}=t.state,s=gi(e[0],0);if(s==9){let o=n.lineAt(i),a=t.state.tabSize,l=hn(o.text,a,i-o.from);return J.replace({widget:new _b((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=J.replace({widget:new Cb(r,s)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(Jr);r.startState.facet(Jr)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const wb="";function Sb(r){return r>=32?wb:r==10?"":String.fromCharCode(9216+r)}class Cb extends Xt{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Sb(this.code),i=e.state.phrase("Control character")+" "+(yb[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,t);if(n)return n;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class _b extends Xt{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const Hh=Ce.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(r){let{view:e}=r,t=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;t>=0&&t!=this.height&&(this.height=t,this.attrs={style:`padding-bottom: ${t}px`})}});function Ab(){return[Hh,Ps.of(r=>{var e;return((e=r.plugin(Hh))===null||e===void 0?void 0:e.attrs)||null})]}function Tb(){return Ob}const Eb=J.line({class:"cm-activeLine"}),Ob=Ce.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let i of r.state.selection.ranges){let n=r.lineBlockAt(i.head);n.from>e&&(t.push(Eb.range(n.from)),e=n.from)}return J.set(t)}},{decorations:r=>r.decorations}),Ca=2e3;function Mb(r,e,t){let i=Math.min(e.line,t.line),n=Math.max(e.line,t.line),s=[];if(e.off>Ca||t.off>Ca||e.col<0||t.col<0){let o=Math.min(e.off,t.off),a=Math.max(e.off,t.off);for(let l=i;l<=n;l++){let h=r.doc.line(l);h.length<=a&&s.push(_.range(h.from+o,h.to+a))}}else{let o=Math.min(e.col,t.col),a=Math.max(e.col,t.col);for(let l=i;l<=n;l++){let h=r.doc.line(l),c=na(h.text,o,r.tabSize,!0);if(c<0)s.push(_.cursor(h.to));else{let f=na(h.text,a,r.tabSize);s.push(_.range(h.from+c,h.from+f))}}}return s}function Rb(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function qh(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),i=r.state.doc.lineAt(t),n=t-i.from,s=n>Ca?-1:n==i.length?Rb(r,e.clientX):hn(i.text,r.state.tabSize,t-i.from);return{line:i.number,col:s,off:n}}function Db(r,e){let t=qh(r,e),i=r.state.selection;return t?{update(n){if(n.docChanged){let s=n.changes.mapPos(n.startState.doc.line(t.line).from),o=n.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(n.changes)}},get(n,s,o){let a=qh(r,n);if(!a)return i;let l=Mb(r.state,t,a);return l.length?o?_.create(l.concat(i.ranges)):_.create(l):i}}:null}function Pb(r){let e=(t=>t.altKey&&t.button==0);return N.mouseSelectionStyle.of((t,i)=>e(i)?Db(t,i):null)}const Lb={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},Ib={style:"cursor: crosshair"};function Nb(r={}){let[e,t]=Lb[r.key||"Alt"],i=Ce.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventObservers:{keydown(n){this.set(n.keyCode==e||t(n))},keyup(n){(n.keyCode==e||!t(n))&&this.set(!1)},mousemove(n){this.set(t(n))}}});return[i,N.contentAttributes.of(n=>{var s;return!((s=n.plugin(i))===null||s===void 0)&&s.isDown?Ib:null})]}function Bb(r={}){return Fb.of(r)}function jb(r){let e=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Fb=I.define({combine:r=>{var e,t,i;return{position:L.ios?"absolute":((e=r.find(n=>n.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(n=>n.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=r.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||jb}}}),Gh=I.define({combine(r){let e,t;for(let i of r)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function id(r,e){let t=r.plugin(nd),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const nd=Ce.fromClass(class{constructor(r){this.input=r.state.facet(_a),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(Gh);this.top=new Pr(r,!0,e.topContainer),this.bottom=new Pr(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(Gh);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Pr(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Pr(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(_a);if(t!=this.input){let i=t.filter(l=>l),n=[],s=[],o=[],a=[];for(let l of i){let h=this.specs.indexOf(l),c;h<0?(c=l(r.view),a.push(c)):(c=this.panels[h],c.update&&c.update(r)),n.push(c),(c.top?s:o).push(c)}this.specs=i,this.panels=n,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>N.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Pr{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Uh(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Uh(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Uh(r){let e=r.nextSibling;return r.remove(),e}const _a=I.define({enables:nd});class ci extends ai{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ci.prototype.elementClass="";ci.prototype.toDOM=void 0;ci.prototype.mapMode=Je.TrackBefore;ci.prototype.startSide=ci.prototype.endSide=-1;ci.prototype.point=!0;const ho=I.define(),$b=I.define(),zb={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>se.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Ln=I.define();function Vb(r){return[rd(),Ln.of({...zb,...r})]}const Kh=I.define({combine:r=>r.some(e=>e)});function rd(r){return[Wb]}const Wb=Ce.fromClass(class{constructor(r){this.view=r,this.domAfter=null,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(Ln).map(e=>new Yh(r,e)),this.fixed=!r.state.facet(Kh);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}if(r.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Kh)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=se.iter(this.view.state.facet(ho),this.view.viewport.from),i=[],n=this.gutters.map(s=>new Hb(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==We.Text&&o){Aa(t,i,a.from);for(let l of n)l.line(this.view,a,i);o=!1}else if(a.widget)for(let l of n)l.widget(this.view,a)}else if(s.type==We.Text){Aa(t,i,s.from);for(let o of n)o.line(this.view,s,i)}else if(s.widget)for(let o of n)o.widget(this.view,s);for(let s of n)s.finish();r&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(r){let e=r.startState.facet(Ln),t=r.state.facet(Ln),i=r.docChanged||r.heightChanged||r.viewportChanged||!se.eq(r.startState.facet(ho),r.state.facet(ho),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let n of this.gutters)n.update(r)&&(i=!0);else{i=!0;let n=[];for(let s of t){let o=e.indexOf(s);o<0?n.push(new Yh(this.view,s)):(this.gutters[o].update(r),n.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),n.indexOf(s)<0&&s.destroy();for(let s of n)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=n}return i}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:r=>N.scrollMargins.of(e=>{let t=e.plugin(r);if(!t||t.gutters.length==0||!t.fixed)return null;let i=t.dom.offsetWidth*e.scaleX,n=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==ve.LTR?{left:i,right:n}:{right:i,left:n}})});function Jh(r){return Array.isArray(r)?r:[r]}function Aa(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class Hb{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=se.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:n}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==n.elements.length){let a=new sd(e,o,s,i);n.elements.push(a),n.dom.appendChild(a.dom)}else n.elements[this.i].update(e,o,s,i);this.height=t.bottom,this.i++}line(e,t,i){let n=[];Aa(this.cursor,n,t.from),i.length&&(n=n.concat(i));let s=this.gutter.config.lineMarker(e,t,n);s&&n.unshift(s);let o=this.gutter;n.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,n)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),n=i?[i]:null;for(let s of e.state.facet($b)){let o=s(e,t.widget,t);o&&(n||(n=[])).push(o)}n&&this.addElement(e,t,n)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Yh{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,n=>{let s=n.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=n.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[i](e,a,n)&&n.preventDefault()});this.markers=Jh(t.markers(e)),t.initialSpacer&&(this.spacer=new sd(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Jh(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}let i=e.view.viewport;return!se.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class sd{constructor(e,t,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,n)}update(e,t,i,n){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),qb(this.markers,n)||this.setMarkers(e,n)}setMarkers(e,t){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<t.length?t[s++]:null,h=!1;if(l){let c=l.elementClass;c&&(i+=" "+c);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(l)){a=f,h=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(n);let f=n.nextSibling;n.remove(),n=f}}if(!l)break;l.toDOM&&(h?n=n.nextSibling:this.dom.insertBefore(l.toDOM(e),n)),h&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function qb(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const Gb=I.define(),Ub=I.define(),qi=I.define({combine(r){return ji(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let n in t){let s=i[n],o=t[n];i[n]=s?(a,l,h)=>s(a,l,h)||o(a,l,h):o}return i}})}});class co extends ci{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function fo(r,e){return r.state.facet(qi).formatNumber(e,r.state)}const Kb=Ln.compute([qi],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Gb)},lineMarker(e,t,i){return i.some(n=>n.toDOM)?null:new co(fo(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let n of e.state.facet(Ub)){let s=n(e,t,i);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(qi)!=e.state.facet(qi),initialSpacer(e){return new co(fo(e,Xh(e.state.doc.lines)))},updateSpacer(e,t){let i=fo(t.view,Xh(t.view.state.doc.lines));return i==e.number?e:new co(i)},domEventHandlers:r.facet(qi).domEventHandlers,side:"before"}));function Jb(r={}){return[qi.of(r),rd(),Kb]}function Xh(r){let e=9;for(;e<r;)e=e*10+9;return e}function od(r){return Ce.define(e=>({decorations:r.createDeco(e),update(t){this.decorations=r.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const Yb=J.mark({class:"cm-highlightTab"}),Xb=J.mark({class:"cm-highlightSpace"}),Qb=od(new al({regexp:/\t| /g,decoration:r=>r[0]=="	"?Yb:Xb,boundary:/\S/}));function Zb(){return Qb}const e1=od(new al({regexp:/\s+$/g,decoration:J.mark({class:"cm-trailingSpace"})}));function t1(){return e1}const ad=1024;let i1=0;class bt{constructor(e,t){this.from=e,this.to=t}}class U{constructor(e={}){this.id=i1++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Xe.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}U.closedBy=new U({deserialize:r=>r.split(" ")});U.openedBy=new U({deserialize:r=>r.split(" ")});U.group=new U({deserialize:r=>r.split(" ")});U.isolate=new U({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});U.contextHash=new U({perNode:!0});U.lookAhead=new U({perNode:!0});U.mounted=new U({perNode:!0});class Jn{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[U.mounted.id]}}const n1=Object.create(null);class Xe{constructor(e,t,i,n=0){this.name=e,this.props=t,this.id=i,this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):n1,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),n=new Xe(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(n)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(U.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let n of i.split(" "))t[n]=e[i];return i=>{for(let n=i.prop(U.group),s=-1;s<(n?n.length:0);s++){let o=t[s<0?i.name:n[s]];if(o)return o}}}}Xe.none=new Xe("",Object.create(null),0,8);class Bs{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let n=null;for(let s of e){let o=s(i);if(o){n||(n=Object.assign({},i.props));let a=o[1],l=o[0];l.combine&&l.id in n&&(a=l.combine(n[l.id],a)),n[l.id]=a}}t.push(n?new Xe(i.name,n,i.id,i.flags):i)}return new Bs(t)}}const Lr=new WeakMap,Qh=new WeakMap;var ye;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(ye||(ye={}));class pe{constructor(e,t,i,n,s){if(this.type=e,this.children=t,this.positions=i,this.length=n,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Jn.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let n=i.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new us(this.topNode,e)}cursorAt(e,t=0,i=0){let n=Lr.get(this)||this.topNode,s=new us(n);return s.moveTo(e,t),Lr.set(this,s._tree),s}get topNode(){return new Ye(this,0,0,null)}resolve(e,t=0){let i=Yn(Lr.get(this)||this.topNode,e,t,!1);return Lr.set(this,i),i}resolveInner(e,t=0){let i=Yn(Qh.get(this)||this.topNode,e,t,!0);return Qh.set(this,i),i}resolveStack(e,t=0){return o1(this,e,t)}iterate(e){let{enter:t,leave:i,from:n=0,to:s=this.length}=e,o=e.mode||0,a=(o&ye.IncludeAnonymous)>0;for(let l=this.cursor(o|ye.IncludeAnonymous);;){let h=!1;if(l.from<=s&&l.to>=n&&(!a&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;h=!0}for(;h&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;h=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:cl(Xe.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,n)=>new pe(this.type,t,i,n,this.propValues),e.makeTree||((t,i,n)=>new pe(Xe.none,t,i,n)))}static build(e){return a1(e)}}pe.empty=new pe(Xe.none,[],[],0);class ll{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ll(this.buffer,this.index)}}class fi{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Xe.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],n=this.set.types[t],s=n.name;if(/\W/.test(s)&&!n.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,n,s){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(ld(s,n,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,t,i){let n=this.buffer,s=new Uint16Array(t-e),o=0;for(let a=e,l=0;a<t;){s[l++]=n[a++],s[l++]=n[a++]-i;let h=s[l++]=n[a++]-i;s[l++]=n[a++]-e,o=Math.max(o,h)}return new fi(s,o,this.set)}}function ld(r,e,t,i){switch(r){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function Yn(r,e,t,i){for(var n;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let o=!i&&r instanceof Ye&&r.index<0?null:r.parent;if(!o)return r;r=o}let s=i?0:ye.IgnoreOverlays;if(i)for(let o=r,a=o.parent;a;o=a,a=o.parent)o instanceof Ye&&o.index<0&&((n=a.enter(e,t,s))===null||n===void 0?void 0:n.from)!=o.from&&(r=a);for(;;){let o=r.enter(e,t,s);if(!o)return r;r=o}}class hd{cursor(e=0){return new us(this,e)}getChild(e,t=null,i=null){let n=Zh(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return Zh(this,e,t,i)}resolve(e,t=0){return Yn(this,e,t,!1)}resolveInner(e,t=0){return Yn(this,e,t,!0)}matchContext(e){return Ta(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let n=t.lastChild;if(!n||n.to!=t.to)break;n.type.isError&&n.from==n.to?(i=t,t=n.prevSibling):t=n}return i}get node(){return this}get next(){return this.parent}}class Ye extends hd{constructor(e,t,i,n){super(),this._tree=e,this.from=t,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,n,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,h=t>0?a.length:-1;e!=h;e+=t){let c=a[e],f=l[e]+o.from;if(ld(n,i,f,f+c.length)){if(c instanceof fi){if(s&ye.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,i-f,n);if(u>-1)return new jt(new r1(o,c,e,f),null,u)}else if(s&ye.IncludeAnonymous||!c.type.isAnonymous||hl(c)){let u;if(!(s&ye.IgnoreMounts)&&(u=Jn.get(c))&&!u.overlay)return new Ye(u.tree,f,e,o);let d=new Ye(c,f,e,o);return s&ye.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,i,n)}}}if(s&ye.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,i=0){let n;if(!(i&ye.IgnoreOverlays)&&(n=Jn.get(this._tree))&&n.overlay){let s=e-this.from;for(let{from:o,to:a}of n.overlay)if((t>0?o<=s:o<s)&&(t<0?a>=s:a>s))return new Ye(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Zh(r,e,t,i){let n=r.cursor(),s=[];if(!n.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=n.type.is(t),!n.nextSibling())return s}for(;;){if(i!=null&&n.type.is(i))return s;if(n.type.is(e)&&s.push(n.node),!n.nextSibling())return i==null?s:[]}}function Ta(r,e,t=e.length-1){for(let i=r;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class r1{constructor(e,t,i,n){this.parent=e,this.buffer=t,this.index=i,this.start=n}}class jt extends hd{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new jt(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,i=0){if(i&ye.ExcludeBuffers)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new jt(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new jt(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new jt(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,n=this.index+4,s=i.buffer[this.index+3];if(s>n){let o=i.buffer[this.index+1];e.push(i.slice(n,s,o)),t.push(0)}return new pe(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function cd(r){if(!r.length)return null;let e=0,t=r[0];for(let s=1;s<r.length;s++){let o=r[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let i=t instanceof Ye&&t.index<0?null:t.parent,n=r.slice();return i?n[e]=i:n.splice(e,1),new s1(n,t)}class s1{constructor(e,t){this.heads=e,this.node=t}get next(){return cd(this.heads)}}function o1(r,e,t){let i=r.resolveInner(e,t),n=null;for(let s=i instanceof Ye?i:i.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(n||(n=[i])).push(o.resolve(e,t)),s=o}else{let o=Jn.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Ye(o.tree,o.overlay[0].from+s.from,-1,s);(n||(n=[i])).push(Yn(a,e,t,!1))}}return n?cd(n):i}class us{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ye)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=i+n.buffer[e+1],this.to=i+n.buffer[e+2],!0}yield(e){return e?e instanceof Ye?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:n}=this.buffer,s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&ye.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ye.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ye.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(t.findChild(n,this.index,-1,0,4))}else{let n=t.buffer[this.index+3];if(n<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(n.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=n)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i._tree.children.length;s!=o;s+=e){let a=i._tree.children[s];if(this.mode&ye.IncludeAnonymous||a instanceof fi||!a.type.isAnonymous||hl(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let n=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==n){if(n==this.index)return o;t=o,i=s+1;break e}n=this.stack[--s]}for(let n=i;n<this.stack.length;n++)t=new jt(this.buffer,t,this.stack[n]);return this.bufferNode=new jt(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let n=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&t&&t(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(e){if(!this.buffer)return Ta(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let n=e.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return Ta(this._tree,e,n);let o=i[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[n]&&e[n]!=o.name)return!1;n--}}return!0}}function hl(r){return r.children.some(e=>e instanceof fi||!e.type.isAnonymous||hl(e))}function a1(r){var e;let{buffer:t,nodeSet:i,maxBufferLength:n=ad,reused:s=[],minRepeatType:o=i.types.length}=r,a=Array.isArray(t)?new ll(t,t.length):t,l=i.types,h=0,c=0;function f(A,O,R,K,z,Y){let{id:W,start:T,end:F,size:V}=a,H=c,ae=h;if(V<0)if(a.next(),V==-1){let Te=s[W];R.push(Te),K.push(T-A);return}else if(V==-3){h=W;return}else if(V==-4){c=W;return}else throw new RangeError(`Unrecognized record size: ${V}`);let le=l[W],he,oe,ke=T-A;if(F-T<=n&&(oe=g(a.pos-O,z))){let Te=new Uint16Array(oe.size-oe.skip),w=a.pos-oe.size,M=Te.length;for(;a.pos>w;)M=b(oe.start,Te,M);he=new fi(Te,F-oe.start,i),ke=oe.start-A}else{let Te=a.pos-V;a.next();let w=[],M=[],j=W>=o?W:-1,q=0,G=F;for(;a.pos>Te;)j>=0&&a.id==j&&a.size>=0?(a.end<=G-n&&(p(w,M,T,q,a.end,G,j,H,ae),q=w.length,G=a.end),a.next()):Y>2500?u(T,Te,w,M):f(T,Te,w,M,j,Y+1);if(j>=0&&q>0&&q<w.length&&p(w,M,T,q,T,G,j,H,ae),w.reverse(),M.reverse(),j>-1&&q>0){let Q=d(le,ae);he=cl(le,w,M,0,w.length,0,F-T,Q,Q)}else he=m(le,w,M,F-T,H-F,ae)}R.push(he),K.push(ke)}function u(A,O,R,K){let z=[],Y=0,W=-1;for(;a.pos>O;){let{id:T,start:F,end:V,size:H}=a;if(H>4)a.next();else{if(W>-1&&F<W)break;W<0&&(W=V-n),z.push(T,F,V),Y++,a.next()}}if(Y){let T=new Uint16Array(Y*4),F=z[z.length-2];for(let V=z.length-3,H=0;V>=0;V-=3)T[H++]=z[V],T[H++]=z[V+1]-F,T[H++]=z[V+2]-F,T[H++]=H;R.push(new fi(T,z[2]-F,i)),K.push(F-A)}}function d(A,O){return(R,K,z)=>{let Y=0,W=R.length-1,T,F;if(W>=0&&(T=R[W])instanceof pe){if(!W&&T.type==A&&T.length==z)return T;(F=T.prop(U.lookAhead))&&(Y=K[W]+T.length+F)}return m(A,R,K,z,Y,O)}}function p(A,O,R,K,z,Y,W,T,F){let V=[],H=[];for(;A.length>K;)V.push(A.pop()),H.push(O.pop()+R-z);A.push(m(i.types[W],V,H,Y-z,T-Y,F)),O.push(z-R)}function m(A,O,R,K,z,Y,W){if(Y){let T=[U.contextHash,Y];W=W?[T].concat(W):[T]}if(z>25){let T=[U.lookAhead,z];W=W?[T].concat(W):[T]}return new pe(A,O,R,K,W)}function g(A,O){let R=a.fork(),K=0,z=0,Y=0,W=R.end-n,T={size:0,start:0,skip:0};e:for(let F=R.pos-A;R.pos>F;){let V=R.size;if(R.id==O&&V>=0){T.size=K,T.start=z,T.skip=Y,Y+=4,K+=4,R.next();continue}let H=R.pos-V;if(V<0||H<F||R.start<W)break;let ae=R.id>=o?4:0,le=R.start;for(R.next();R.pos>H;){if(R.size<0)if(R.size==-3||R.size==-4)ae+=4;else break e;else R.id>=o&&(ae+=4);R.next()}z=le,K+=V,Y+=ae}return(O<0||K==A)&&(T.size=K,T.start=z,T.skip=Y),T.size>4?T:void 0}function b(A,O,R){let{id:K,start:z,end:Y,size:W}=a;if(a.next(),W>=0&&K<o){let T=R;if(W>4){let F=a.pos-(W-4);for(;a.pos>F;)R=b(A,O,R)}O[--R]=T,O[--R]=Y-A,O[--R]=z-A,O[--R]=K}else W==-3?h=K:W==-4&&(c=K);return R}let y=[],x=[];for(;a.pos>0;)f(r.start||0,r.bufferStart||0,y,x,-1,0);let E=(e=r.length)!==null&&e!==void 0?e:y.length?x[0]+y[0].length:0;return new pe(l[r.topID],y.reverse(),x.reverse(),E)}const ec=new WeakMap;function Yr(r,e){if(!r.isAnonymous||e instanceof fi||e.type!=r)return 1;let t=ec.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=r||!(i instanceof pe)){t=1;break}t+=Yr(r,i)}ec.set(e,t)}return t}function cl(r,e,t,i,n,s,o,a,l){let h=0;for(let p=i;p<n;p++)h+=Yr(r,e[p]);let c=Math.ceil(h*1.5/8),f=[],u=[];function d(p,m,g,b,y){for(let x=g;x<b;){let E=x,A=m[x],O=Yr(r,p[x]);for(x++;x<b;x++){let R=Yr(r,p[x]);if(O+R>=c)break;O+=R}if(x==E+1){if(O>c){let R=p[E];d(R.children,R.positions,0,R.children.length,m[E]+y);continue}f.push(p[E])}else{let R=m[x-1]+p[x-1].length-A;f.push(cl(r,p,m,E,x,A,R,null,l))}u.push(A+y-s)}}return d(e,t,i,n,0),(a||l)(f,u,o)}class R2{constructor(){this.map=new WeakMap}setBuffer(e,t,i){let n=this.map.get(e);n||this.map.set(e,n=new Map),n.set(t,i)}getBuffer(e,t){let i=this.map.get(e);return i&&i.get(t)}set(e,t){e instanceof jt?this.setBuffer(e.context.buffer,e.index,t):e instanceof Ye&&this.map.set(e.tree,t)}get(e){return e instanceof jt?this.getBuffer(e.context.buffer,e.index):e instanceof Ye?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Gt{constructor(e,t,i,n,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=n,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let n=[new Gt(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&n.push(s);return n}static applyChanges(e,t,i=128){if(!t.length)return e;let n=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,h=0;;a++){let c=a<t.length?t[a]:null,f=c?c.fromA:1e9;if(f-l>=i)for(;o&&o.from<f;){let u=o;if(l>=u.from||f<=u.to||h){let d=Math.max(u.from,l)-h,p=Math.min(u.to,f)-h;u=d>=p?null:new Gt(d,p,u.tree,u.offset+h,a>0,!!c)}if(u&&n.push(u),o.to>f)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,h=c.toA-c.toB}return n}}class fl{startParse(e,t,i){return typeof e=="string"&&(e=new l1(e)),i=i?i.length?i.map(n=>new bt(n.from,n.to)):[new bt(0,0)]:[new bt(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let n=this.startParse(e,t,i);for(;;){let s=n.advance();if(s)return s}}}class l1{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function D2(r){return(e,t,i,n)=>new c1(e,r,t,i,n)}class tc{constructor(e,t,i,n,s){this.parser=e,this.parse=t,this.overlay=i,this.target=n,this.from=s}}function ic(r){if(!r.length||r.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}class h1{constructor(e,t,i,n,s,o,a){this.parser=e,this.predicate=t,this.mounts=i,this.index=n,this.start=s,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const Ea=new U({perNode:!0});class c1{constructor(e,t,i,n,s){this.nest=t,this.input=i,this.fragments=n,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let n of this.inner)n.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new pe(i.type,i.children,i.positions,i.length,i.propValues.concat([[Ea,this.stoppedAt]]))),i}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let i=Object.assign(Object.create(null),e.target.props);i[U.mounted.id]=new Jn(t,e.overlay,e.parser),e.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new d1(this.fragments),t=null,i=null,n=new us(new Ye(this.baseTree,this.ranges[0].from,0,null),ye.IncludeAnonymous|ye.IgnoreMounts);e:for(let s,o;;){let a=!0,l;if(this.stoppedAt!=null&&n.from>=this.stoppedAt)a=!1;else if(e.hasNode(n)){if(t){let h=t.mounts.find(c=>c.frag.from<=n.from&&c.frag.to>=n.to&&c.mount.overlay);if(h)for(let c of h.mount.overlay){let f=c.from+h.pos,u=c.to+h.pos;f>=n.from&&u<=n.to&&!t.ranges.some(d=>d.from<u&&d.to>f)&&t.ranges.push({from:f,to:u})}}a=!1}else if(i&&(o=f1(i.ranges,n.from,n.to)))a=o!=2;else if(!n.type.isAnonymous&&(s=this.nest(n,this.input))&&(n.from<n.to||!s.overlay)){n.tree||(u1(n),t&&t.depth++,i&&i.depth++);let h=e.findMounts(n.from,s.parser);if(typeof s.overlay=="function")t=new h1(s.parser,s.overlay,h,this.inner.length,n.from,n.tree,t);else{let c=sc(this.ranges,s.overlay||(n.from<n.to?[new bt(n.from,n.to)]:[]));c.length&&ic(c),(c.length||!s.overlay)&&this.inner.push(new tc(s.parser,c.length?s.parser.startParse(this.input,oc(h,c),c):s.parser.startParse(""),s.overlay?s.overlay.map(f=>new bt(f.from-n.from,f.to-n.from)):null,n.tree,c.length?c[0].from:n.from)),s.overlay?c.length&&(i={ranges:c,depth:0,prev:i}):a=!1}}else if(t&&(l=t.predicate(n))&&(l===!0&&(l=new bt(n.from,n.to)),l.from<l.to)){let h=t.ranges.length-1;h>=0&&t.ranges[h].to==l.from?t.ranges[h]={from:t.ranges[h].from,to:l.to}:t.ranges.push(l)}if(a&&n.firstChild())t&&t.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break e;if(t&&!--t.depth){let h=sc(this.ranges,t.ranges);h.length&&(ic(h),this.inner.splice(t.index,0,new tc(t.parser,t.parser.startParse(this.input,oc(t.mounts,h),h),t.ranges.map(c=>new bt(c.from-t.start,c.to-t.start)),t.target,h[0].from))),t=t.prev}i&&!--i.depth&&(i=i.prev)}}}}function f1(r,e,t){for(let i of r){if(i.from>=t)break;if(i.to>e)return i.from<=e&&i.to>=t?2:1}return 0}function nc(r,e,t,i,n,s){if(e<t){let o=r.buffer[e+1];i.push(r.slice(e,t,o)),n.push(o-s)}}function u1(r){let{node:e}=r,t=[],i=e.context.buffer;do t.push(r.index),r.parent();while(!r.tree);let n=r.tree,s=n.children.indexOf(i),o=n.children[s],a=o.buffer,l=[s];function h(c,f,u,d,p,m){let g=t[m],b=[],y=[];nc(o,c,g,b,y,d);let x=a[g+1],E=a[g+2];l.push(b.length);let A=m?h(g+4,a[g+3],o.set.types[a[g]],x,E-x,m-1):e.toTree();return b.push(A),y.push(x-d),nc(o,a[g+3],f,b,y,d),new pe(u,b,y,p)}n.children[s]=h(0,a.length,Xe.none,0,o.length,t.length-1);for(let c of l){let f=r.tree.children[c],u=r.tree.positions[c];r.yield(new Ye(f,u+r.from,c,r._tree))}}class rc{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(ye.IncludeAnonymous|ye.IgnoreMounts)}moveTo(e){let{cursor:t}=this,i=e-this.offset;for(;!this.done&&t.from<i;)t.to>=e&&t.enter(i,1,ye.IgnoreOverlays|ye.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof pe)t=t.children[0];else break}return!1}}let d1=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let i=this.curFrag=e[0];this.curTo=(t=i.tree.prop(Ea))!==null&&t!==void 0?t:i.to,this.inner=new rc(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(Ea))!==null&&e!==void 0?e:t.to,this.inner=new rc(t.tree,-t.offset)}}findMounts(e,t){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(i=s.tree)===null||i===void 0?void 0:i.prop(U.mounted);if(o&&o.parser==t)for(let a=this.fragI;a<this.fragments.length;a++){let l=this.fragments[a];if(l.from>=s.to)break;l.tree==this.curFrag.tree&&n.push({frag:l,pos:s.from-l.offset,mount:o})}}}return n}};function sc(r,e){let t=null,i=e;for(let n=1,s=0;n<r.length;n++){let o=r[n-1].to,a=r[n].from;for(;s<i.length;s++){let l=i[s];if(l.from>=a)break;l.to<=o||(t||(i=t=e.slice()),l.from<o?(t[s]=new bt(l.from,o),l.to>a&&t.splice(s+1,0,new bt(a,l.to))):l.to>a?t[s--]=new bt(a,l.to):t.splice(s--,1))}}return i}function p1(r,e,t,i){let n=0,s=0,o=!1,a=!1,l=-1e9,h=[];for(;;){let c=n==r.length?1e9:o?r[n].to:r[n].from,f=s==e.length?1e9:a?e[s].to:e[s].from;if(o!=a){let u=Math.max(l,t),d=Math.min(c,f,i);u<d&&h.push(new bt(u,d))}if(l=Math.min(c,f),l==1e9)break;c==l&&(o?(o=!1,n++):o=!0),f==l&&(a?(a=!1,s++):a=!0)}return h}function oc(r,e){let t=[];for(let{pos:i,mount:n,frag:s}of r){let o=i+(n.overlay?n.overlay[0].from:0),a=o+n.tree.length,l=Math.max(s.from,o),h=Math.min(s.to,a);if(n.overlay){let c=n.overlay.map(u=>new bt(u.from+i,u.to+i)),f=p1(e,c,l,h);for(let u=0,d=l;;u++){let p=u==f.length,m=p?h:f[u].from;if(m>d&&t.push(new Gt(d,m,n.tree,-o,s.from>=d||s.openStart,s.to<=m||s.openEnd)),p)break;d=f[u].to}}else t.push(new Gt(l,h,n.tree,-o,s.from>=o||s.openStart,s.to<=a||s.openEnd))}return t}let m1=0;class pt{constructor(e,t,i,n){this.name=e,this.set=t,this.base=i,this.modified=n,this.id=m1++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof pt&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let n=new pt(i,[],null,[]);if(n.set.push(n),t)for(let s of t.set)n.set.push(s);return n}static defineModifier(e){let t=new ds(e);return i=>i.modified.indexOf(t)>-1?i:ds.get(i.base||i,i.modified.concat(t).sort((n,s)=>n.id-s.id))}}let g1=0;class ds{constructor(e){this.name=e,this.instances=[],this.id=g1++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(a=>a.base==e&&b1(t,a.modified));if(i)return i;let n=[],s=new pt(e.name,n,e,t);for(let a of t)a.instances.push(s);let o=y1(t);for(let a of e.set)if(!a.modified.length)for(let l of o)n.push(ds.get(a,l));return s}}function b1(r,e){return r.length==e.length&&r.every((t,i)=>t==e[i])}function y1(r){let e=[[]];for(let t=0;t<r.length;t++)for(let i=0,n=e.length;i<n;i++)e.push(e[i].concat(r[t]));return e.sort((t,i)=>i.length-t.length)}function v1(r){let e=Object.create(null);for(let t in r){let i=r[t];Array.isArray(i)||(i=[i]);for(let n of t.split(" "))if(n){let s=[],o=2,a=n;for(let f=0;;){if(a=="..."&&f>0&&f+3==n.length){o=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!u)throw new RangeError("Invalid path: "+n);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),f+=u[0].length,f==n.length)break;let d=n[f++];if(f==n.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+n);a=n.slice(f)}let l=s.length-1,h=s[l];if(!h)throw new RangeError("Invalid path: "+n);let c=new Xn(i,o,l>0?s.slice(0,l):null);e[h]=c.sort(e[h])}}return fd.add(e)}const fd=new U({combine(r,e){let t,i,n;for(;r||e;){if(!r||e&&r.depth>=e.depth?(n=e,e=e.next):(n=r,r=r.next),t&&t.mode==n.mode&&!n.context&&!t.context)continue;let s=new Xn(n.tags,n.mode,n.context);t?t.next=s:i=s,t=s}return i}});let Xn=class{constructor(e,t,i,n){this.tags=e,this.mode=t,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};Xn.empty=new Xn([],2,null);function ud(r,e){let t=Object.create(null);for(let s of r)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:i,all:n=null}=e||{};return{style:s=>{let o=n;for(let a of s)for(let l of a.set){let h=t[l.id];if(h){o=o?o+" "+h:h;break}}return o},scope:i}}function x1(r,e){let t=null;for(let i of r){let n=i.style(e);n&&(t=t?t+" "+n:n)}return t}function dd(r,e,t,i=0,n=r.length){let s=new k1(i,Array.isArray(e)?e:[e],t);s.highlightRange(r.cursor(),i,n,"",s.highlighters),s.flush(n)}class k1{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,n,s){let{type:o,from:a,to:l}=e;if(a>=i||l<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let h=n,c=w1(e)||Xn.empty,f=x1(s,c.tags);if(f&&(h&&(h+=" "),h+=f,c.mode==1&&(n+=(n?" ":"")+f)),this.startSpan(Math.max(t,a),h),c.opaque)return;let u=e.tree&&e.tree.prop(U.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+a,1),p=this.highlighters.filter(g=>!g.scope||g.scope(u.tree.type)),m=e.firstChild();for(let g=0,b=a;;g++){let y=g<u.overlay.length?u.overlay[g]:null,x=y?y.from+a:l,E=Math.max(t,b),A=Math.min(i,x);if(E<A&&m)for(;e.from<A&&(this.highlightRange(e,E,A,n,s),this.startSpan(Math.min(A,e.to),h),!(e.to>=x||!e.nextSibling())););if(!y||x>i)break;b=y.to+a,b>t&&(this.highlightRange(d.cursor(),Math.max(t,y.from+a),Math.min(i,b),"",p),this.startSpan(Math.min(i,b),h))}m&&e.parent()}else if(e.firstChild()){u&&(n="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,n,s),this.startSpan(Math.min(i,e.to),h)}while(e.nextSibling());e.parent()}}}function w1(r){let e=r.type.prop(fd);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const P=pt.define,Ir=P(),Zt=P(),ac=P(Zt),lc=P(Zt),ei=P(),Nr=P(ei),uo=P(ei),Dt=P(),xi=P(Dt),Mt=P(),Rt=P(),Oa=P(),bn=P(Oa),Br=P(),C={comment:Ir,lineComment:P(Ir),blockComment:P(Ir),docComment:P(Ir),name:Zt,variableName:P(Zt),typeName:ac,tagName:P(ac),propertyName:lc,attributeName:P(lc),className:P(Zt),labelName:P(Zt),namespace:P(Zt),macroName:P(Zt),literal:ei,string:Nr,docString:P(Nr),character:P(Nr),attributeValue:P(Nr),number:uo,integer:P(uo),float:P(uo),bool:P(ei),regexp:P(ei),escape:P(ei),color:P(ei),url:P(ei),keyword:Mt,self:P(Mt),null:P(Mt),atom:P(Mt),unit:P(Mt),modifier:P(Mt),operatorKeyword:P(Mt),controlKeyword:P(Mt),definitionKeyword:P(Mt),moduleKeyword:P(Mt),operator:Rt,derefOperator:P(Rt),arithmeticOperator:P(Rt),logicOperator:P(Rt),bitwiseOperator:P(Rt),compareOperator:P(Rt),updateOperator:P(Rt),definitionOperator:P(Rt),typeOperator:P(Rt),controlOperator:P(Rt),punctuation:Oa,separator:P(Oa),bracket:bn,angleBracket:P(bn),squareBracket:P(bn),paren:P(bn),brace:P(bn),content:Dt,heading:xi,heading1:P(xi),heading2:P(xi),heading3:P(xi),heading4:P(xi),heading5:P(xi),heading6:P(xi),contentSeparator:P(Dt),list:P(Dt),quote:P(Dt),emphasis:P(Dt),strong:P(Dt),link:P(Dt),monospace:P(Dt),strikethrough:P(Dt),inserted:P(),deleted:P(),changed:P(),invalid:P(),meta:Br,documentMeta:P(Br),annotation:P(Br),processingInstruction:P(Br),definition:pt.defineModifier("definition"),constant:pt.defineModifier("constant"),function:pt.defineModifier("function"),standard:pt.defineModifier("standard"),local:pt.defineModifier("local"),special:pt.defineModifier("special")};for(let r in C){let e=C[r];e instanceof pt&&(e.name=r)}ud([{tag:C.link,class:"tok-link"},{tag:C.heading,class:"tok-heading"},{tag:C.emphasis,class:"tok-emphasis"},{tag:C.strong,class:"tok-strong"},{tag:C.keyword,class:"tok-keyword"},{tag:C.atom,class:"tok-atom"},{tag:C.bool,class:"tok-bool"},{tag:C.url,class:"tok-url"},{tag:C.labelName,class:"tok-labelName"},{tag:C.inserted,class:"tok-inserted"},{tag:C.deleted,class:"tok-deleted"},{tag:C.literal,class:"tok-literal"},{tag:C.string,class:"tok-string"},{tag:C.number,class:"tok-number"},{tag:[C.regexp,C.escape,C.special(C.string)],class:"tok-string2"},{tag:C.variableName,class:"tok-variableName"},{tag:C.local(C.variableName),class:"tok-variableName tok-local"},{tag:C.definition(C.variableName),class:"tok-variableName tok-definition"},{tag:C.special(C.variableName),class:"tok-variableName2"},{tag:C.definition(C.propertyName),class:"tok-propertyName tok-definition"},{tag:C.typeName,class:"tok-typeName"},{tag:C.namespace,class:"tok-namespace"},{tag:C.className,class:"tok-className"},{tag:C.macroName,class:"tok-macroName"},{tag:C.propertyName,class:"tok-propertyName"},{tag:C.operator,class:"tok-operator"},{tag:C.comment,class:"tok-comment"},{tag:C.meta,class:"tok-meta"},{tag:C.invalid,class:"tok-invalid"},{tag:C.punctuation,class:"tok-punctuation"}]);var po;const Oi=new U;function pd(r){return I.define({combine:r?e=>e.concat(r):void 0})}const S1=new U;class yt{constructor(e,t,i=[],n=""){this.data=e,this.name=n,ie.prototype.hasOwnProperty("tree")||Object.defineProperty(ie.prototype,"tree",{get(){return De(this)}}),this.parser=t,this.extension=[ui.of(this),ie.languageData.of((s,o,a)=>{let l=hc(s,o,a),h=l.type.prop(Oi);if(!h)return[];let c=s.facet(h),f=l.type.prop(S1);if(f){let u=l.resolve(o-l.from,a);for(let d of f)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(i)}isActiveAt(e,t,i=-1){return hc(e,t,i).type.prop(Oi)==this.data}findRegions(e){let t=e.facet(ui);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],n=(s,o)=>{if(s.prop(Oi)==this.data){i.push({from:o,to:o+s.length});return}let a=s.prop(U.mounted);if(a){if(a.tree.prop(Oi)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+s.length});return}else if(a.overlay){let l=i.length;if(n(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<s.children.length;l++){let h=s.children[l];h instanceof pe&&n(h,s.positions[l]+o)}};return n(De(e),0),i}get allowsNesting(){return!0}}yt.setState=de.define();function hc(r,e,t){let i=r.facet(ui),n=De(r).topNode;if(!i||i.allowsNesting)for(let s=n;s;s=s.enter(e,t,ye.ExcludeBuffers))s.type.isTop&&(n=s);return n}class ps extends yt{constructor(e,t,i){super(e,t,[],i),this.parser=t}static define(e){let t=pd(e.languageData);return new ps(t,e.parser.configure({props:[Oi.add(i=>i.isTop?t:void 0)]}),e.name)}configure(e,t){return new ps(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function De(r){let e=r.field(yt.state,!1);return e?e.tree:pe.empty}class C1{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let yn=null;class on{constructor(e,t,i=[],n,s,o,a,l){this.parser=e,this.state=t,this.fragments=i,this.tree=n,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new on(e,t,[],pe.empty,0,i,[],null)}startParse(){return this.parser.startParse(new C1(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=pe.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let n=Date.now()+e;e=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Gt.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Gt.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=yn;yn=this;try{return e()}finally{yn=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=cc(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:n,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((h,c,f,u)=>l.push({fromA:h,toA:c,fromB:f,toB:u})),i=Gt.applyChanges(i,l),n=pe.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let h of this.skipped){let c=e.mapPos(h.from,1),f=e.mapPos(h.to,-1);c<f&&a.push({from:c,to:f})}}}return new on(this.parser,t,i,n,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:s}=this.skipped[i];n<e.to&&s>e.from&&(this.fragments=cc(this.fragments,n,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends fl{createParse(t,i,n){let s=n[0].from,o=n[n.length-1].to;return{parsedPos:s,advance(){let l=yn;if(l){for(let h of n)l.tempSkipped.push(h);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new pe(Xe.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return yn}}function cc(r,e,t){return Gt.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class an{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new an(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=on.create(e.facet(ui).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new an(i)}}yt.state=ft.define({create:an.init,update(r,e){for(let t of e.effects)if(t.is(yt.setState))return t.value;return e.startState.facet(ui)!=e.state.facet(ui)?an.init(e.state):r.apply(e)}});let md=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(md=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const mo=typeof navigator<"u"&&(!((po=navigator.scheduling)===null||po===void 0)&&po.isInputPending)?()=>navigator.scheduling.isInputPending():null,_1=Ce.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(yt.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(yt.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=md(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(yt.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!mo?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<n&&i.doc.length>n+1e3,l=s.context.work(()=>mo&&mo()||Date.now()>o,n+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:yt.setState.of(new an(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Bt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ui=I.define({combine(r){return r.length?r[0]:null},enables:r=>[yt.state,_1,N.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});class Xr{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class ul{constructor(e,t,i,n,s,o=void 0){this.name=e,this.alias=t,this.extensions=i,this.filename=n,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:i}=e;if(!t){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(i)}return new ul(e.name,(e.alias||[]).concat(e.name).map(n=>n.toLowerCase()),e.extensions||[],e.filename,t,i)}static matchFilename(e,t){for(let n of e)if(n.filename&&n.filename.test(t))return n;let i=/\.([^.]+)$/.exec(t);if(i){for(let n of e)if(n.extensions.indexOf(i[1])>-1)return n}return null}static matchLanguageName(e,t,i=!0){t=t.toLowerCase();for(let n of e)if(n.alias.some(s=>s==t))return n;if(i)for(let n of e)for(let s of n.alias){let o=t.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+s.length])))return n}return null}}const A1=I.define(),ln=I.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function Ii(r){let e=r.facet(ln);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Qn(r,e){let t="",i=r.tabSize,n=r.facet(ln)[0];if(n=="	"){for(;e>=i;)t+="	",e-=i;n=" "}for(let s=0;s<e;s++)t+=n;return t}function dl(r,e){r instanceof ie&&(r=new js(r));for(let i of r.state.facet(A1)){let n=i(r,e);if(n!==void 0)return n}let t=De(r.state);return t.length>=e?T1(r,t,e):null}class js{constructor(e,t={}){this.state=e,this.options=t,this.unit=Ii(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:s}=this.options;return n!=null&&n>=i.from&&n<=i.to?s&&n==e?{text:"",from:e}:(t<0?n<e:n<=e)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(e,t);return i.slice(e-n,Math.min(i.length,e+100-n))}column(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.countColumn(i,e-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return hn(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:n}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(n);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const gd=new U;function T1(r,e,t){let i=e.resolveStack(t),n=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(n!=i.node){let s=[];for(let o=n;o&&!(o.from<i.node.from||o.to>i.node.to||o.from==i.node.from&&o.type==i.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)i={node:s[o],next:i}}return bd(i,r,t)}function bd(r,e,t){for(let i=r;i;i=i.next){let n=O1(i.node);if(n)return n(pl.create(e,t,i))}return 0}function E1(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function O1(r){let e=r.type.prop(gd);if(e)return e;let t=r.firstChild,i;if(t&&(i=t.type.prop(U.closedBy))){let n=r.lastChild,s=n&&i.indexOf(n.name)>-1;return o=>yd(o,!0,1,void 0,s&&!E1(o)?n.from:void 0)}return r.parent==null?M1:null}function M1(){return 0}class pl extends js{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new pl(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(R1(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return bd(this.context.next,this.base,this.pos)}}function R1(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function D1(r){let e=r.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let n=r.options.simulateBreak,s=r.state.doc.lineAt(t.from),o=n==null||n<=s.from?s.to:Math.min(s.to,n);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let h=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+h}}a=l.to}}function N2({closing:r,align:e=!0,units:t=1}){return i=>yd(i,e,t,r)}function yd(r,e,t,i,n){let s=r.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||n==r.pos+o,l=e?D1(r):null;return l?a?r.column(l.from):r.column(l.to):r.baseIndent+(a?0:r.unit*t)}const B2=r=>r.baseIndent;function j2({except:r,units:e=1}={}){return t=>{let i=r&&r.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const P1=200;function L1(){return ie.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:i}=r.newSelection.main,n=t.lineAt(i);if(i>n.from+P1)return r;let s=t.sliceString(n.from,i);if(!e.some(h=>h.test(s)))return r;let{state:o}=r,a=-1,l=[];for(let{head:h}of o.selection.ranges){let c=o.doc.lineAt(h);if(c.from==a)continue;a=c.from;let f=dl(o,c.from);if(f==null)continue;let u=/^\s*/.exec(c.text)[0],d=Qn(o,f);u!=d&&l.push({from:c.from,to:c.from+u.length,insert:d})}return l.length?[r,{changes:l,sequential:!0}]:r})}const I1=I.define(),N1=new U;function F2(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}function B1(r,e,t){let i=De(r);if(i.length<t)return null;let n=i.resolveStack(t,1),s=null;for(let o=n;o;o=o.next){let a=o.node;if(a.to<=t||a.from>t)continue;if(s&&a.from<e)break;let l=a.type.prop(N1);if(l&&(a.to<i.length-50||i.length==r.doc.length||!j1(a))){let h=l(a,r);h&&h.from<=t&&h.from>=e&&h.to>t&&(s=h)}}return s}function j1(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function fc(r,e,t){for(let i of r.facet(I1)){let n=i(r,e,t);if(n)return n}return B1(r,e,t)}function vd(r,e){let t=e.mapPos(r.from,1),i=e.mapPos(r.to,-1);return t>=i?void 0:{from:t,to:i}}const xd=de.define({map:vd}),ml=de.define({map:vd}),ms=ft.define({create(){return J.none},update(r,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,i)=>r=uc(r,t,i)),r=r.map(e.changes);for(let t of e.effects)if(t.is(xd)&&!F1(r,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(kd),n=i?J.replace({widget:new V1(i(e.state,t.value))}):dc;r=r.update({add:[n.range(t.value.from,t.value.to)]})}else t.is(ml)&&(r=r.update({filter:(i,n)=>t.value.from!=i||t.value.to!=n,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(r=uc(r,e.selection.main.head)),r},provide:r=>N.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(i,n)=>{t.push(i,n)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let i=r[t++],n=r[t++];if(typeof i!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");e.push(dc.range(i,n))}return J.set(e,!0)}});function uc(r,e,t=e){let i=!1;return r.between(e,t,(n,s)=>{n<t&&s>e&&(i=!0)}),i?r.update({filterFrom:e,filterTo:t,filter:(n,s)=>n>=t||s<=e}):r}function Ma(r,e,t){var i;let n=null;return(i=r.field(ms,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!n||n.from>s)&&(n={from:s,to:o})}),n}function F1(r,e,t){let i=!1;return r.between(e,e,(n,s)=>{n==e&&s==t&&(i=!0)}),i}const $1={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},kd=I.define({combine(r){return ji(r,$1)}});function z1(r){return[ms,q1]}function wd(r,e){let{state:t}=r,i=t.facet(kd),n=o=>{let a=r.lineBlockAt(r.posAtDOM(o.target)),l=Ma(r.state,a.from,a.to);l&&r.dispatch({effects:ml.of(l)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(r,n,e);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=n,s}const dc=J.replace({widget:new class extends Xt{toDOM(r){return wd(r,null)}}});class V1 extends Xt{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return wd(e,this.value)}}const W1={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class go extends ci{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function H1(r={}){let e={...W1,...r},t=new go(e,!0),i=new go(e,!1),n=Ce.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(ui)!=o.state.facet(ui)||o.startState.field(ms,!1)!=o.state.field(ms,!1)||De(o.startState)!=De(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Kt;for(let l of o.viewportLineBlocks){let h=Ma(o.state,l.from,l.to)?i:fc(o.state,l.from,l.to)?t:null;h&&a.add(l.from,l.from,h)}return a.finish()}}),{domEventHandlers:s}=e;return[n,Vb({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(n))===null||a===void 0?void 0:a.markers)||se.empty},initialSpacer(){return new go(e,!1)},domEventHandlers:{...s,click:(o,a,l)=>{if(s.click&&s.click(o,a,l))return!0;let h=Ma(o.state,a.from,a.to);if(h)return o.dispatch({effects:ml.of(h)}),!0;let c=fc(o.state,a.from,a.to);return c?(o.dispatch({effects:xd.of(c)}),!0):!1}}}),z1()]}const q1=N.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class cr{constructor(e,t){this.specs=e;let i;function n(a){let l=Jt.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const s=typeof t.all=="string"?t.all:t.all?n(t.all):void 0,o=t.scope;this.scope=o instanceof yt?a=>a.prop(Oi)==o.data:o?a=>a==o:void 0,this.style=ud(e.map(a=>({tag:a.tag,class:a.class||n(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=i?new Jt(i):null,this.themeType=t.themeType}static define(e,t){return new cr(e,t||{})}}const Ra=I.define(),G1=I.define({combine(r){return r.length?[r[0]]:null}});function bo(r){let e=r.facet(Ra);return e.length?e:r.facet(G1)}function Sd(r,e){let t=[K1],i;return r instanceof cr&&(r.module&&t.push(N.styleModule.of(r.module)),i=r.themeType),i?t.push(Ra.computeN([N.darkTheme],n=>n.facet(N.darkTheme)==(i=="dark")?[r]:[])):t.push(Ra.of(r)),t}class U1{constructor(e){this.markCache=Object.create(null),this.tree=De(e.state),this.decorations=this.buildDeco(e,bo(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=De(e.state),i=bo(e.state),n=i!=bo(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!n&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return J.none;let i=new Kt;for(let{from:n,to:s}of e.visibleRanges)dd(this.tree,t,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=J.mark({class:l})))},n,s);return i.finish()}}const K1=Bi.high(Ce.fromClass(U1,{decorations:r=>r.decorations})),J1=cr.define([{tag:C.meta,color:"#404740"},{tag:C.link,textDecoration:"underline"},{tag:C.heading,textDecoration:"underline",fontWeight:"bold"},{tag:C.emphasis,fontStyle:"italic"},{tag:C.strong,fontWeight:"bold"},{tag:C.strikethrough,textDecoration:"line-through"},{tag:C.keyword,color:"#708"},{tag:[C.atom,C.bool,C.url,C.contentSeparator,C.labelName],color:"#219"},{tag:[C.literal,C.inserted],color:"#164"},{tag:[C.string,C.deleted],color:"#a11"},{tag:[C.regexp,C.escape,C.special(C.string)],color:"#e40"},{tag:C.definition(C.variableName),color:"#00f"},{tag:C.local(C.variableName),color:"#30a"},{tag:[C.typeName,C.namespace],color:"#085"},{tag:C.className,color:"#167"},{tag:[C.special(C.variableName),C.macroName],color:"#256"},{tag:C.definition(C.propertyName),color:"#00c"},{tag:C.comment,color:"#940"},{tag:C.invalid,color:"#f00"}]),Y1=N.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Cd=1e4,_d="()[]{}",Ad=I.define({combine(r){return ji(r,{afterCursor:!0,brackets:_d,maxScanDistance:Cd,renderMatch:Z1})}}),X1=J.mark({class:"cm-matchingBracket"}),Q1=J.mark({class:"cm-nonmatchingBracket"});function Z1(r){let e=[],t=r.matched?X1:Q1;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const ey=ft.define({create(){return J.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],i=e.state.facet(Ad);for(let n of e.state.selection.ranges){if(!n.empty)continue;let s=Ft(e.state,n.head,-1,i)||n.head>0&&Ft(e.state,n.head-1,1,i)||i.afterCursor&&(Ft(e.state,n.head,1,i)||n.head<e.state.doc.length&&Ft(e.state,n.head+1,-1,i));s&&(t=t.concat(i.renderMatch(s,e.state)))}return J.set(t,!0)},provide:r=>N.decorations.from(r)}),ty=[ey,Y1];function iy(r={}){return[Ad.of(r),ty]}const ny=new U;function Da(r,e,t){let i=r.prop(e<0?U.openedBy:U.closedBy);if(i)return i;if(r.name.length==1){let n=t.indexOf(r.name);if(n>-1&&n%2==(e<0?1:0))return[t[n+e]]}return null}function Pa(r){let e=r.type.prop(ny);return e?e(r.node):r}function Ft(r,e,t,i={}){let n=i.maxScanDistance||Cd,s=i.brackets||_d,o=De(r),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let h=Da(l.type,t,s);if(h&&l.from<l.to){let c=Pa(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return ry(r,e,t,l,c,h,s)}}return sy(r,e,t,o,a.type,n,s)}function ry(r,e,t,i,n,s,o){let a=i.parent,l={from:n.from,to:n.to},h=0,c=a?.cursor();if(c&&(t<0?c.childBefore(i.from):c.childAfter(i.to)))do if(t<0?c.to<=i.from:c.from>=i.to){if(h==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let f=Pa(c);return{start:l,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(Da(c.type,t,o))h++;else if(Da(c.type,-t,o)){if(h==0){let f=Pa(c);return{start:l,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}h--}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function sy(r,e,t,i,n,s,o){let a=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},c=r.doc.iterRange(e,t>0?r.doc.length:0),f=0;for(let u=0;!c.next().done&&u<=s;){let d=c.value;t<0&&(u+=d.length);let p=e+u*t;for(let m=t>0?0:d.length-1,g=t>0?d.length:-1;m!=g;m+=t){let b=o.indexOf(d[m]);if(!(b<0||i.resolveInner(p+m,1).type!=n))if(b%2==0==t>0)f++;else{if(f==1)return{start:h,end:{from:p+m,to:p+m+1},matched:b>>1==l>>1};f--}}t>0&&(u+=d.length)}return c.done?{start:h,matched:!1}:null}function pc(r,e,t,i=0,n=0){e==null&&(e=r.search(/[^\s\u00a0]/),e==-1&&(e=r.length));let s=n;for(let o=i;o<e;o++)r.charCodeAt(o)==9?s+=t-s%t:s++;return s}class Td{constructor(e,t,i,n){this.string=e,this.tabSize=t,this.indentUnit=i,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),i;if(typeof e=="string"?i=t==e:i=t&&(e instanceof RegExp?e.test(t):e(t)),i)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=pc(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:pc(this.string,null,this.tabSize)}match(e,t,i){if(typeof e=="string"){let n=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return n(s)==n(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&t!==!1&&(this.pos+=n[0].length),n)}}current(){return this.string.slice(this.start,this.pos)}}function oy(r){return{name:r.name||"",token:r.token,blankLine:r.blankLine||(()=>{}),startState:r.startState||(()=>!0),copyState:r.copyState||ay,indent:r.indent||(()=>null),languageData:r.languageData||{},tokenTable:r.tokenTable||yl,mergeTokens:r.mergeTokens!==!1}}function ay(r){if(typeof r!="object")return r;let e={};for(let t in r){let i=r[t];e[t]=i instanceof Array?i.slice():i}return e}const mc=new WeakMap;class gl extends yt{constructor(e){let t=pd(e.languageData),i=oy(e),n,s=new class extends fl{createParse(o,a,l){return new hy(n,o,a,l)}};super(t,s,[],e.name),this.topNode=uy(t,this),n=this,this.streamParser=i,this.stateAfter=new U({perNode:!0}),this.tokenTable=e.tokenTable?new Rd(i.tokenTable):fy}static define(e){return new gl(e)}getIndent(e){let t,{overrideIndentation:i}=e.options;i&&(t=mc.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let n=bl(this,e.node.tree,e.node.from,e.node.from,t??e.pos),s,o;if(n?(o=n.state,s=n.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let l=e.state.doc.lineAt(s),h=Math.min(e.pos,l.to);if(l.length){let c=i?i(l.from):-1,f=new Td(l.text,e.state.tabSize,e.unit,c<0?void 0:c);for(;f.pos<h-l.from;)Od(this.streamParser.token,f,o)}else this.streamParser.blankLine(o,e.unit);if(h==e.pos)break;s=l.to+1}let a=e.lineAt(e.pos);return i&&t==null&&mc.set(e.state,a.from),this.streamParser.indent(o,/^\s*(.*)/.exec(a.text)[1],e)}get allowsNesting(){return!1}}function bl(r,e,t,i,n){let s=t>=i&&t+e.length<=n&&e.prop(r.stateAfter);if(s)return{state:r.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=t+e.positions[o],h=a instanceof pe&&l<n&&bl(r,a,l,i,n);if(h)return h}return null}function Ed(r,e,t,i,n){if(n&&t<=0&&i>=e.length)return e;!n&&t==0&&e.type==r.topNode&&(n=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<i&&a instanceof pe){if(!(l=Ed(r,a,t-o,i-o,n)))break;return n?new pe(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function ly(r,e,t,i,n){for(let s of e){let o=s.from+(s.openStart?25:0),a=s.to-(s.openEnd?25:0),l=o<=t&&a>t&&bl(r,s.tree,0-s.offset,t,a),h;if(l&&l.pos<=i&&(h=Ed(r,s.tree,t+s.offset,l.pos+s.offset,!1)))return{state:l.state,tree:h}}return{state:r.streamParser.startState(n?Ii(n):4),tree:pe.empty}}let hy=class{constructor(e,t,i,n){this.lang=e,this.input=t,this.fragments=i,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let s=on.get(),o=n[0].from,{state:a,tree:l}=ly(e,i,o,this.to,s?.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let h=0;h<l.children.length;h++)this.chunks.push(l.children[h]),this.chunkPos.push(l.positions[h]);s&&this.parsedPos<s.viewport.from-1e5&&n.some(h=>h.from<=s.viewport.from&&h.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(Ii(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=on.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(t,this.chunkStart+512);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let i=t.indexOf(`
`);i>-1&&(t=t.slice(0,i))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),i=e+t.length;for(let n=this.rangeIndex;;){let s=this.ranges[n].to;if(s>=i||(t=t.slice(0,s-(i-t.length)),n++,n==this.ranges.length))break;let o=this.ranges[n].from,a=this.lineAfter(o);t+=a,i=o+a.length}return{line:t,end:i}}skipGapsTo(e,t,i){for(;;){let n=this.ranges[this.rangeIndex].to,s=e+t;if(i>0?n>s:n>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-n}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,i,n){let s=4;if(this.ranges.length>1){n=this.skipGapsTo(t,n,1),t+=n;let a=this.chunk.length;n=this.skipGapsTo(i,n,-1),i+=n,s+=this.chunk.length-a}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==t?this.chunk[o+2]=i:this.chunk.push(e,t,i,s),n}parseLine(e){let{line:t,end:i}=this.nextLine(),n=0,{streamParser:s}=this.lang,o=new Td(t,e?e.state.tabSize:4,e?Ii(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=Od(s.token,o,this.state);if(a&&(n=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,n)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=pe.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:cy,topID:0,maxBufferLength:512,reused:this.chunkReused});e=new pe(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new pe(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function Od(r,e,t){e.start=e.pos;for(let i=0;i<10;i++){let n=r(e,t);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const yl=Object.create(null),Zn=[Xe.none],cy=new Bs(Zn),gc=[],bc=Object.create(null),Md=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Md[r]=Dd(yl,e);class Rd{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Md)}resolve(e){return e?this.table[e]||(this.table[e]=Dd(this.extra,e)):0}}const fy=new Rd(yl);function yo(r,e){gc.indexOf(r)>-1||(gc.push(r),console.warn(e))}function Dd(r,e){let t=[];for(let a of e.split(" ")){let l=[];for(let h of a.split(".")){let c=r[h]||C[h];c?typeof c=="function"?l.length?l=l.map(c):yo(h,`Modifier ${h} used at start of tag`):l.length?yo(h,`Tag ${h} used as modifier`):l=Array.isArray(c)?c:[c]:yo(h,`Unknown highlighting tag ${h}`)}for(let h of l)t.push(h)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),n=i+" "+t.map(a=>a.id),s=bc[n];if(s)return s.id;let o=bc[n]=Xe.define({id:Zn.length,name:i,props:[v1({[i]:t})]});return Zn.push(o),o.id}function uy(r,e){let t=Xe.define({id:Zn.length,name:"Document",props:[Oi.add(()=>r),gd.add(()=>i=>e.getIndent(i))],top:!0});return Zn.push(t),t}ve.RTL,ve.LTR;const dy=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),i=xl(r.state,t.from);return i.line?py(r):i.block?gy(r):!1};function vl(r,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let n=r(e,t);return n?(i(t.update(n)),!0):!1}}const py=vl(vy,0),my=vl(Pd,0),gy=vl((r,e)=>Pd(r,e,yy(e)),0);function xl(r,e){let t=r.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const vn=50;function by(r,{open:e,close:t},i,n){let s=r.sliceDoc(i-vn,i),o=r.sliceDoc(n,n+vn),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,h=s.length-a;if(s.slice(h-e.length,h)==e&&o.slice(l,l+t.length)==t)return{open:{pos:i-a,margin:a&&1},close:{pos:n+l,margin:l&&1}};let c,f;n-i<=2*vn?c=f=r.sliceDoc(i,n):(c=r.sliceDoc(i,i+vn),f=r.sliceDoc(n-vn,n));let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(f)[0].length,p=f.length-d-t.length;return c.slice(u,u+e.length)==e&&f.slice(p,p+t.length)==t?{open:{pos:i+u+e.length,margin:/\s/.test(c.charAt(u+e.length))?1:0},close:{pos:n-d-t.length,margin:/\s/.test(f.charAt(p-1))?1:0}}:null}function yy(r){let e=[];for(let t of r.selection.ranges){let i=r.doc.lineAt(t.from),n=t.to<=i.to?i:r.doc.lineAt(t.to);n.from>i.from&&n.from==t.to&&(n=t.to==i.to+1?i:r.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=n.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:n.to})}return e}function Pd(r,e,t=e.selection.ranges){let i=t.map(s=>xl(e,s.from).block);if(!i.every(s=>s))return null;let n=t.map((s,o)=>by(e,i[o],s.from,s.to));if(r!=2&&!n.every(s=>s))return{changes:e.changes(t.map((s,o)=>n[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(r!=1&&n.some(s=>s)){let s=[];for(let o=0,a;o<n.length;o++)if(a=n[o]){let l=i[o],{open:h,close:c}=a;s.push({from:h.pos-l.open.length,to:h.pos+h.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function vy(r,e,t=e.selection.ranges){let i=[],n=-1;for(let{from:s,to:o}of t){let a=i.length,l=1e9,h=xl(e,s).line;if(h){for(let c=s;c<=o;){let f=e.doc.lineAt(c);if(f.from>n&&(s==o||o>f.from)){n=f.from;let u=/^\s*/.exec(f.text)[0].length,d=u==f.length,p=f.text.slice(u,u+h.length)==h?u:-1;u<f.text.length&&u<l&&(l=u),i.push({line:f,comment:p,token:h,indent:u,empty:d,single:!1})}c=f.to+1}if(l<1e9)for(let c=a;c<i.length;c++)i[c].indent<i[c].line.text.length&&(i[c].indent=l);i.length==a+1&&(i[a].single=!0)}}if(r!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:h,empty:c,single:f}of i)(f||!c)&&s.push({from:a.from+h,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(r!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let h=o.from+a,c=h+l.length;o.text[c-o.from]==" "&&c++,s.push({from:h,to:c})}return{changes:s}}return null}function cn(r,e){return _.create(r.ranges.map(e),r.mainIndex)}function At(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Tt({state:r,dispatch:e},t){let i=cn(r.selection,t);return i.eq(r.selection,!0)?!1:(e(At(r,i)),!0)}function Fs(r,e){return _.cursor(e?r.to:r.from)}function Ld(r,e){return Tt(r,t=>t.empty?r.moveByChar(t,e):Fs(t,e))}function Qe(r){return r.textDirectionAt(r.state.selection.main.head)==ve.LTR}const Id=r=>Ld(r,!Qe(r)),Nd=r=>Ld(r,Qe(r));function Bd(r,e){return Tt(r,t=>t.empty?r.moveByGroup(t,e):Fs(t,e))}const xy=r=>Bd(r,!Qe(r)),ky=r=>Bd(r,Qe(r));function wy(r,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function $s(r,e,t){let i=De(r).resolveInner(e.head),n=t?U.closedBy:U.openedBy;for(let l=e.head;;){let h=t?i.childAfter(l):i.childBefore(l);if(!h)break;wy(r,h,n)?i=h:l=t?h.to:h.from}let s=i.type.prop(n),o,a;return s&&(o=t?Ft(r,i.from,1):Ft(r,i.to,-1))&&o.matched?a=t?o.end.to:o.end.from:a=t?i.to:i.from,_.cursor(a,t?-1:1)}const Sy=r=>Tt(r,e=>$s(r.state,e,!Qe(r))),Cy=r=>Tt(r,e=>$s(r.state,e,Qe(r)));function jd(r,e){return Tt(r,t=>{if(!t.empty)return Fs(t,e);let i=r.moveVertically(t,e);return i.head!=t.head?i:r.moveToLineBoundary(t,e)})}const Fd=r=>jd(r,!1),$d=r=>jd(r,!0);function zd(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,i=0,n;if(e){for(let s of r.state.facet(N.scrollMargins)){let o=s(r);o?.top&&(t=Math.max(o?.top,t)),o?.bottom&&(i=Math.max(o?.bottom,i))}n=r.scrollDOM.clientHeight-t-i}else n=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(r.defaultLineHeight,n-5)}}function Vd(r,e){let t=zd(r),{state:i}=r,n=cn(i.selection,o=>o.empty?r.moveVertically(o,e,t.height):Fs(o,e));if(n.eq(i.selection))return!1;let s;if(t.selfScroll){let o=r.coordsAtPos(i.selection.main.head),a=r.scrollDOM.getBoundingClientRect(),l=a.top+t.marginTop,h=a.bottom-t.marginBottom;o&&o.top>l&&o.bottom<h&&(s=N.scrollIntoView(n.main.head,{y:"start",yMargin:o.top-l}))}return r.dispatch(At(i,n),{effects:s}),!0}const yc=r=>Vd(r,!1),La=r=>Vd(r,!0);function yi(r,e,t){let i=r.lineBlockAt(e.head),n=r.moveToLineBoundary(e,t);if(n.head==e.head&&n.head!=(t?i.to:i.from)&&(n=r.moveToLineBoundary(e,t,!1)),!t&&n.head==i.from&&i.length){let s=/^\s*/.exec(r.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(n=_.cursor(i.from+s))}return n}const _y=r=>Tt(r,e=>yi(r,e,!0)),Ay=r=>Tt(r,e=>yi(r,e,!1)),Ty=r=>Tt(r,e=>yi(r,e,!Qe(r))),Ey=r=>Tt(r,e=>yi(r,e,Qe(r))),Oy=r=>Tt(r,e=>_.cursor(r.lineBlockAt(e.head).from,1)),My=r=>Tt(r,e=>_.cursor(r.lineBlockAt(e.head).to,-1));function Ry(r,e,t){let i=!1,n=cn(r.selection,s=>{let o=Ft(r,s.head,-1)||Ft(r,s.head,1)||s.head>0&&Ft(r,s.head-1,1)||s.head<r.doc.length&&Ft(r,s.head+1,-1);if(!o||!o.end)return s;i=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return _.cursor(a)});return i?(e(At(r,n)),!0):!1}const Dy=({state:r,dispatch:e})=>Ry(r,e);function kt(r,e){let t=cn(r.state.selection,i=>{let n=e(i);return _.range(i.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(At(r.state,t)),!0)}function Wd(r,e){return kt(r,t=>r.moveByChar(t,e))}const Hd=r=>Wd(r,!Qe(r)),qd=r=>Wd(r,Qe(r));function Gd(r,e){return kt(r,t=>r.moveByGroup(t,e))}const Py=r=>Gd(r,!Qe(r)),Ly=r=>Gd(r,Qe(r)),Iy=r=>kt(r,e=>$s(r.state,e,!Qe(r))),Ny=r=>kt(r,e=>$s(r.state,e,Qe(r)));function Ud(r,e){return kt(r,t=>r.moveVertically(t,e))}const Kd=r=>Ud(r,!1),Jd=r=>Ud(r,!0);function Yd(r,e){return kt(r,t=>r.moveVertically(t,e,zd(r).height))}const vc=r=>Yd(r,!1),xc=r=>Yd(r,!0),By=r=>kt(r,e=>yi(r,e,!0)),jy=r=>kt(r,e=>yi(r,e,!1)),Fy=r=>kt(r,e=>yi(r,e,!Qe(r))),$y=r=>kt(r,e=>yi(r,e,Qe(r))),zy=r=>kt(r,e=>_.cursor(r.lineBlockAt(e.head).from)),Vy=r=>kt(r,e=>_.cursor(r.lineBlockAt(e.head).to)),kc=({state:r,dispatch:e})=>(e(At(r,{anchor:0})),!0),wc=({state:r,dispatch:e})=>(e(At(r,{anchor:r.doc.length})),!0),Sc=({state:r,dispatch:e})=>(e(At(r,{anchor:r.selection.main.anchor,head:0})),!0),Cc=({state:r,dispatch:e})=>(e(At(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),Wy=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),Hy=({state:r,dispatch:e})=>{let t=zs(r).map(({from:i,to:n})=>_.range(i,Math.min(n+1,r.doc.length)));return e(r.update({selection:_.create(t),userEvent:"select"})),!0},qy=({state:r,dispatch:e})=>{let t=cn(r.selection,i=>{let n=De(r),s=n.resolveStack(i.from,1);if(i.empty){let o=n.resolveStack(i.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:a}=o;if((a.from<i.from&&a.to>=i.to||a.to>i.to&&a.from<=i.from)&&o.next)return _.range(a.to,a.from)}return i});return t.eq(r.selection)?!1:(e(At(r,t)),!0)};function Xd(r,e){let{state:t}=r,i=t.selection,n=t.selection.ranges.slice();for(let s of t.selection.ranges){let o=t.doc.lineAt(s.head);if(e?o.to<r.state.doc.length:o.from>0)for(let a=s;;){let l=r.moveVertically(a,e);if(l.head<o.from||l.head>o.to){n.some(h=>h.head==l.head)||n.push(l);break}else{if(l.head==a.head)break;a=l}}}return n.length==i.ranges.length?!1:(r.dispatch(At(t,_.create(n,n.length-1))),!0)}const Gy=r=>Xd(r,!1),Uy=r=>Xd(r,!0),Qd=({state:r,dispatch:e})=>{let t=r.selection,i=null;return t.ranges.length>1?i=_.create([t.main]):t.main.empty||(i=_.create([_.cursor(t.main.head)])),i?(e(At(r,i)),!0):!1};function fr(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:i}=r,n=i.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(t="delete.backward",l=jr(r,l,!1)):l>o&&(t="delete.forward",l=jr(r,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=jr(r,o,!1),a=jr(r,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:_.cursor(o,o<s.head?-1:1)}});return n.changes.empty?!1:(r.dispatch(i.update(n,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?N.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function jr(r,e,t){if(r instanceof N)for(let i of r.state.facet(N.atomicRanges).map(n=>n(r)))i.between(e,e,(n,s)=>{n<e&&s>e&&(e=t?s:n)});return e}const Zd=(r,e,t)=>fr(r,i=>{let n=i.from,{state:s}=r,o=s.doc.lineAt(n),a,l;if(t&&!e&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,n-o.from))){if(a[a.length-1]=="	")return n-1;let h=hn(a,s.tabSize),c=h%Ii(s)||Ii(s);for(let f=0;f<c&&a[a.length-1-f]==" ";f++)n--;l=n}else l=Me(o.text,n-o.from,e,e)+o.from,l==n&&o.number!=(e?s.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,n-o.from))&&(l=Me(o.text,l-o.from,!1,!1)+o.from);return l}),Ia=r=>Zd(r,!1,!0),ep=r=>Zd(r,!0,!1),tp=(r,e)=>fr(r,t=>{let i=t.head,{state:n}=r,s=n.doc.lineAt(i),o=n.charCategorizer(i);for(let a=null;;){if(i==(e?s.to:s.from)){i==t.head&&s.number!=(e?n.doc.lines:1)&&(i+=e?1:-1);break}let l=Me(s.text,i-s.from,e)+s.from,h=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),c=o(h);if(a!=null&&c!=a)break;(h!=" "||i!=t.head)&&(a=c),i=l}return i}),ip=r=>tp(r,!1),Ky=r=>tp(r,!0),Jy=r=>fr(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),Yy=r=>fr(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),Xy=r=>fr(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),Qy=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:fe.of(["",""])},range:_.cursor(i.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},Zy=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>{if(!i.empty||i.from==0||i.from==r.doc.length)return{range:i};let n=i.from,s=r.doc.lineAt(n),o=n==s.from?n-1:Me(s.text,n-s.from,!1)+s.from,a=n==s.to?n+1:Me(s.text,n-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:r.doc.slice(n,a).append(r.doc.slice(o,n))},range:_.cursor(a)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function zs(r){let e=[],t=-1;for(let i of r.selection.ranges){let n=r.doc.lineAt(i.from),s=r.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=r.doc.lineAt(i.to-1)),t>=n.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:n.from,to:s.to,ranges:[i]});t=s.number+1}return e}function np(r,e,t){if(r.readOnly)return!1;let i=[],n=[];for(let s of zs(r)){if(t?s.to==r.doc.length:s.from==0)continue;let o=r.doc.lineAt(t?s.to+1:s.from-1),a=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+r.lineBreak});for(let l of s.ranges)n.push(_.range(Math.min(r.doc.length,l.anchor+a),Math.min(r.doc.length,l.head+a)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:r.lineBreak+o.text});for(let l of s.ranges)n.push(_.range(l.anchor-a,l.head-a))}}return i.length?(e(r.update({changes:i,scrollIntoView:!0,selection:_.create(n,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ev=({state:r,dispatch:e})=>np(r,e,!1),tv=({state:r,dispatch:e})=>np(r,e,!0);function rp(r,e,t){if(r.readOnly)return!1;let i=[];for(let s of zs(r))t?i.push({from:s.from,insert:r.doc.slice(s.from,s.to)+r.lineBreak}):i.push({from:s.to,insert:r.lineBreak+r.doc.slice(s.from,s.to)});let n=r.changes(i);return e(r.update({changes:n,selection:r.selection.map(n,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const iv=({state:r,dispatch:e})=>rp(r,e,!1),nv=({state:r,dispatch:e})=>rp(r,e,!0),rv=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(zs(e).map(({from:n,to:s})=>(n>0?n--:s<e.doc.length&&s++,{from:n,to:s}))),i=cn(e.selection,n=>{let s;if(r.lineWrapping){let o=r.lineBlockAt(n.head),a=r.coordsAtPos(n.head,n.assoc||1);a&&(s=o.bottom+r.documentTop-a.bottom+r.defaultLineHeight/2)}return r.moveVertically(n,!0,s)}).map(t);return r.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function sv(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=De(r).resolveInner(e),i=t.childBefore(e),n=t.childAfter(e),s;return i&&n&&i.to<=e&&n.from>=e&&(s=i.type.prop(U.closedBy))&&s.indexOf(n.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(n.from).from&&!/\S/.test(r.sliceDoc(i.to,n.from))?{from:i.to,to:n.from}:null}const Na=op(!1),sp=op(!0);function op(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(n=>{let{from:s,to:o}=n,a=e.doc.lineAt(s),l=!r&&s==o&&sv(e,s);r&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let h=new js(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=dl(h,s);for(c==null&&(c=hn(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let f=["",Qn(e,c)];return l&&f.push(Qn(e,h.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:fe.of(f)},range:_.cursor(s+1+f[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function kl(r,e){let t=-1;return r.changeByRange(i=>{let n=[];for(let o=i.from;o<=i.to;){let a=r.doc.lineAt(o);a.number>t&&(i.empty||i.to>a.from)&&(e(a,n,i),t=a.number),o=a.to+1}let s=r.changes(n);return{changes:n,range:_.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const ov=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),i=new js(r,{overrideIndentation:s=>{let o=t[s];return o??-1}}),n=kl(r,(s,o,a)=>{let l=dl(i,s.from);if(l==null)return;/\S/.test(s.text)||(l=0);let h=/^\s*/.exec(s.text)[0],c=Qn(r,l);(h!=c||a.from<s.from+h.length)&&(t[s.from]=l,o.push({from:s.from,to:s.from+h.length,insert:c}))});return n.changes.empty||e(r.update(n,{userEvent:"indent"})),!0},gs=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(kl(r,(t,i)=>{i.push({from:t.from,insert:r.facet(ln)})}),{userEvent:"input.indent"})),!0),ap=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(kl(r,(t,i)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let s=hn(n,r.tabSize),o=0,a=Qn(r,Math.max(0,s-Ii(r)));for(;o<n.length&&o<a.length&&n.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+n.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),av=r=>(r.setTabFocusMode(),!0),lv=({state:r,dispatch:e})=>r.selection.ranges.some(t=>!t.empty)?gs({state:r,dispatch:e}):(e(r.update(r.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),hv=[{key:"Ctrl-b",run:Id,shift:Hd,preventDefault:!0},{key:"Ctrl-f",run:Nd,shift:qd},{key:"Ctrl-p",run:Fd,shift:Kd},{key:"Ctrl-n",run:$d,shift:Jd},{key:"Ctrl-a",run:Oy,shift:zy},{key:"Ctrl-e",run:My,shift:Vy},{key:"Ctrl-d",run:ep},{key:"Ctrl-h",run:Ia},{key:"Ctrl-k",run:Jy},{key:"Ctrl-Alt-h",run:ip},{key:"Ctrl-o",run:Qy},{key:"Ctrl-t",run:Zy},{key:"Ctrl-v",run:La}],cv=[{key:"ArrowLeft",run:Id,shift:Hd,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:xy,shift:Py,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ty,shift:Fy,preventDefault:!0},{key:"ArrowRight",run:Nd,shift:qd,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ky,shift:Ly,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Ey,shift:$y,preventDefault:!0},{key:"ArrowUp",run:Fd,shift:Kd,preventDefault:!0},{mac:"Cmd-ArrowUp",run:kc,shift:Sc},{mac:"Ctrl-ArrowUp",run:yc,shift:vc},{key:"ArrowDown",run:$d,shift:Jd,preventDefault:!0},{mac:"Cmd-ArrowDown",run:wc,shift:Cc},{mac:"Ctrl-ArrowDown",run:La,shift:xc},{key:"PageUp",run:yc,shift:vc},{key:"PageDown",run:La,shift:xc},{key:"Home",run:Ay,shift:jy,preventDefault:!0},{key:"Mod-Home",run:kc,shift:Sc},{key:"End",run:_y,shift:By,preventDefault:!0},{key:"Mod-End",run:wc,shift:Cc},{key:"Enter",run:Na,shift:Na},{key:"Mod-a",run:Wy},{key:"Backspace",run:Ia,shift:Ia,preventDefault:!0},{key:"Delete",run:ep,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ip,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:Ky,preventDefault:!0},{mac:"Mod-Backspace",run:Yy,preventDefault:!0},{mac:"Mod-Delete",run:Xy,preventDefault:!0}].concat(hv.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),fv=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Sy,shift:Iy},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Cy,shift:Ny},{key:"Alt-ArrowUp",run:ev},{key:"Shift-Alt-ArrowUp",run:iv},{key:"Alt-ArrowDown",run:tv},{key:"Shift-Alt-ArrowDown",run:nv},{key:"Mod-Alt-ArrowUp",run:Gy},{key:"Mod-Alt-ArrowDown",run:Uy},{key:"Escape",run:Qd},{key:"Mod-Enter",run:sp},{key:"Alt-l",mac:"Ctrl-l",run:Hy},{key:"Mod-i",run:qy,preventDefault:!0},{key:"Mod-[",run:ap},{key:"Mod-]",run:gs},{key:"Mod-Alt-\\",run:ov},{key:"Shift-Mod-k",run:rv},{key:"Shift-Mod-\\",run:Dy},{key:"Mod-/",run:dy},{key:"Alt-A",run:my},{key:"Ctrl-m",mac:"Shift-Alt-m",run:av}].concat(cv),_c="[data-jp-code-runner]",uv='[data-jp-interaction-mode="terminal"]',dv=".jp-CodeMirrorEditor:not(.jp-mod-has-primary-selection):not(.jp-mod-in-leading-whitespace):not(.jp-mod-completer-active)",pv=".jp-mod-editMode .jp-Cell.jp-mod-active";var _i;(function(r){function e(a){var l;let h=(l=a.dom.parentElement)===null||l===void 0?void 0:l.classList,c=h?.contains(Jm),f=h?.contains(Xm);if(c&&!f)return!1;const u={state:a.state,dispatch:a.dispatch},d=a.state.selection.main.from,p=a.state.selection.main.to;if(d!=p)return gs(u);const m=a.state.doc.lineAt(d),g=a.state.doc.slice(m.from,d).toString();return/^\s*$/.test(g)?gs(u):lv(u)}r.indentMoreOrInsertTab=e;function t(a){var l;if(!((l=a.dom.parentElement)===null||l===void 0)&&l.classList.contains(Ym)||a.dom.closest(uv))return!1;const h={state:a.state,dispatch:a.dispatch};return Na(h)}r.completerOrInsertNewLine=t;function i(a){return!!a.dom.closest(_c)}r.preventNewLineOnRun=i;function n(a){if(a.dom.closest(_c))return!1;{const l={state:a.state,dispatch:a.dispatch};return sp(l)}}r.insertBlankLineOnRun=n;function s(a){const l={state:a.state,dispatch:a.dispatch},h=Qd(l);return a.dom.closest(pv)?!1:h}r.simplifySelectionAndMaybeSwitchToCommandMode=s;function o(a){return a.dom.closest(dv)?!1:ap(a)}r.dedentIfNotLaunchingTooltip=o})(_i||(_i={}));class z2{constructor(e,t,i,n){this.state=e,this.pos=t,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=De(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),n=t.text.slice(i-t.from,this.pos-t.from),s=n.search(gv(e));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function Ac(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function mv(r){let e=Object.create(null),t=Object.create(null);for(let{label:n}of r){e[n[0]]=!0;for(let s=1;s<n.length;s++)t[n[s]]=!0}let i=Ac(e)+Ac(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function V2(r){let e=r.map(n=>typeof n=="string"?{label:n}:n),[t,i]=e.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:mv(e);return n=>{let s=n.matchBefore(i);return s||n.explicit?{from:s?s.from:n.pos,options:e,validFor:t}:null}}function W2(r,e){return t=>{for(let i=De(t.state).resolveInner(t.pos,-1);i;i=i.parent){if(r.indexOf(i.name)>-1)return null;if(i.type.isTop)break}return e(t)}}function gv(r,e){var t;let{source:i}=r,n=i[i.length-1]!="$";return n?new RegExp(`(?:${i})${n?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":""):r}const bv=bi.define(),yv=N.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class vv{constructor(e,t,i,n){this.field=e,this.line=t,this.from=i,this.to=n}}class wl{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,Je.TrackDel),i=e.mapPos(this.to,1,Je.TrackDel);return t==null||i==null?null:new wl(this.field,t,i)}}class Sl{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],n=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let l of this.lines){if(i.length){let h=o,c=/^\t*/.exec(l)[0].length;for(let f=0;f<c;f++)h+=e.facet(ln);n.push(t+h.length-c),l=h+l.slice(c)}i.push(l),t+=l.length+1}let a=this.fieldPositions.map(l=>new wl(l.field,n[l.line]+l.from,n[l.line]+l.to));return{text:i,ranges:a}}static parse(e){let t=[],i=[],n=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let a=s[1]?+s[1]:null,l=s[2]||s[3]||"",h=-1,c=l.replace(/\\[{}]/g,f=>f[1]);for(let f=0;f<t.length;f++)(a!=null?t[f].seq==a:c&&t[f].name==c)&&(h=f);if(h<0){let f=0;for(;f<t.length&&(a==null||t[f].seq!=null&&t[f].seq<a);)f++;t.splice(f,0,{seq:a,name:c}),h=f;for(let u of n)u.field>=h&&u.field++}for(let f of n)if(f.line==i.length&&f.from>s.index){let u=s[2]?3+(s[1]||"").length:2;f.from-=u,f.to-=u}n.push(new vv(h,i.length,s.index,s.index+c.length)),o=o.slice(0,s.index)+l+o.slice(s.index+s[0].length)}o=o.replace(/\\([{}])/g,(a,l,h)=>{for(let c of n)c.line==i.length&&c.from>h&&(c.from--,c.to--);return l}),i.push(o)}return new Sl(i,n)}}let xv=J.widget({widget:new class extends Xt{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),kv=J.mark({class:"cm-snippetField"});class fn{constructor(e,t){this.ranges=e,this.active=t,this.deco=J.set(e.map(i=>(i.from==i.to?xv:kv).range(i.from,i.to)),!0)}map(e){let t=[];for(let i of this.ranges){let n=i.map(e);if(!n)return null;t.push(n)}return new fn(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const ur=de.define({map(r,e){return r&&r.map(e)}}),wv=de.define(),er=ft.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(ur))return t.value;if(t.is(wv)&&r)return new fn(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>N.decorations.from(r,e=>e?e.deco:J.none)});function Cl(r,e){return _.create(r.filter(t=>t.field==e).map(t=>_.range(t.from,t.to)))}function Sv(r){let e=Sl.parse(r);return(t,i,n,s)=>{let{text:o,ranges:a}=e.instantiate(t.state,n),{main:l}=t.state.selection,h={changes:{from:n,to:s==l.from?l.to:s,insert:fe.of(o)},scrollIntoView:!0,annotations:i?[bv.of(i),ze.userEvent.of("input.complete")]:void 0};if(a.length&&(h.selection=Cl(a,0)),a.some(c=>c.field>0)){let c=new fn(a,0),f=h.effects=[ur.of(c)];t.state.field(er,!1)===void 0&&f.push(de.appendConfig.of([er,Ev,Ov,yv]))}t.dispatch(t.state.update(h))}}function lp(r){return({state:e,dispatch:t})=>{let i=e.field(er,!1);if(!i||r<0&&i.active==0)return!1;let n=i.active+r,s=r>0&&!i.ranges.some(o=>o.field==n+r);return t(e.update({selection:Cl(i.ranges,n),effects:ur.of(s?null:new fn(i.ranges,n)),scrollIntoView:!0})),!0}}const Cv=({state:r,dispatch:e})=>r.field(er,!1)?(e(r.update({effects:ur.of(null)})),!0):!1,_v=lp(1),Av=lp(-1),Tv=[{key:"Tab",run:_v,shift:Av},{key:"Escape",run:Cv}],Tc=I.define({combine(r){return r.length?r[0]:Tv}}),Ev=Bi.highest(Hi.compute([Tc],r=>r.facet(Tc)));function H2(r,e){return{...e,apply:Sv(r)}}const Ov=N.domEventHandlers({mousedown(r,e){let t=e.state.field(er,!1),i;if(!t||(i=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let n=t.ranges.find(s=>s.from<=i&&s.to>=i);return!n||n.field==t.active?!1:(e.dispatch({selection:Cl(t.ranges,n.field),effects:ur.of(t.ranges.some(s=>s.field>n.field)?new fn(t.ranges,n.field):null),scrollIntoView:!0}),!0)}}),tr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Mi=de.define({map(r,e){let t=e.mapPos(r,-1,Je.TrackAfter);return t??void 0}}),_l=new class extends ai{};_l.startSide=1;_l.endSide=-1;const hp=ft.define({create(){return se.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(Mi)&&(r=r.update({add:[_l.range(t.value,t.value+1)]}));return r}});function Mv(){return[Dv,hp]}const vo="()[]{}<>";function cp(r){for(let e=0;e<vo.length;e+=2)if(vo.charCodeAt(e)==r)return vo.charAt(e+1);return Vf(r<128?r:r+1)}function fp(r,e){return r.languageDataAt("closeBrackets",e)[0]||tr}const Rv=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Dv=N.inputHandler.of((r,e,t,i)=>{if((Rv?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(i.length>2||i.length==2&&rr(gi(i,0))==1||e!=n.from||t!=n.to)return!1;let s=Iv(r.state,i);return s?(r.dispatch(s),!0):!1}),Pv=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=fp(r,r.selection.main.head).brackets||tr.brackets,n=null,s=r.changeByRange(o=>{if(o.empty){let a=Nv(r.doc,o.head);for(let l of i)if(l==a&&Vs(r.doc,o.head)==cp(gi(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:_.cursor(o.head-l.length)}}return{range:n=o}});return n||e(r.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},Lv=[{key:"Backspace",run:Pv}];function Iv(r,e){let t=fp(r,r.selection.main.head),i=t.brackets||tr.brackets;for(let n of i){let s=cp(gi(n,0));if(e==n)return s==n?Fv(r,n,i.indexOf(n+n+n)>-1,t):Bv(r,n,s,t.before||tr.before);if(e==s&&up(r,r.selection.main.from))return jv(r,n,s)}return null}function up(r,e){let t=!1;return r.field(hp).between(0,r.doc.length,i=>{i==e&&(t=!0)}),t}function Vs(r,e){let t=r.sliceString(e,e+2);return t.slice(0,rr(gi(t,0)))}function Nv(r,e){let t=r.sliceString(e-2,e);return rr(gi(t,0))==t.length?t:t.slice(1)}function Bv(r,e,t,i){let n=null,s=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Mi.of(o.to+e.length),range:_.range(o.anchor+e.length,o.head+e.length)};let a=Vs(r.doc,o.head);return!a||/\s/.test(a)||i.indexOf(a)>-1?{changes:{insert:e+t,from:o.head},effects:Mi.of(o.head+e.length),range:_.cursor(o.head+e.length)}:{range:n=o}});return n?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function jv(r,e,t){let i=null,n=r.changeByRange(s=>s.empty&&Vs(r.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:_.cursor(s.head+t.length)}:i={range:s});return i?null:r.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function Fv(r,e,t,i){let n=i.stringPrefixes||tr.stringPrefixes,s=null,o=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:Mi.of(a.to+e.length),range:_.range(a.anchor+e.length,a.head+e.length)};let l=a.head,h=Vs(r.doc,l),c;if(h==e){if(Ec(r,l))return{changes:{insert:e+e,from:l},effects:Mi.of(l+e.length),range:_.cursor(l+e.length)};if(up(r,l)){let u=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+u.length,insert:u},range:_.cursor(l+u.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(c=Oc(r,l-2*e.length,n))>-1&&Ec(r,c))return{changes:{insert:e+e+e+e,from:l},effects:Mi.of(l+e.length),range:_.cursor(l+e.length)};if(r.charCategorizer(l)(h)!=Ee.Word&&Oc(r,l,n)>-1&&!$v(r,l,e,n))return{changes:{insert:e+e,from:l},effects:Mi.of(l+e.length),range:_.cursor(l+e.length)}}return{range:s=a}});return s?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Ec(r,e){let t=De(r).resolveInner(e+1);return t.parent&&t.from==e}function $v(r,e,t,i){let n=De(r).resolveInner(e,-1),s=i.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=r.sliceDoc(n.from,Math.min(n.to,n.from+t.length+s)),l=a.indexOf(t);if(!l||l>-1&&i.indexOf(a.slice(0,l))>-1){let c=n.firstChild;for(;c&&c.from==n.from&&c.to-c.from>t.length+l;){if(r.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let h=n.to==e&&n.parent;if(!h)break;n=h}return!1}function Oc(r,e,t){let i=r.charCategorizer(e);if(i(r.sliceDoc(e-1,e))!=Ee.Word)return e;for(let n of t){let s=e-n.length;if(r.sliceDoc(s,e)==n&&i(r.sliceDoc(s-1,s))!=Ee.Word)return s}return-1}const dp=I.define({combine(r){return ji(r,{fontFamily:null,fontSize:null,lineHeight:null},{fontFamily:(e,t)=>e??t,fontSize:(e,t)=>e??t,lineHeight:(e,t)=>e??t})}});function zv(r){const{fontFamily:e,fontSize:t,lineHeight:i}=r.state.facet(dp);let n="";return t&&(n+=`font-size: ${t}px !important;`),e&&(n+=`font-family: ${e} !important;`),i&&(n+=`line-height: ${i.toString()} !important`),{style:n}}function Vv(r){return[dp.of(r),N.editorAttributes.of(zv)]}const Wv="InlineMathDollar",Hv="InlineMathBracket",qv="BlockMathDollar",Gv="BlockMathBracket",Uv={[Wv]:1,[Hv]:3,[qv]:2,[Gv]:3};Object.keys(Uv).reduce((r,e)=>(r[e]={mark:`${e}Mark`,resolve:e},r),{});const pp="cm-rulers",Kv=N.baseTheme({[`.${pp}`]:{borderRight:"1px dotted gray",opacity:.7}}),Qr=I.define({combine(r){return r.reduce((t,i)=>t.concat(i.filter((n,s)=>!t.includes(n)&&s==i.lastIndexOf(n))),[])}}),Jv=Ce.fromClass(class{constructor(r){var e,t;this.rulersContainer=r.dom.appendChild(document.createElement("div")),this.rulersContainer.style.cssText=`
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                overflow: hidden;
            `;const i=r.defaultCharacterWidth,n=r.state.facet(Qr),s=(t=(e=r.scrollDOM.querySelector(".cm-gutters"))===null||e===void 0?void 0:e.clientWidth)!==null&&t!==void 0?t:0;this.rulers=n.map(o=>{const a=this.rulersContainer.appendChild(document.createElement("div"));return a.classList.add(pp),a.style.cssText=`
                position: absolute;
                left: ${s+o*i}px;
                height: 100%;
            `,a.style.width="6px",a})}update(r){var e,t;const i=r.view.state.facet(Qr);if(r.viewportChanged||r.geometryChanged||!$n.deepEqual(i,r.startState.facet(Qr))){const n=(t=(e=r.view.scrollDOM.querySelector(".cm-gutters"))===null||e===void 0?void 0:e.clientWidth)!==null&&t!==void 0?t:0,s=r.view.defaultCharacterWidth;this.rulers.forEach((o,a)=>{o.style.left=`${n+i[a]*s}px`})}}destroy(){this.rulers.forEach(r=>{r.remove()}),this.rulersContainer.remove()}});function Yv(r){return[Kv,Qr.of(r),Jv]}const Xv=I.define({combine(r){return r[r.length-1]}});class Qv{constructor(e){this._onStackItemAdded=({stackItem:t,changedParentTypes:i})=>{i.has(this._syncConf.ytext)&&this._beforeChangeSelection&&!t.meta.has(this)&&t.meta.set(this,this._beforeChangeSelection)},this._onStackItemPopped=({stackItem:t})=>{const i=t.meta.get(this);if(i){const n=this._syncConf.fromYRange(i);this._view.dispatch(this._view.state.update({selection:n,effects:[N.scrollIntoView(n)]})),this._storeSelection()}},this._storeSelection=()=>{this._beforeChangeSelection=this._syncConf.toYRange(this._view.state.selection.main)},this._view=e,this._conf=e.state.facet(Xv),this._undoManager=this._conf.undoManager,this._syncConf=e.state.facet(mp),this._beforeChangeSelection=null,this._undoManager.on("stack-item-added",this._onStackItemAdded),this._undoManager.on("stack-item-popped",this._onStackItemPopped),this._undoManager.addTrackedOrigin(this._syncConf)}update(e){e.selectionSet&&(e.transactions.length===0||e.transactions[0].annotation(Ba)!==this._syncConf)&&this._storeSelection()}destroy(){this._undoManager.off("stack-item-added",this._onStackItemAdded),this._undoManager.off("stack-item-popped",this._onStackItemPopped),this._undoManager.removeTrackedOrigin(this._syncConf)}}Ce.fromClass(Qv);const mp=I.define({combine(r){return r[r.length-1]}}),Ba=bi.define();Ce.fromClass(class{constructor(r){this.conf=r.state.facet(mp),this._observer=(e,t)=>{var i;if(t.origin!==this.conf){const n=e.delta,s=[];let o=0;for(let a=0;a<n.length;a++){const l=n[a];l.insert!=null?s.push({from:o,to:o,insert:l.insert}):l.delete!=null?(s.push({from:o,to:o+l.delete,insert:""}),o+=l.delete):o+=(i=l.retain)!==null&&i!==void 0?i:0}r.dispatch({changes:s,annotations:[Ba.of(this.conf)]})}},this._ytext=this.conf.ytext,this._ytext.observe(this._observer)}update(r){if(!r.docChanged||r.transactions.length>0&&r.transactions[0].annotation(Ba)===this.conf)return;const e=this.conf.ytext;e.doc.transact(()=>{let t=0;r.changes.iterChanges((i,n,s,o,a)=>{const l=a.sliceString(0,a.length,`
`);i!==n&&e.delete(i+t,n-i),l.length>0&&e.insert(i+t,l),t+=l.length-(n-i)})},this.conf)}destroy(){this._ytext.unobserve(this._observer)}});const Mc=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class Al{constructor(e,t,i=0,n=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,n),this.bufferStart=i,this.normalize=s?a=>s(Mc(a)):Mc,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return gi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Vf(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=rr(e);let n=this.normalize(t);if(n.length)for(let s=0,o=i;;s++){let a=n.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==n.length-1){if(l)return this.value=l,this;break}o==i&&s<t.length&&t.charCodeAt(s)==a&&o++}}}match(e,t,i){let n=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?n={from:this.matches[s+1],to:i}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?n={from:t,to:i}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}typeof Symbol<"u"&&(Al.prototype[Symbol.iterator]=function(){return this});const gp={from:-1,to:-1,match:/.*/.exec("")},Tl="gm"+(/x/.unicode==null?"":"u");class bp{constructor(e,t,i,n=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=gp,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new yp(e,t,i,n,s);this.re=new RegExp(t,Tl+(i?.ignoreCase?"i":"")),this.test=i?.test,this.iter=e.iter();let o=e.lineAt(n);this.curLineStart=o.from,this.matchPos=bs(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,n=i+t[0].length;if(this.matchPos=bs(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const xo=new WeakMap;class Yi{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let n=xo.get(e);if(!n||n.from>=i||n.to<=t){let a=new Yi(t,e.sliceString(t,i));return xo.set(e,a),a}if(n.from==t&&n.to==i)return n;let{text:s,from:o}=n;return o>t&&(s=e.sliceString(t,o)+s,o=t),n.to<i&&(s+=e.sliceString(n.to,i)),xo.set(e,new Yi(o,s)),new Yi(t,s.slice(t-o,i-o))}}class yp{constructor(e,t,i,n,s){this.text=e,this.to=s,this.done=!1,this.value=gp,this.matchPos=bs(e,n),this.re=new RegExp(t,Tl+(i?.ignoreCase?"i":"")),this.test=i?.test,this.flat=Yi.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,n=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,n,t)))return this.value={from:i,to:n,match:t},this.matchPos=bs(this.text,n+(i==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Yi.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(bp.prototype[Symbol.iterator]=yp.prototype[Symbol.iterator]=function(){return this});function Zv(r){try{return new RegExp(r,Tl),!0}catch{return!1}}function bs(r,e){if(e>=r.length)return e;let t=r.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}const un=I.define({combine(r){return ji(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new cx(e),scrollToMatch:e=>N.scrollIntoView(e)})}});class vp{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Zv(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new nx(this):new tx(this)}getCursor(e,t=0,i){let n=e.doc?e:ie.create({doc:e});return i==null&&(i=n.doc.length),this.regexp?Vi(this,n,t,i):zi(this,n,t,i)}}class xp{constructor(e){this.spec=e}}function zi(r,e,t,i){return new Al(e.doc,r.unquoted,t,i,r.caseSensitive?void 0:n=>n.toLowerCase(),r.wholeWord?ex(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function ex(r,e){return(t,i,n,s)=>((s>t||s+n.length<i)&&(s=Math.max(0,t-2),n=r.sliceString(s,Math.min(r.length,i+2))),(e(ys(n,t-s))!=Ee.Word||e(vs(n,t-s))!=Ee.Word)&&(e(vs(n,i-s))!=Ee.Word||e(ys(n,i-s))!=Ee.Word))}class tx extends xp{constructor(e){super(e)}nextMatch(e,t,i){let n=zi(this.spec,e,i,e.doc.length).nextOverlapping();if(n.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);n=zi(this.spec,e,0,s).nextOverlapping()}return n.done||n.value.from==t&&n.value.to==i?null:n.value}prevMatchInRange(e,t,i){for(let n=i;;){let s=Math.max(t,n-1e4-this.spec.unquoted.length),o=zi(this.spec,e,s,n),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==t)return null;n-=1e4}}prevMatch(e,t,i){let n=this.prevMatchInRange(e,0,t);return n||(n=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),n&&(n.from!=t||n.to!=i)?n:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=zi(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=zi(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}function Vi(r,e,t,i){return new bp(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?ix(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function ys(r,e){return r.slice(Me(r,e,!1),e)}function vs(r,e){return r.slice(e,Me(r,e))}function ix(r){return(e,t,i)=>!i[0].length||(r(ys(i.input,i.index))!=Ee.Word||r(vs(i.input,i.index))!=Ee.Word)&&(r(vs(i.input,i.index+i[0].length))!=Ee.Word||r(ys(i.input,i.index+i[0].length))!=Ee.Word)}class nx extends xp{nextMatch(e,t,i){let n=Vi(this.spec,e,i,e.doc.length).next();return n.done&&(n=Vi(this.spec,e,0,t).next()),n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=1;;n++){let s=Math.max(t,i-n*1e4),o=Vi(this.spec,e,s,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==t||a.from>s+10))return a;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let n=i.length;n>0;n--){let s=+i.slice(0,n);if(s>0&&s<e.match.length)return e.match[s]+i.slice(n)}return t})}matchAll(e,t){let i=Vi(this.spec,e,0,e.doc.length),n=[];for(;!i.next().done;){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Vi(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}const ir=de.define(),El=de.define(),si=ft.define({create(r){return new ko(ja(r).create(),null)},update(r,e){for(let t of e.effects)t.is(ir)?r=new ko(t.value.create(),r.panel):t.is(El)&&(r=new ko(r.query,t.value?Ol:null));return r},provide:r=>_a.from(r,e=>e.panel)});class ko{constructor(e,t){this.query=e,this.panel=t}}const rx=J.mark({class:"cm-searchMatch"}),sx=J.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ox=Ce.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(si))}update(r){let e=r.state.field(si);(e!=r.startState.field(si)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return J.none;let{view:t}=this,i=new Kt;for(let n=0,s=t.visibleRanges,o=s.length;n<o;n++){let{from:a,to:l}=s[n];for(;n<o-1&&l>s[n+1].from-500;)l=s[++n].to;r.highlight(t.state,a,l,(h,c)=>{let f=t.state.selection.ranges.some(u=>u.from==h&&u.to==c);i.add(h,c,f?sx:rx)})}return i.finish()}},{decorations:r=>r.decorations});function dr(r){return e=>{let t=e.state.field(si,!1);return t&&t.query.spec.valid?r(e,t):Sp(e)}}const xs=dr((r,{query:e})=>{let{to:t}=r.state.selection.main,i=e.nextMatch(r.state,t,t);if(!i)return!1;let n=_.single(i.from,i.to),s=r.state.facet(un);return r.dispatch({selection:n,effects:[Ml(r,i),s.scrollToMatch(n.main,r)],userEvent:"select.search"}),wp(r),!0}),ks=dr((r,{query:e})=>{let{state:t}=r,{from:i}=t.selection.main,n=e.prevMatch(t,i,i);if(!n)return!1;let s=_.single(n.from,n.to),o=r.state.facet(un);return r.dispatch({selection:s,effects:[Ml(r,n),o.scrollToMatch(s.main,r)],userEvent:"select.search"}),wp(r),!0}),ax=dr((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:_.create(t.map(i=>_.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),lx=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:n}=t.main,s=[],o=0;for(let a=new Al(r.doc,r.sliceDoc(i,n));!a.next().done;){if(s.length>1e3)return!1;a.value.from==i&&(o=s.length),s.push(_.range(a.value.from,a.value.to))}return e(r.update({selection:_.create(s,o),userEvent:"select.search.matches"})),!0},Rc=dr((r,{query:e})=>{let{state:t}=r,{from:i,to:n}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,i,i);if(!s)return!1;let o=s,a=[],l,h,c=[];o.from==i&&o.to==n&&(h=t.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:h}),o=e.nextMatch(t,o.from,o.to),c.push(N.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let f=r.state.changes(a);return o&&(l=_.single(o.from,o.to).map(f),c.push(Ml(r,o)),c.push(t.facet(un).scrollToMatch(l.main,r))),r.dispatch({changes:f,selection:l,effects:c,userEvent:"input.replace"}),!0}),hx=dr((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(n=>{let{from:s,to:o}=n;return{from:s,to:o,insert:e.getReplacement(n)}});if(!t.length)return!1;let i=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:N.announce.of(i),userEvent:"input.replace.all"}),!0});function Ol(r){return r.state.facet(un).createPanel(r)}function ja(r,e){var t,i,n,s,o;let a=r.selection.main,l=a.empty||a.to>a.from+100?"":r.sliceDoc(a.from,a.to);if(e&&!l)return e;let h=r.facet(un);return new vp({search:((t=e?.literal)!==null&&t!==void 0?t:h.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e?.caseSensitive)!==null&&i!==void 0?i:h.caseSensitive,literal:(n=e?.literal)!==null&&n!==void 0?n:h.literal,regexp:(s=e?.regexp)!==null&&s!==void 0?s:h.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:h.wholeWord})}function kp(r){let e=id(r,Ol);return e&&e.dom.querySelector("[main-field]")}function wp(r){let e=kp(r);e&&e==r.root.activeElement&&e.select()}const Sp=r=>{let e=r.state.field(si,!1);if(e&&e.panel){let t=kp(r);if(t&&t!=r.root.activeElement){let i=ja(r.state,e.query.spec);i.valid&&r.dispatch({effects:ir.of(i)}),t.focus(),t.select()}}else r.dispatch({effects:[El.of(!0),e?ir.of(ja(r.state,e.query.spec)):de.appendConfig.of(ux)]});return!0},Cp=r=>{let e=r.state.field(si,!1);if(!e||!e.panel)return!1;let t=id(r,Ol);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:El.of(!1)}),!0};class cx{constructor(e){this.view=e;let t=this.query=e.state.field(si).query.spec;this.commit=this.commit.bind(this),this.searchField=ut("input",{value:t.search,placeholder:ot(e,"Find"),"aria-label":ot(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ut("input",{value:t.replace,placeholder:ot(e,"Replace"),"aria-label":ot(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ut("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=ut("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=ut("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(n,s,o){return ut("button",{class:"cm-button",name:n,onclick:s,type:"button"},o)}this.dom=ut("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,i("next",()=>xs(e),[ot(e,"next")]),i("prev",()=>ks(e),[ot(e,"previous")]),i("select",()=>ax(e),[ot(e,"all")]),ut("label",null,[this.caseField,ot(e,"match case")]),ut("label",null,[this.reField,ot(e,"regexp")]),ut("label",null,[this.wordField,ot(e,"by word")]),...e.state.readOnly?[]:[ut("br"),this.replaceField,i("replace",()=>Rc(e),[ot(e,"replace")]),i("replaceAll",()=>hx(e),[ot(e,"replace all")])],ut("button",{name:"close",onclick:()=>Cp(e),"aria-label":ot(e,"close"),type:"button"},[""])])}commit(){let e=new vp({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:ir.of(e)}))}keydown(e){rb(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ks:xs)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Rc(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(ir)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(un).top}}function ot(r,e){return r.state.phrase(e)}const Fr=30,$r=/[\s\.,:;?!]/;function Ml(r,{from:e,to:t}){let i=r.state.doc.lineAt(e),n=r.state.doc.lineAt(t).to,s=Math.max(i.from,e-Fr),o=Math.min(n,t+Fr),a=r.state.sliceDoc(s,o);if(s!=i.from){for(let l=0;l<Fr;l++)if(!$r.test(a[l+1])&&$r.test(a[l])){a=a.slice(l);break}}if(o!=n){for(let l=a.length-1;l>a.length-Fr;l--)if(!$r.test(a[l-1])&&$r.test(a[l])){a=a.slice(0,l);break}}return N.announce.of(`${r.state.phrase("current match")}. ${a} ${r.state.phrase("on line")} ${i.number}.`)}const fx=N.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ux=[si,Bi.low(ox),fx],dx="jp-mod-readOnly";class px{constructor({baseConfiguration:e,config:t,defaultExtensions:i}={}){this._configChanged=new zr(this),this._disposed=new zr(this),this._isDisposed=!1,this._immutables=new Set,this._baseConfig=e??{},this._config=t??{},this._configurableBuilderMap=new Map(i);const n=Object.keys(this._config).concat(Object.keys(this._baseConfig));this._immutables=new Set([...this._configurableBuilderMap.keys()].filter(s=>!n.includes(s)))}get configChanged(){return this._configChanged}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),zr.clearData(this))}getOption(e){var t;return(t=this._config[e])!==null&&t!==void 0?t:this._baseConfig[e]}hasOption(e){return Object.keys(this._config).includes(e)||Object.keys(this._baseConfig).includes(e)}setOption(e,t){this._config[e]!==t&&(this._config[e]=t,this._configChanged.emit({[e]:t}))}setBaseOptions(e){const t=this._getChangedOptions(e,this._baseConfig);if(t.length>0){this._baseConfig=e;const i=Object.keys(this._config),n=t.filter(s=>!i.includes(s));n.length>0&&this._configChanged.emit(n.reduce((s,o)=>(s[o]=this._baseConfig[o],s),{}))}for(const i of Object.keys(e))i in this._config&&this._config[i]!=e[i]&&this.setOption(i,e[i])}setOptions(e){const t=this._getChangedOptions(e,this._config);t.length>0&&(this._config={...e},this._configChanged.emit(t.reduce((i,n)=>{var s;return i[n]=(s=this._config[n])!==null&&s!==void 0?s:this._baseConfig[n],i},{})))}reconfigureExtension(e,t,i){const n=this.getEffect(e.state,t,i);n&&e.dispatch({effects:[n]})}reconfigureExtensions(e,t){const i=Object.keys(t).filter(n=>this.has(n)).map(n=>this.getEffect(e.state,n,t[n]));e.dispatch({effects:i.filter(n=>n!==null)})}injectExtension(e,t){e.dispatch({effects:de.appendConfig.of(t)})}getInitialExtensions(){const e={...this._baseConfig,...this._config},t=[...this._immutables].map(i=>{var n;return(n=this.get(i))===null||n===void 0?void 0:n.instance(void 0)}).filter(i=>i);for(const i of Object.keys(e)){const n=this.get(i);if(n){const s=e[i];t.push(n.instance(s))}}return t}get(e){return this._configurableBuilderMap.get(e)}has(e){return this._configurableBuilderMap.has(e)}getEffect(e,t,i){var n;const s=this.get(t);return(n=s?.reconfigure(i))!==null&&n!==void 0?n:null}_getChangedOptions(e,t){const i=new Array,n=new Array;for(const[s,o]of Object.entries(e))n.push(s),t[s]!==o&&i.push(s);return i.push(...Object.keys(t).filter(s=>!n.includes(s))),i}}class Dc{constructor(){this.configurationBuilder=new Map,this.configurationSchema={},this.defaultOptions={},this.handlers=new Set,this.immutableExtensions=new Set,this._baseConfiguration={}}get baseConfiguration(){return{...this.defaultOptions,...this._baseConfiguration}}set baseConfiguration(e){if(!$n.deepEqual(e,this._baseConfiguration)){this._baseConfiguration=e;for(const t of this.handlers)t.setBaseOptions(this.baseConfiguration)}}get defaultConfiguration(){return Object.freeze({...this.defaultOptions})}get settingsSchema(){return Object.freeze($n.deepCopy(this.configurationSchema))}addExtension(e){var t;if(this.configurationBuilder.has(e.name))throw new Error(`Extension named ${e.name} is already registered.`);this.configurationBuilder.set(e.name,e),typeof e.default<"u"&&(this.defaultOptions[e.name]=e.default),e.schema&&(this.configurationSchema[e.name]={default:(t=e.default)!==null&&t!==void 0?t:null,...e.schema},this.defaultOptions[e.name]=this.configurationSchema[e.name].default)}createNew(e){const t=new Array;for(const[n,s]of this.configurationBuilder.entries()){const o=s.factory(e);o&&t.push([n,o])}const i=new px({baseConfiguration:this.baseConfiguration,config:e.config,defaultExtensions:t});return this.handlers.add(i),i.disposed.connect(()=>{this.handlers.delete(i)}),i}}(function(r){class e{constructor(l){this._compartment=new sr,this._builder=l}instance(l){return this._compartment.of(this._builder(l))}reconfigure(l){return this._compartment.reconfigure(this._builder(l))}}class t{constructor(l){this._extension=l}instance(){return this._extension}reconfigure(){return null}}function i(a){return new e(a)}r.createConfigurableExtension=i;function n(a,l=[]){return new e(h=>h?a:l)}r.createConditionalExtension=n;function s(a){return new t(a)}r.createImmutableExtension=s;function o(a={}){const{themes:l,translator:h}=a,c=(h??Os).load("jupyterlab"),f=[Object.freeze({name:"autoClosingBrackets",default:!1,factory:()=>n(Mv()),schema:{type:"boolean",title:c.__("Auto Closing Brackets")}}),Object.freeze({name:"codeFolding",default:!1,factory:()=>n(H1()),schema:{type:"boolean",title:c.__("Code Folding")}}),Object.freeze({name:"cursorBlinkRate",default:1200,factory:()=>i(u=>cb({cursorBlinkRate:u})),schema:{type:"number",title:c.__("Cursor blinking rate"),description:c.__("Half-period in milliseconds used for cursor blinking. The default blink rate is 1200ms. By setting this to zero, blinking can be disabled.")}}),Object.freeze({name:"highlightActiveLine",default:!1,factory:()=>n(Tb()),schema:{type:"boolean",title:c.__("Highlight the active line")}}),Object.freeze({name:"highlightSpecialCharacters",default:!0,factory:()=>n(xb()),schema:{type:"boolean",title:c.__("Highlight special characters")}}),Object.freeze({name:"highlightTrailingWhitespace",default:!1,factory:()=>n(t1()),schema:{type:"boolean",title:c.__("Highlight trailing white spaces")}}),Object.freeze({name:"highlightWhitespace",default:!1,factory:()=>n(Zb()),schema:{type:"boolean",title:c.__("Highlight white spaces")}}),Object.freeze({name:"indentUnit",default:"4",factory:()=>i(u=>u=="Tab"?ln.of("	"):ln.of(" ".repeat(parseInt(u,10)))),schema:{type:"string",title:c.__("Indentation unit"),description:c.__("The indentation is a `Tab` or the number of spaces. This defaults to 4 spaces."),enum:["Tab","1","2","4","8"]}}),Object.freeze({name:"keymap",default:[{key:"Mod-Enter",run:_i.insertBlankLineOnRun},{key:"Enter",run:_i.completerOrInsertNewLine},{key:"Escape",run:_i.simplifySelectionAndMaybeSwitchToCommandMode},...fv.filter(u=>!["Ctrl-m","Mod-Enter","Shift-Mod-k","Mod-/","Alt-A","Escape","Enter"].includes(u.key)),{key:"Tab",run:_i.indentMoreOrInsertTab,shift:_i.dedentIfNotLaunchingTooltip}],factory:()=>i(u=>Hi.of(u))}),Object.freeze({name:"lineNumbers",default:!0,factory:()=>n(Jb()),schema:{type:"boolean",title:c.__("Line Numbers")}}),Object.freeze({name:"lineWrap",factory:()=>n(N.lineWrapping),default:!0,schema:{type:"boolean",title:c.__("Line Wrap")}}),Object.freeze({name:"dropCursor",default:!0,factory:()=>n(mb()),schema:{type:"boolean",title:c.__("Drop Cursor")}}),Object.freeze({name:"matchBrackets",default:!0,factory:()=>n([iy(),Bi.high(Hi.of(Lv))]),schema:{type:"boolean",title:c.__("Match Brackets")}}),Object.freeze({name:"rectangularSelection",default:!0,factory:()=>n([Pb(),Nb()]),schema:{type:"boolean",title:c.__("Rectangular selection"),description:c.__("Rectangular (block) selection can be created by dragging the mouse pointer while holding the left mouse button and the Alt key. When the Alt key is pressed, a crosshair cursor will appear, indicating that the rectangular selection mode is active.")}}),Object.freeze({name:"readOnly",default:!1,factory:()=>i(u=>[ie.readOnly.of(u),u?N.editorAttributes.of({class:dx}):[]])}),Object.freeze({name:"rulers",default:[],factory:()=>i(u=>u.length>0?Yv(u):[]),schema:{type:"array",title:c.__("Rulers"),items:{type:"number",minimum:0}}}),Object.freeze({name:"extendSelection",default:!0,factory:()=>n(Hi.of([{key:"Mod-Shift-l",run:lx,preventDefault:!0}]))}),Object.freeze({name:"searchWithCM",default:!1,factory:()=>n(Hi.of([{key:"Mod-f",run:Sp,scope:"editor search-panel"},{key:"F3",run:xs,shift:ks,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:xs,shift:ks,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Cp,scope:"editor search-panel"}]))}),Object.freeze({name:"scrollPastEnd",default:!1,factory:u=>u.inline?null:n(Ab())}),Object.freeze({name:"smartIndent",default:!0,factory:()=>n(L1()),schema:{type:"boolean",title:c.__("Smart Indentation")}}),Object.freeze({name:"tabFocusable",default:!0,factory:()=>n(N.contentAttributes.of({tabIndex:"0"}),N.contentAttributes.of({tabIndex:"-1"}))}),Object.freeze({name:"tabSize",default:4,factory:()=>i(u=>ie.tabSize.of(u)),schema:{type:"number",title:c.__("Tab size")}}),Object.freeze({name:"tooltips",factory:()=>s(Bb({position:"absolute",parent:document.body}))}),Object.freeze({name:"allowMultipleSelections",default:!0,factory:()=>i(u=>ie.allowMultipleSelections.of(u)),schema:{type:"boolean",title:c.__("Multiple selections")}}),Object.freeze({name:"customStyles",factory:()=>i(u=>Vv(u)),default:{fontFamily:null,fontSize:null,lineHeight:null},schema:{title:c.__("Custom editor styles"),type:"object",properties:{fontFamily:{type:["string","null"],title:c.__("Font Family")},fontSize:{type:["number","null"],minimum:1,maximum:100,title:c.__("Font Size")},lineHeight:{type:["number","null"],title:c.__("Line Height")}},additionalProperties:!1}})];return l&&f.push(Object.freeze({name:"theme",default:"jupyter",factory:()=>i(u=>l.getTheme(u)),schema:{type:"string",title:c.__("Theme"),description:c.__("CodeMirror theme")}})),h&&f.push(Object.freeze({name:"translation",default:{"Control character":c.__("Control character"),"Selection deleted":c.__("Selection deleted"),"Folded lines":c.__("Folded lines"),"Unfolded lines":c.__("Unfolded lines"),to:c.__("to"),"folded code":c.__("folded code"),unfold:c.__("unfold"),"Fold line":c.__("Fold line"),"Unfold line":c.__("Unfold line"),"Go to line":c.__("Go to line"),go:c.__("go"),Find:c.__("Find"),Replace:c.__("Replace"),next:c.__("next"),previous:c.__("previous"),all:c.__("all"),"match case":c.__("match case"),replace:c.__("replace"),"replace all":c.__("replace all"),close:c.__("close"),"current match":c.__("current match"),"replaced $ matches":c.__("replaced $ matches"),"replaced match on line $":c.__("replaced match on line $"),"on line":c.__("on line"),Completions:c.__("Completions"),Diagnostics:c.__("Diagnostics"),"No diagnostics":c.__("No diagnostics"),Breakpoint:c.__("Breakpoint"),"Selected breakpoint":c.__("Selected breakpoint")},factory:()=>i(u=>ie.phrases.of(u))})),f}r.getDefaultExtensions=o})(Dc||(Dc={}));var Pc={};class ws{constructor(e,t,i,n,s,o,a,l,h,c=0,f){this.p=e,this.stack=t,this.state=i,this.reducePos=n,this.pos=s,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=h,this.lookAhead=c,this.parent=f}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let n=e.parser.context;return new ws(e,[],t,i,i,0,[],0,n?new Lc(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let i=e>>19,n=e&65535,{parser:s}=this.p,o=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),a=s.dynamicPrecedence(n);if(a&&(this.score+=a),i==0){this.pushState(s.getGoto(this.state,n,!0),this.reducePos),n<s.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(n,this.reducePos);return}let l=this.stack.length-(i-1)*3-(e&262144?6:0),h=l?this.stack[l-2]:this.p.ranges[0].from,c=this.reducePos-h;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[n])===null||t===void 0)&&t.isAnonymous)&&(h==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=h,this.p.lastBigReductionSize=c));let f=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-f;if(n<s.minRepeatTerm||e&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,h,d,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=s.getGoto(d,n,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(n,h)}storeNode(e,t,i,n=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==i)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=i;return}}}if(!s||this.pos==i)this.buffer.push(e,t,i,n);else{let o=this.buffer.length;if(o>0&&(this.buffer[o-4]!=0||this.buffer[o-1]<0)){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>i;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=i,this.buffer[o+3]=n}}shift(e,t,i,n){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let s=e,{parser:o}=this.p;(n>this.pos||t<=o.maxNode)&&(this.pos=n,o.stateFlag(s,1)||(this.reducePos=n)),this.pushState(s,i),this.shiftContext(t,i),t<=o.maxNode&&this.buffer.push(t,i,n,4)}else this.pos=n,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,n,4)}apply(e,t,i,n){e&65536?this.reduce(e):this.shift(e,t,i,n)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(t,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),n=e.bufferBase+t;for(;e&&n==e.bufferBase;)e=e.parent;return new ws(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new mx(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(i==0)return!1;if((i&65536)==0)return!0;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&n.push(t[s],o);if(this.stack.length<120)for(let s=0;n.length<8&&s<t.length;s+=2){let o=t[s+1];n.some((a,l)=>l&1&&a==o)||n.push(t[s],o)}t=n}let i=[];for(let n=0;n<t.length&&i.length<4;n+=2){let s=t[n+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[n],this.pos),o.reducePos=this.pos,o.score-=200,i.push(o)}return i}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let i=t>>19,n=t&65535,s=this.stack.length-i*3;if(s<0||e.getGoto(this.stack[s],n,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],i=(n,s)=>{if(!t.includes(n))return t.push(n),e.allActions(n,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-s;if(a>1){let l=o&65535,h=this.stack.length-a*3;if(h>=0&&e.getGoto(this.stack[h],l,!1)>=0)return a<<19|65536|l}}else{let a=i(o,s+1);if(a!=null)return a}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Lc(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Lc{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class mx{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=n}}class Ss{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Ss(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Ss(this.stack,this.pos,this.index)}}function Cn(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let i=0,n=0;i<r.length;){let s=0;for(;;){let o=r.charCodeAt(i++),a=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),s+=l,a)break;s*=46}t?t[n++]=s:t=new e(s)}return t}class Zr{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Ic=new Zr;class gx{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Ic,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,n=this.rangeIndex,s=this.pos+e;for(;s<i.from;){if(!n)return null;let o=this.ranges[--n];s-=i.from-o.to,i=o}for(;t<0?s>i.to:s>=i.to;){if(n==this.ranges.length-1)return null;let o=this.ranges[++n];s+=o.from-i.to,i=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,n;if(t>=0&&t<this.chunk.length)i=this.pos+e,n=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(i=s,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=i;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Ic,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let n of this.ranges){if(n.from>=t)break;n.to>e&&(i+=this.input.read(Math.max(n.from,e),Math.min(n.to,t)))}return i}}let Xi=class{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:i}=t.p;Ap(this.data,e,t,this.id,i.data,i.tokenPrecTable)}};Xi.prototype.contextual=Xi.prototype.fallback=Xi.prototype.extend=!1;class _p{constructor(e,t,i){this.precTable=t,this.elseToken=i,this.data=typeof e=="string"?Cn(e):e}token(e,t){let i=e.pos,n=0;for(;;){let s=e.next<0,o=e.resolveOffset(1,1);if(Ap(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||n++,o==null)break;e.reset(o,e.token)}n&&(e.reset(i,e.token),e.acceptToken(this.elseToken,n))}}_p.prototype.contextual=Xi.prototype.fallback=Xi.prototype.extend=!1;class G2{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function Ap(r,e,t,i,n,s){let o=0,a=1<<i,{dialect:l}=t.p.parser;e:for(;(a&r[o])!=0;){let h=r[o+1];for(let d=o+3;d<h;d+=2)if((r[d+1]&a)>0){let p=r[d];if(l.allows(p)&&(e.token.value==-1||e.token.value==p||bx(p,e.token.value,n,s))){e.acceptToken(p);break}}let c=e.next,f=0,u=r[o+2];if(e.next<0&&u>f&&r[h+u*3-3]==65535){o=r[h+u*3-1];continue e}for(;f<u;){let d=f+u>>1,p=h+d+(d<<1),m=r[p],g=r[p+1]||65536;if(c<m)u=d;else if(c>=g)f=d+1;else{o=r[p+2],e.advance();continue e}}break}}function Nc(r,e,t){for(let i=e,n;(n=r[i])!=65535;i++)if(n==t)return i-e;return-1}function bx(r,e,t,i){let n=Nc(t,i,e);return n<0||Nc(t,i,r)<n}const at=typeof process<"u"&&Pc&&/\bparse\b/.test(Pc.LOG);let wo=null;function Bc(r,e,t){let i=r.cursor(ye.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(r.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:r.length}}class yx{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Bc(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Bc(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],n=this.index[t];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[n],o=this.start[t]+i.positions[n];if(o>e)return this.nextStart=o,null;if(s instanceof pe){if(o==e){if(o<this.safeFrom)return null;let a=o+s.length;if(a<=this.safeTo){let l=s.prop(U.lookAhead);if(!l||a+l<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class vx{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new Zr)}getActions(e){let t=0,i=null,{parser:n}=e.p,{tokenizers:s}=n,o=n.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,l=0;for(let h=0;h<s.length;h++){if((1<<h&o)==0)continue;let c=s[h],f=this.tokens[h];if(!(i&&!c.fallback)&&((c.contextual||f.start!=e.pos||f.mask!=o||f.context!=a)&&(this.updateCachedToken(f,c,e),f.mask=o,f.context=a),f.lookAhead>f.end+25&&(l=Math.max(f.lookAhead,l)),f.value!=0)){let u=t;if(f.extended>-1&&(t=this.addActions(e,f.extended,f.end,t)),t=this.addActions(e,f.value,f.end,t),!c.extend&&(i=f,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!i&&e.pos==this.stream.end&&(i=new Zr,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Zr,{pos:i,p:n}=e;return t.start=i,t.end=Math.min(i+1,n.stream.end),t.value=i==n.stream.end?n.parser.eofTerm:0,t}updateCachedToken(e,t,i){let n=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(n,e),i),e.value>-1){let{parser:s}=i.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let a=s.specializers[o](this.stream.read(e.start,e.end),i);if(a>=0&&i.p.parser.dialect.allows(a>>1)){(a&1)==0?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(n+1)}putAction(e,t,i,n){for(let s=0;s<n;s+=3)if(this.actions[s]==e)return n;return this.actions[n++]=e,this.actions[n++]=t,this.actions[n++]=i,n}addActions(e,t,i,n){let{state:s}=e,{parser:o}=e.p,{data:a}=o;for(let l=0;l<2;l++)for(let h=o.stateSlot(s,l?2:1);;h+=3){if(a[h]==65535)if(a[h+1]==1)h=zt(a,h+2);else{n==0&&a[h+1]==2&&(n=this.putAction(zt(a,h+2),t,i,n));break}a[h]==t&&(n=this.putAction(zt(a,h+1),t,i,n))}return n}}class xx{constructor(e,t,i,n){this.parser=e,this.input=t,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new gx(t,n),this.tokens=new vx(e,this.stream),this.topTerm=e.top[1];let{from:s}=n[0];this.stacks=[ws.start(this,e.top[0],s)],this.fragments=i.length&&this.stream.end-s>e.bufferLength*4?new yx(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],n,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>t)i.push(a);else{if(this.advanceStack(a,i,e))continue;{n||(n=[],s=[]),n.push(a);let l=this.tokens.getMainToken(a);s.push(l.value,l.end)}}break}}if(!i.length){let o=n&&wx(n);if(o)return at&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw at&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&n){let o=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,s,i);if(o)return at&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((a,l)=>l.score-a.score);i.length>o;)i.pop();i.some(a=>a.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let o=0;o<i.length-1;o++){let a=i[o];for(let l=o+1;l<i.length;l++){let h=i[l];if(a.sameState(h)||a.buffer.length>500&&h.buffer.length>500)if((a.score-h.score||a.buffer.length-h.buffer.length)>0)i.splice(l--,1);else{i.splice(o--,1);continue e}}}i.length>12&&(i.sort((o,a)=>a.score-o.score),i.splice(12,i.length-12))}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let n=e.pos,{parser:s}=this,o=at?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let h=e.curContext&&e.curContext.tracker.strict,c=h?e.curContext.hash:0;for(let f=this.fragments.nodeAt(n);f;){let u=this.parser.nodeSet.types[f.type.id]==f.type?s.getGoto(e.state,f.type.id):-1;if(u>-1&&f.length&&(!h||(f.prop(U.contextHash)||0)==c))return e.useNode(f,u),at&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(f.type.id)})`),!0;if(!(f instanceof pe)||f.children.length==0||f.positions[0]>0)break;let d=f.children[0];if(d instanceof pe&&f.positions[0]==0)f=d;else break}}let a=s.stateSlot(e.state,4);if(a>0)return e.reduce(a),at&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(a&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let h=0;h<l.length;){let c=l[h++],f=l[h++],u=l[h++],d=h==l.length||!i,p=d?e:e.split(),m=this.tokens.mainToken;if(p.apply(c,f,m?m.start:p.pos,u),at&&console.log(o+this.stackID(p)+` (via ${(c&65536)==0?"shift":`reduce of ${s.getName(c&65535)}`} for ${s.getName(f)} @ ${n}${p==e?"":", split"})`),d)return!0;p.pos>n?t.push(p):i.push(p)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return jc(e,t),!0}}runRecovery(e,t,i){let n=null,s=!1;for(let o=0;o<e.length;o++){let a=e[o],l=t[o<<1],h=t[(o<<1)+1],c=at?this.stackID(a)+" -> ":"";if(a.deadEnd&&(s||(s=!0,a.restart(),at&&console.log(c+this.stackID(a)+" (restarted)"),this.advanceFully(a,i))))continue;let f=a.split(),u=c;for(let d=0;d<10&&f.forceReduce()&&(at&&console.log(u+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,i));d++)at&&(u=this.stackID(f)+" -> ");for(let d of a.recoverByInsert(l))at&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,i);this.stream.end>a.pos?(h==a.pos&&(h++,l=0),a.recoverByDelete(l,h),at&&console.log(c+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),jc(a,i)):(!n||n.score<a.score)&&(n=a)}return n}stackToTree(e){return e.close(),pe.build({buffer:Ss.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(wo||(wo=new WeakMap)).get(e);return t||wo.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function jc(r,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==r.pos&&i.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class kx{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}const So=r=>r;class U2{constructor(e){this.start=e.start,this.shift=e.shift||So,this.reduce=e.reduce||So,this.reuse=e.reuse||So,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Cs extends fl{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let a=0;a<e.repeatNodeCount;a++)t.push("");let i=Object.keys(e.topRules).map(a=>e.topRules[a][1]),n=[];for(let a=0;a<t.length;a++)n.push([]);function s(a,l,h){n[a].push([l,l.deserialize(String(h))])}if(e.nodeProps)for(let a of e.nodeProps){let l=a[0];typeof l=="string"&&(l=U[l]);for(let h=1;h<a.length;){let c=a[h++];if(c>=0)s(c,l,a[h++]);else{let f=a[h+-c];for(let u=-c;u>0;u--)s(a[h++],l,f);h++}}}this.nodeSet=new Bs(t.map((a,l)=>Xe.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:n[l],top:i.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=ad;let o=Cn(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(Fc),this.states=Cn(e.states,Uint32Array),this.data=Cn(e.stateData),this.goto=Cn(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new Xi(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let n=new xx(this,e,t,i);for(let s of this.wrappers)n=s(n,e,t,i);return n}getGoto(e,t,i=!1){let n=this.goto;if(t>=n[0])return-1;for(let s=n[t+1];;){let o=n[s++],a=o&1,l=n[s++];if(a&&i)return l;for(let h=s+(o>>1);s<h;s++)if(n[s]==e)return l;if(a)return-1}}hasAction(e,t){let i=this.data;for(let n=0;n<2;n++)for(let s=this.stateSlot(e,n?2:1),o;;s+=3){if((o=i[s])==65535)if(i[s+1]==1)o=i[s=zt(i,s+2)];else{if(i[s+1]==2)return zt(i,s+2);break}if(o==t||o==0)return zt(i,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,i=>i==t?!0:null)}allActions(e,t){let i=this.stateSlot(e,4),n=i?t(i):void 0;for(let s=this.stateSlot(e,1);n==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=zt(this.data,s+2);else break;n=t(zt(this.data,s+1))}return n}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=zt(this.data,i+2);else break;if((this.data[i+2]&1)==0){let n=this.data[i+1];t.some((s,o)=>o&1&&s==n)||t.push(this.data[i],n)}}return t}configure(e){let t=Object.assign(Object.create(Cs.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let n=e.tokenizers.find(s=>s.from==i);return n?n.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,n)=>{let s=e.specializers.find(a=>a.from==i.external);if(!s)return i;let o=Object.assign(Object.assign({},i),{external:s.to});return t.specializers[n]=Fc(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(i[o]=!0)}let n=null;for(let s=0;s<t.length;s++)if(!i[s])for(let o=this.dialects[t[s]],a;(a=this.data[o++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[a]=1;return new kx(e,i,n)}static deserialize(e){return new Cs(e)}}function zt(r,e){return r[e]|r[e+1]<<16}function wx(r){let e=null;for(let t of r){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function Fc(r){if(r.external){let e=r.extend?1:0;return(t,i)=>r.external(t,i)<<1|e}return r.get}var Sx={};class Ne{constructor(e){this.start=e}}class Cx extends Ne{constructor(e,t,i,n,s,o,a,l,h,c,f,u,d,p,m){super(e),this.rules=t,this.topRules=i,this.tokens=n,this.localTokens=s,this.context=o,this.externalTokens=a,this.externalSpecializers=l,this.externalPropSources=h,this.precedences=c,this.mainSkip=f,this.scopedSkip=u,this.dialects=d,this.externalProps=p,this.autoDelim=m}toString(){return Object.values(this.rules).join(`
`)}}class Rl extends Ne{constructor(e,t,i,n,s){super(e),this.id=t,this.props=i,this.params=n,this.expr=s}toString(){return this.id.name+(this.params.length?`<${this.params.join()}>`:"")+" -> "+this.expr}}class _x extends Ne{constructor(e,t){super(e),this.items=t}}class Ax extends Ne{constructor(e,t){super(e),this.items=t}}class Tx extends Ne{constructor(e,t,i){super(e),this.a=t,this.b=i}}class Ex extends Ne{constructor(e,t,i,n,s){super(e),this.precedences=t,this.conflicts=i,this.rules=n,this.literals=s}}class Ox extends Ne{constructor(e,t,i,n){super(e),this.precedences=t,this.rules=i,this.fallback=n}}class Mx extends Ne{constructor(e,t,i){super(e),this.literal=t,this.props=i}}class Rx extends Ne{constructor(e,t,i){super(e),this.id=t,this.source=i}}class Dx extends Ne{constructor(e,t,i,n,s){super(e),this.id=t,this.source=i,this.tokens=n,this.conflicts=s}}class Px extends Ne{constructor(e,t,i,n,s,o){super(e),this.type=t,this.token=i,this.id=n,this.source=s,this.tokens=o}}class Lx extends Ne{constructor(e,t,i){super(e),this.id=t,this.source=i}}class Ix extends Ne{constructor(e,t,i,n){super(e),this.id=t,this.externalID=i,this.source=n}}class Tp extends Ne{constructor(e,t){super(e),this.name=t}toString(){return this.name}}class Et extends Ne{walk(e){return e(this)}eq(e){return!1}}Et.prototype.prec=10;class Ke extends Et{constructor(e,t,i){super(e),this.id=t,this.args=i}toString(){return this.id.name+(this.args.length?`<${this.args.join()}>`:"")}eq(e){return this.id.name==e.id.name&&pr(this.args,e.args)}walk(e){let t=Dl(this.args,e);return e(t==this.args?this:new Ke(this.start,this.id,t))}}class Qi extends Et{constructor(e,t,i,n,s){super(e),this.type=t,this.props=i,this.token=n,this.content=s}toString(){return`@${this.type}[${this.props.join(",")}]<${this.token}, ${this.content}>`}eq(e){return this.type==e.type&&Ws.eqProps(this.props,e.props)&&di(this.token,e.token)&&di(this.content,e.content)}walk(e){let t=this.token.walk(e),i=this.content.walk(e);return e(t==this.token&&i==this.content?this:new Qi(this.start,this.type,this.props,t,i))}}class Ri extends Et{constructor(e,t){super(e),this.rule=t}toString(){let e=this.rule;return`${e.id}${e.props.length?`[${e.props.join(",")}]`:""} { ${e.expr} }`}eq(e){let t=this.rule,i=e.rule;return di(t.expr,i.expr)&&t.id.name==i.id.name&&Ws.eqProps(t.props,i.props)}walk(e){let t=this.rule,i=t.expr.walk(e);return e(i==t.expr?this:new Ri(this.start,new Rl(t.start,t.id,t.props,[],i)))}}class oi extends Et{constructor(e,t){super(e),this.exprs=t}toString(){return this.exprs.map(e=>Pl(e,this)).join(" | ")}eq(e){return pr(this.exprs,e.exprs)}walk(e){let t=Dl(this.exprs,e);return e(t==this.exprs?this:new oi(this.start,t))}}oi.prototype.prec=1;class ct extends Et{constructor(e,t,i,n=!1){super(e),this.exprs=t,this.markers=i,this.empty=n}toString(){return this.empty?"()":this.exprs.map(e=>Pl(e,this)).join(" ")}eq(e){return pr(this.exprs,e.exprs)&&this.markers.every((t,i)=>{let n=e.markers[i];return t.length==n.length&&t.every((s,o)=>s.eq(n[o]))})}walk(e){let t=Dl(this.exprs,e);return e(t==this.exprs?this:new ct(this.start,t,this.markers,this.empty&&!t.length))}}ct.prototype.prec=2;class Nx extends Ne{constructor(e,t,i){super(e),this.id=t,this.type=i}toString(){return(this.type=="ambig"?"~":"!")+this.id.name}eq(e){return this.id.name==e.id.name&&this.type==e.type}}class Ni extends Et{constructor(e,t,i){super(e),this.expr=t,this.kind=i}toString(){return Pl(this.expr,this)+this.kind}eq(e){return di(this.expr,e.expr)&&this.kind==e.kind}walk(e){let t=this.expr.walk(e);return e(t==this.expr?this:new Ni(this.start,t,this.kind))}}Ni.prototype.prec=3;class mt extends Et{constructor(e,t){super(e),this.value=t}toString(){return JSON.stringify(this.value)}eq(e){return this.value==e.value}}class Ep extends Et{constructor(e,t,i){super(e),this.ranges=t,this.inverted=i}toString(){return`[${this.inverted?"^":""}${this.ranges.map(([e,t])=>String.fromCodePoint(e)+(t==e+1?"":"-"+String.fromCodePoint(t)))}]`}eq(e){return this.inverted==e.inverted&&this.ranges.length==e.ranges.length&&this.ranges.every(([t,i],n)=>{let[s,o]=e.ranges[n];return t==s&&i==o})}}class Op extends Et{constructor(e){super(e)}toString(){return"_"}eq(){return!0}}function Dl(r,e){let t=null;for(let i=0;i<r.length;i++){let n=r[i].walk(e);n!=r[i]&&!t&&(t=r.slice(0,i)),t&&t.push(n)}return t||r}const Fa={asciiLetter:[[65,91],[97,123]],asciiLowercase:[[97,123]],asciiUppercase:[[65,91]],digit:[[48,58]],whitespace:[[9,14],[32,33],[133,134],[160,161],[5760,5761],[8192,8203],[8232,8234],[8239,8240],[8287,8288],[12288,12289]],eof:[[65535,65535]]};class $a extends Et{constructor(e,t){super(e),this.type=t}toString(){return"@"+this.type}eq(e){return this.type==e.type}}function di(r,e){return r.constructor==e.constructor&&r.eq(e)}function pr(r,e){return r.length==e.length&&r.every((t,i)=>di(t,e[i]))}class Ws extends Ne{constructor(e,t,i,n){super(e),this.at=t,this.name=i,this.value=n}eq(e){return this.name==e.name&&this.value.length==e.value.length&&this.value.every((t,i)=>t.value==e.value[i].value&&t.name==e.value[i].name)}toString(){let e=(this.at?"@":"")+this.name;if(this.value.length){e+="=";for(let{name:t,value:i}of this.value)e+=t?`{${t}}`:/[^\w-]/.test(i)?JSON.stringify(i):i}return e}static eqProps(e,t){return e.length==t.length&&e.every((i,n)=>i.eq(t[n]))}}class In extends Ne{constructor(e,t,i){super(e),this.value=t,this.name=i}}function Pl(r,e){return r.prec<e.prec?"("+r.toString()+")":r.toString()}class Ut extends Error{}function _n(r){for(let e in r)return!0;return!1}let Bx=0;class jx{constructor(e,t,i,n={}){this.name=e,this.flags=t,this.nodeName=i,this.props=n,this.hash=++Bx,this.id=-1,this.rules=[]}toString(){return this.name}get nodeType(){return this.top||this.nodeName!=null||_n(this.props)||this.repeated}get terminal(){return(this.flags&1)>0}get eof(){return(this.flags&4)>0}get error(){return"error"in this.props}get top(){return(this.flags&2)>0}get interesting(){return this.flags>0||this.nodeName!=null}get repeated(){return(this.flags&16)>0}set preserve(e){this.flags=e?this.flags|8:this.flags&-9}get preserve(){return(this.flags&8)>0}set inline(e){this.flags=e?this.flags|32:this.flags&-33}get inline(){return(this.flags&32)>0}cmp(e){return this.hash-e.hash}}class Fx{constructor(){this.terms=[],this.names=Object.create(null),this.tops=[],this.eof=this.term("",null,5),this.error=this.term("","",8)}term(e,t,i=0,n={}){let s=new jx(e,i,t,n);return this.terms.push(s),this.names[e]=s,s}makeTop(e,t){const i=this.term("@top",e,2,t);return this.tops.push(i),i}makeTerminal(e,t,i={}){return this.term(e,t,1,i)}makeNonTerminal(e,t,i={}){return this.term(e,t,0,i)}makeRepeat(e){return this.term(e,null,16)}uniqueName(e){for(let t=0;;t++){let i=t?`${e}-${t}`:e;if(!this.names[i])return i}}finish(e){for(let o of e)o.name.rules.push(o);this.terms=this.terms.filter(o=>o.terminal||o.preserve||e.some(a=>a.name==o||a.parts.includes(o)));let t={},i=[this.error];this.error.id=0;let n=1;for(let o of this.terms)o.id<0&&o.nodeType&&!o.repeated&&(o.id=n++,i.push(o));let s=n;for(let o of this.terms)o.repeated&&(o.id=n++,i.push(o));this.eof.id=n++;for(let o of this.terms)o.id<0&&(o.id=n++),o.name&&(t[o.id]=o.name);if(n>=65534)throw new Ut("Too many terms");return{nodeTypes:i,names:t,minRepeatTerm:s,maxTerm:n-1}}}function _s(r,e,t){if(r.length!=e.length)return r.length-e.length;for(let i=0;i<r.length;i++){let n=t(r[i],e[i]);if(n)return n}return 0}const $x=[];class Fe{constructor(e,t=$x,i=0){this.precedence=e,this.ambigGroups=t,this.cut=i}join(e){return this==Fe.none||this==e?e:e==Fe.none?this:new Fe(Math.max(this.precedence,e.precedence),As(this.ambigGroups,e.ambigGroups),Math.max(this.cut,e.cut))}cmp(e){return this.precedence-e.precedence||_s(this.ambigGroups,e.ambigGroups,(t,i)=>t<i?-1:t>i?1:0)||this.cut-e.cut}}Fe.none=new Fe(0);function As(r,e){if(r.length==0||r==e)return e;if(e.length==0)return r;let t=r.slice();for(let i of e)r.includes(i)||t.push(i);return t.sort()}let zx=0;class Ll{constructor(e,t,i,n){this.name=e,this.parts=t,this.conflicts=i,this.skip=n,this.id=zx++}cmp(e){return this.id-e.id}cmpNoName(e){return this.parts.length-e.parts.length||this.skip.hash-e.skip.hash||this.parts.reduce((t,i,n)=>t||i.cmp(e.parts[n]),0)||_s(this.conflicts,e.conflicts,(t,i)=>t.cmp(i))}toString(){return this.name+" -> "+this.parts.join(" ")}get isRepeatWrap(){return this.name.repeated&&this.parts.length==2&&this.parts[0]==this.name}sameReduce(e){return this.name==e.name&&this.parts.length==e.parts.length&&this.isRepeatWrap==e.isRepeatWrap}}const Il=65535;class Mp{constructor(e,t,i){this.from=e,this.to=t,this.target=i}toString(){return`-> ${this.target.id}[label=${JSON.stringify(this.from<0?"":$c(this.from)+(this.to>this.from+1?"-"+$c(this.to-1):""))}]`}}function $c(r){return r>Il?"":r==10?"\\n":r==13?"\\r":r<32||r>=55296&&r<57343?"\\u{"+r.toString(16)+"}":String.fromCharCode(r)}function Vx(r,e){let t=Object.create(null),i=Object.create(null);for(let n of r){let s=za(n.accepting),o=i[s]||(i[s]=[]);o.push(n),t[n.id]=o}for(;;){let n=!1,s=Object.create(null);for(let o of r){if(s[o.id])continue;let a=t[o.id];if(a.length==1){s[a[0].id]=a;continue}let l=[];e:for(let h of a){for(let c of l)if(Wx(h,c[0],t)){c.push(h);continue e}l.push([h])}l.length>1&&(n=!0);for(let h of l)for(let c of h)s[c.id]=h}if(!n)return Hx(r,e,t);t=s}}function Wx(r,e,t){if(r.edges.length!=e.edges.length)return!1;for(let i=0;i<r.edges.length;i++){let n=r.edges[i],s=e.edges[i];if(n.from!=s.from||n.to!=s.to||t[n.target.id]!=t[s.target.id])return!1}return!0}function Hx(r,e,t){for(let i of r)for(let n=0;n<i.edges.length;n++){let s=i.edges[n],o=t[s.target.id][0];o!=s.target&&(i.edges[n]=new Mp(s.from,s.to,o))}return t[e.id][0]}let qx=1,ht=class Rp{constructor(e=[],t=qx++){this.accepting=e,this.id=t,this.edges=[]}edge(e,t,i){this.edges.push(new Mp(e,t,i))}nullEdge(e){this.edge(-1,-1,e)}compile(){let e=Object.create(null),t=0,i=n(this.closure().sort((s,o)=>s.id-o.id));return Vx(Object.values(e),i);function n(s){let o=e[za(s)]=new Rp(s.reduce((h,c)=>As(h,c.accepting),[]),t++),a=[];for(let h of s)for(let c of h.edges)c.from>=0&&a.push(c);let l=Ux(a);for(let h of l){let c=h.targets.sort((f,u)=>f.id-u.id);o.edge(h.from,h.to,e[za(c)]||n(c))}return o}}closure(){let e=[],t=Object.create(null);function i(n){if(!t[n.id]){t[n.id]=!0,(n.edges.some(s=>s.from>=0)||n.accepting.length>0&&!n.edges.some(s=>Gx(n.accepting,s.target.accepting)))&&e.push(n);for(let s of n.edges)s.from<0&&i(s.target)}}return i(this),e}findConflicts(e){let t=[],i=this.cycleTerms();function n(s,o,a,l,h){s.id<o.id&&([s,o]=[o,s],a=-a);let c=t.find(f=>f.a==s&&f.b==o);c?c.soft!=a&&(c.soft=0):t.push(new Dp(s,o,a,zc(l),h&&zc(h)))}return this.reachable((s,o)=>{if(s.accepting.length!=0){for(let a=0;a<s.accepting.length;a++)for(let l=a+1;l<s.accepting.length;l++)n(s.accepting[a],s.accepting[l],0,o);s.reachable((a,l)=>{if(a!=s)for(let h of a.accepting){let c=i.includes(h);for(let f of s.accepting)h!=f&&n(h,f,c||i.includes(f)||!e(h,f)?0:1,o,o.concat(l))}})}}),t}cycleTerms(){let e=[];this.reachable(s=>{for(let{target:o}of s.edges)e.push(s,o)});let t=new Map,i=[];for(let s=0;s<e.length;){let o=e[s++],a=e[s++],l=t.get(o);if(l||t.set(o,l=[]),!l.includes(a))if(o==a)i.includes(o)||i.push(o);else{for(let h of l)e.push(o,h);l.push(a)}}let n=[];for(let s of i)for(let o of s.accepting)n.includes(o)||n.push(o);return n}reachable(e){let t=[],i=[];(function n(s){e(s,i),t.push(s);for(let o of s.edges)t.includes(o.target)||(i.push(o),n(o.target),i.pop())})(this)}toString(){let e=`digraph {
`;return this.reachable(t=>{t.accepting.length&&(e+=`  ${t.id} [label=${JSON.stringify(t.accepting.join())}];
`);for(let i of t.edges)e+=`  ${t.id} ${i};
`}),e+"}"}toArray(e,t){let i=[],n=[];this.reachable(s=>{let o=n.length,a=o+3+s.accepting.length*2;i[s.id]=o,n.push(s.stateMask(e),a,s.edges.length),s.accepting.sort((l,h)=>t.indexOf(l.id)-t.indexOf(h.id));for(let l of s.accepting)n.push(l.id,e[l.id]||65535);for(let l of s.edges)n.push(l.from,l.to,-l.target.id-1)});for(let s=0;s<n.length;s++)n[s]<0&&(n[s]=i[-n[s]-1]);if(n.length>Math.pow(2,16))throw new Ut("Tokenizer tables too big to represent with 16-bit offsets.");return Uint16Array.from(n)}stateMask(e){let t=0;return this.reachable(i=>{for(let n of i.accepting)t|=e[n.id]||65535}),t}},Dp=class{constructor(e,t,i,n,s){this.a=e,this.b=t,this.soft=i,this.exampleA=n,this.exampleB=s}};function zc(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t].from);return e}function za(r){let e="";for(let t of r)e.length&&(e+="-"),e+=t.id;return e}function Gx(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t])return!1;return!0}class Vc{constructor(e,t,i){this.from=e,this.to=t,this.targets=i}}function Ux(r){let e=[],t=[];for(let n of r)e.includes(n.from)||e.push(n.from),e.includes(n.to)||e.push(n.to);e.sort((n,s)=>n-s);for(let n=1;n<e.length;n++){let s=e[n-1],o=e[n],a=[];for(let l of r)if(l.to>s&&l.from<o)for(let h of l.target.closure())a.includes(h)||a.push(h);a.length&&t.push(new Vc(s,o,a))}let i=r.filter(n=>n.from==65535&&n.to==65535);if(i.length){let n=[];for(let s of i)for(let o of s.target.closure())n.includes(o)||n.push(o);n.length&&t.push(new Vc(65535,65535,n))}return t}let An=/[\w_-]+/gy;try{An=/[\p{Alphabetic}\d_-]+/ugy}catch{}const Vt=[];class Kx{constructor(e,t=null){this.string=e,this.fileName=t,this.type="sof",this.value=null,this.start=0,this.end=0,this.next()}lineInfo(e){for(let t=1,i=0;;){let n=this.string.indexOf(`
`,i);if(n>-1&&n<e)++t,i=n+1;else return{line:t,ch:e-i}}}message(e,t=-1){let i=this.fileName||"";if(t>-1){let n=this.lineInfo(t);i+=(i?" ":"")+n.line+":"+n.ch}return i?e+` (${i})`:e}raise(e,t=-1){throw new Ut(this.message(e,t))}match(e,t){let i=t.exec(this.string.slice(e));return i?e+i[0].length:-1}next(){let e=this.match(this.end,/^(\s|\/\/.*|\/\*[^]*?\*\/)*/);if(e==this.string.length)return this.set("eof",null,e,e);let t=this.string[e];if(t=='"'){let i=this.match(e+1,/^(\\.|[^"\\])*"/);return i==-1&&this.raise("Unterminated string literal",e),this.set("string",Va(this.string.slice(e+1,i-1)),e,i)}else if(t=="'"){let i=this.match(e+1,/^(\\.|[^'\\])*'/);return i==-1&&this.raise("Unterminated string literal",e),this.set("string",Va(this.string.slice(e+1,i-1)),e,i)}else if(t=="@"){An.lastIndex=e+1;let i=An.exec(this.string);return i?this.set("at",i[0],e,e+1+i[0].length):this.raise("@ without a name",e)}else if((t=="$"||t=="!")&&this.string[e+1]=="["){let i=this.match(e+2,/^(?:\\.|[^\]\\])*\]/);return i==-1&&this.raise("Unterminated character set",e),this.set("set",this.string.slice(e+2,i-1),e,i)}else{if(/[\[\]()!~+*?{}<>\.,|:$=]/.test(t))return this.set(t,null,e,e+1);{An.lastIndex=e;let i=An.exec(this.string);return i?this.set("id",i[0],e,e+i[0].length):this.raise("Unexpected character "+JSON.stringify(t),e)}}}set(e,t,i,n){this.type=e,this.value=t,this.start=i,this.end=n}eat(e,t=null){return this.type==e&&(t==null||this.value===t)?(this.next(),!0):!1}unexpected(){return this.raise(`Unexpected token '${this.string.slice(this.start,this.end)}'`,this.start)}expect(e,t=null){let i=this.value;return(this.type!=e||!(t==null||i===t))&&this.unexpected(),this.next(),i}parse(){return Jx(this)}}function Jx(r){let e=r.start,t=[],i=null,n=null,s=[],o=null,a=[],l=[],h=null,c=[],f=[],u=[],d=[],p=[],m=!1,g=!1;for(;r.type!="eof";){let b=r.start;if(r.eat("at","top"))r.type!="id"&&r.raise("Top rules must have a name",r.start),p.push(ni(r,Ve(r))),m=!0;else if(r.type=="at"&&r.value=="tokens")n?r.raise("Multiple @tokens declaractions",r.start):n=ek(r);else if(r.eat("at","local"))r.expect("id","tokens"),s.push(tk(r,b));else if(r.eat("at","context")){h&&r.raise("Multiple @context declarations",b);let y=Ve(r);r.expect("id","from");let x=r.expect("string");h=new Rx(b,y,x)}else if(r.eat("at","external"))r.eat("id","tokens")?c.push(nk(r,b)):r.eat("id","prop")?u.push(sk(r,b)):r.eat("id","extend")?f.push(Gc(r,"extend",b)):r.eat("id","specialize")?f.push(Gc(r,"specialize",b)):r.eat("id","propSource")?d.push(rk(r,b)):r.unexpected();else if(r.eat("at","dialects")){r.expect("{");for(let y=!0;!r.eat("}");y=!1)y||r.eat(","),l.push(Ve(r))}else if(r.type=="at"&&r.value=="precedence")i&&r.raise("Multiple precedence declarations",r.start),i=Zx(r);else if(r.eat("at","detectDelim"))g=!0;else if(r.eat("at","skip")){let y=Nl(r);if(r.type=="{"){r.next();let x=[],E=[];for(;!r.eat("}");)r.eat("at","top")?(E.push(ni(r,Ve(r))),m=!0):x.push(ni(r));a.push({expr:y,topRules:E,rules:x})}else o&&r.raise("Multiple top-level skip declarations",r.start),o=y}else t.push(ni(r))}return m?new Cx(e,t,p,n,s,h,c,f,d,i,o,a,l,u,g):r.raise("Missing @top declaration")}function ni(r,e){let t=e?e.start:r.start,i=e||Ve(r),n=mr(r),s=[];if(r.eat("<"))for(;!r.eat(">");)s.length&&r.expect(","),s.push(Ve(r));let o=Nl(r);return new Rl(t,i,n,s,o)}function mr(r){if(r.type!="[")return Vt;let e=[];for(r.expect("[");!r.eat("]");)e.length&&r.expect(","),e.push(Yx(r));return e}function Yx(r){let e=r.start,t=[],i=r.value,n=r.type=="at";if(!r.eat("at")&&!r.eat("id")&&r.unexpected(),r.eat("="))for(;;)if(r.type=="string"||r.type=="id")t.push(new In(r.start,r.value,null)),r.next();else if(r.eat("."))t.push(new In(r.start,".",null));else if(r.eat("{"))t.push(new In(r.start,null,r.expect("id"))),r.expect("}");else break;return new Ws(e,n,i,t)}function Nl(r){r.expect("{");let e=Nn(r);return r.expect("}"),e}const Co="";function Ts(r){let e=r.start;if(r.eat("(")){if(r.eat(")"))return new ct(e,Vt,[Vt,Vt]);let t=Nn(r);return r.expect(")"),t}else if(r.type=="string"){let t=r.value;return r.next(),t.length==0?new ct(e,Vt,[Vt,Vt]):new mt(e,t)}else{if(r.eat("id","_"))return new Op(e);if(r.type=="set"){let t=r.value,i=r.string[r.start]=="!",n=Va(t.replace(/\\.|-|"/g,o=>o=="-"?Co:o=='"'?'\\"':o)),s=[];for(let o=0;o<n.length;){let a=n.codePointAt(o);if(o+=a>65535?2:1,o<n.length-1&&n[o]==Co){let l=n.codePointAt(o+1);o+=l>65535?3:2,l<a&&r.raise("Invalid character range",r.start),Wc(r,s,a,l+1)}else a==Co.charCodeAt(0)&&(a=45),Wc(r,s,a,a+1)}return r.next(),new Ep(e,s.sort((o,a)=>o[0]-a[0]),i)}else if(r.type=="at"&&(r.value=="specialize"||r.value=="extend")){let{start:t,value:i}=r;r.next();let n=mr(r);r.expect("<");let s=Nn(r),o;return r.eat(",")?o=Nn(r):s instanceof mt?o=s:r.raise(`@${i} requires two arguments when its first argument isn't a literal string`),r.expect(">"),new Qi(t,i,n,s,o)}else if(r.type=="at"&&Fa.hasOwnProperty(r.value)){let t=new $a(r.start,r.value);return r.next(),t}else if(r.type=="["){let t=ni(r,new Tp(e,"_anon"));return t.params.length&&r.raise("Inline rules can't have parameters",t.start),new Ri(e,t)}else{let t=Ve(r);if(r.type=="["||r.type=="{"){let i=ni(r,t);return i.params.length&&r.raise("Inline rules can't have parameters",i.start),new Ri(e,i)}else{if(r.eat(".")&&t.name=="std"&&Fa.hasOwnProperty(r.value)){let i=new $a(e,r.value);return r.next(),i}return new Ke(e,t,Xx(r))}}}}function Xx(r){let e=[];if(r.eat("<"))for(;!r.eat(">");)e.length&&r.expect(","),e.push(Nn(r));return e}function Wc(r,e,t,i){e.every(([n,s])=>s<=t||n>=i)||r.raise("Overlapping character range",r.start),e.push([t,i])}function Qx(r){let e=r.start,t=Ts(r);for(;;){let i=r.type;if(r.eat("*")||r.eat("?")||r.eat("+"))t=new Ni(e,t,i);else return t}}function Hc(r){return r.type=="}"||r.type==")"||r.type=="|"||r.type=="/"||r.type=="/\\"||r.type=="{"||r.type==","||r.type==">"}function qc(r){let e=r.start,t=[],i=[Vt];do{for(;;){let n=r.start,s;if(r.eat("~"))s="ambig";else if(r.eat("!"))s="prec";else break;i[i.length-1]=i[i.length-1].concat(new Nx(n,Ve(r),s))}if(Hc(r))break;t.push(Qx(r)),i.push(Vt)}while(!Hc(r));return t.length==1&&i.every(n=>n.length==0)?t[0]:new ct(e,t,i,!t.length)}function Nn(r){let e=r.start,t=qc(r);if(!r.eat("|"))return t;let i=[t];do i.push(qc(r));while(r.eat("|"));let n=i.find(s=>s instanceof ct&&s.empty);return n&&r.raise("Empty expression in choice operator. If this is intentional, use () to make it explicit.",n.start),new oi(e,i)}function Ve(r){r.type!="id"&&r.unexpected();let e=r.start,t=r.value;return r.next(),new Tp(e,t)}function Zx(r){let e=r.start;r.next(),r.expect("{");let t=[];for(;!r.eat("}");)t.length&&r.eat(","),t.push({id:Ve(r),type:r.eat("at","left")?"left":r.eat("at","right")?"right":r.eat("at","cut")?"cut":null});return new _x(e,t)}function ek(r){let e=r.start;r.next(),r.expect("{");let t=[],i=[],n=[],s=[];for(;!r.eat("}");)r.type=="at"&&r.value=="precedence"?n.push(Pp(r)):r.type=="at"&&r.value=="conflict"?s.push(ik(r)):r.type=="string"?i.push(new Mx(r.start,r.expect("string"),mr(r))):t.push(ni(r));return new Ex(e,n,s,t,i)}function tk(r,e){r.expect("{");let t=[],i=[],n=null;for(;!r.eat("}");)r.type=="at"&&r.value=="precedence"?i.push(Pp(r)):r.eat("at","else")&&!n?n={id:Ve(r),props:mr(r)}:t.push(ni(r));return new Ox(e,i,t,n)}function Pp(r){let e=r.start;r.next(),r.expect("{");let t=[];for(;!r.eat("}");){t.length&&r.eat(",");let i=Ts(r);i instanceof mt||i instanceof Ke?t.push(i):r.raise("Invalid expression in token precedences",i.start)}return new Ax(e,t)}function ik(r){let e=r.start;r.next(),r.expect("{");let t=Ts(r);t instanceof mt||t instanceof Ke||r.raise("Invalid expression in token conflict",t.start),r.eat(",");let i=Ts(r);return i instanceof mt||i instanceof Ke||r.raise("Invalid expression in token conflict",i.start),r.expect("}"),new Tx(e,t,i)}function Lp(r,e){let t=[],i=[];r.expect("{");for(let n=!0;!r.eat("}");n=!1)if(n||r.eat(","),e&&r.eat("at","conflict")){r.expect("{");for(let s=!0;!r.eat("}");s=!1)s||r.eat(","),i.push(Ve(r))}else{let s=Ve(r),o=mr(r);t.push({id:s,props:o})}return{tokens:t,conflicts:i}}function nk(r,e){let t=Ve(r);r.expect("id","from");let i=r.expect("string"),{tokens:n,conflicts:s}=Lp(r,!0);return new Dx(e,t,i,n,s)}function Gc(r,e,t){let i=Nl(r),n=Ve(r);r.expect("id","from");let s=r.expect("string");return new Px(t,e,i,n,s,Lp(r,!1).tokens)}function rk(r,e){let t=Ve(r);return r.expect("id","from"),new Lx(e,t,r.expect("string"))}function sk(r,e){let t=Ve(r),i=r.eat("id","as")?Ve(r):t;r.expect("id","from");let n=r.expect("string");return new Ix(e,i,t,n)}function Va(r){let e=/\\(?:u\{([\da-f]+)\}|u([\da-f]{4})|x([\da-f]{2})|([ntbrf0])|(.))|[^]/yig,t="",i;for(;i=e.exec(r);){let[n,s,o,a,l,h]=i;s||o||a?t+=String.fromCodePoint(parseInt(s||o||a,16)):l?t+=l=="n"?`
`:l=="t"?"	":l=="0"?"\0":l=="r"?"\r":l=="f"?"\f":"\b":h?t+=h:t+=n}return t}function Bn(r,e){return(r<<5)+r+e}function ok(r,e){for(let t=0;t<e.length;t++)r=Bn(r,e.charCodeAt(t));return r}const jn=typeof process<"u"&&Sx.LOG||"",nr=/\btime\b/.test(jn),ki=nr?(r,e)=>{let t=Date.now(),i=e();return console.log(`${r} (${((Date.now()-t)/1e3).toFixed(2)}s)`),i}:(r,e)=>e();class pi{constructor(e,t,i,n,s,o){this.rule=e,this.pos=t,this.ahead=i,this.ambigAhead=n,this.skipAhead=s,this.via=o,this.hash=0}finish(){let e=Bn(Bn(this.rule.id,this.pos),this.skipAhead.hash);for(let t of this.ahead)e=Bn(e,t.hash);for(let t of this.ambigAhead)e=ok(e,t);return this.hash=e,this}get next(){return this.pos<this.rule.parts.length?this.rule.parts[this.pos]:null}advance(){return new pi(this.rule,this.pos+1,this.ahead,this.ambigAhead,this.skipAhead,this.via).finish()}get skip(){return this.pos==this.rule.parts.length?this.skipAhead:this.rule.skip}cmp(e){return this.rule.cmp(e.rule)||this.pos-e.pos||this.skipAhead.hash-e.skipAhead.hash||_s(this.ahead,e.ahead,(t,i)=>t.cmp(i))||_s(this.ambigAhead,e.ambigAhead,lk)}eqSimple(e){return e.rule==this.rule&&e.pos==this.pos}toString(){let e=this.rule.parts.map(t=>t.name);return e.splice(this.pos,0,""),`${this.rule.name} -> ${e.join(" ")}`}eq(e){return this==e||this.hash==e.hash&&this.rule==e.rule&&this.pos==e.pos&&this.skipAhead==e.skipAhead&&Jc(this.ahead,e.ahead)&&Jc(this.ambigAhead,e.ambigAhead)}trail(e=60){let t=[];for(let n=this;n;n=n.via)for(let s=n.pos-1;s>=0;s--)t.push(n.rule.parts[s]);let i=t.reverse().join(" ");return i.length>e&&(i=i.slice(i.length-e).replace(/.*? /," ")),i}conflicts(e=this.pos){let t=this.rule.conflicts[e];return e==this.rule.parts.length&&this.ambigAhead.length&&(t=t.join(new Fe(0,this.ambigAhead))),t}static addOrigins(e,t){let i=e.slice();for(let n=0;n<i.length;n++){let s=i[n];if(s.pos==0)for(let o of t)o.next==s.rule.name&&!i.includes(o)&&i.push(o)}return i}}function Uc(r){let e=Fe.none;for(let t of r)e=e.join(t.conflicts());return e}function ak(r,e){for(let t of r)if(t.rule.name.repeated){for(let i of e)if(i.rule.name==t.rule.name){if(t.rule.isRepeatWrap&&t.pos==2)return 1;if(i.rule.isRepeatWrap&&i.pos==2)return-1}}return 0}function lk(r,e){return r<e?-1:r>e?1:0}function Kc(r,e,t,i){let n=[];for(let s=e+1;s<r.parts.length;s++){let o=r.parts[s],a=!1;if(o.terminal)Di(o,n);else for(let l of i[o.name])l==null?a=!0:Di(l,n);if(!a)return n}for(let s of t)Di(s,n);return n}function es(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].eq(e[t]))return!1;return!0}function Jc(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t])return!1;return!0}class vt{constructor(e,t){this.term=e,this.target=t}eq(e){return e instanceof vt&&this.term==e.term&&e.target.id==this.target.id}cmp(e){return e instanceof mi?-1:this.term.id-e.term.id||this.target.id-e.target.id}matches(e,t){return e instanceof vt&&t[e.target.id]==t[this.target.id]}toString(){return"s"+this.target.id}map(e,t){let i=t[e[this.target.id]];return i==this.target?this:new vt(this.term,i)}}class mi{constructor(e,t){this.term=e,this.rule=t}eq(e){return e instanceof mi&&this.term==e.term&&e.rule.sameReduce(this.rule)}cmp(e){return e instanceof vt?1:this.term.id-e.term.id||this.rule.name.id-e.rule.name.id||this.rule.parts.length-e.rule.parts.length}matches(e,t){return e instanceof mi&&e.rule.sameReduce(this.rule)}toString(){return`${this.rule.name.name}(${this.rule.parts.length})`}map(){return this}}function Wa(r){let e=5381;for(let t of r)e=Bn(e,t.hash);return e}class hk{constructor(e){this.first=e,this.conflicts=[]}}class Ip{constructor(e,t,i=0,n,s=Wa(t),o=null){this.id=e,this.set=t,this.flags=i,this.skip=n,this.hash=s,this.startRule=o,this.actions=[],this.actionPositions=[],this.goto=[],this.tokenGroup=-1,this.defaultReduce=null,this._actionsByTerm=null}toString(){let e=this.actions.map(t=>t.term+"="+t).join(",")+(this.goto.length?" | "+this.goto.map(t=>t.term+"="+t).join(","):"");return this.id+": "+this.set.filter(t=>t.pos>0).join()+(this.defaultReduce?`
  always ${this.defaultReduce.name}(${this.defaultReduce.parts.length})`:e.length?`
  `+e:"")}addActionInner(e,t){e:for(let i=0;i<this.actions.length;i++){let n=this.actions[i];if(n.term==e.term){if(n.eq(e))return null;let s=pi.addOrigins(t,this.set),o=pi.addOrigins(this.actionPositions[i],this.set),a=Uc(s),l=Uc(o),h=ak(s,o)||a.precedence-l.precedence;if(h>0){this.actions.splice(i,1),this.actionPositions.splice(i,1),i--;continue e}else{if(h<0)return null;if(a.ambigGroups.some(c=>l.ambigGroups.includes(c)))continue e;return n}}}return this.actions.push(e),this.actionPositions.push(t),null}addAction(e,t,i){let n=this.addActionInner(e,t);if(n){let s=this.actionPositions[this.actions.indexOf(n)][0],o=[t[0].rule.name,s.rule.name];if(i.conflicts.some(l=>l.rules.some(h=>o.includes(h))))return;let a;n instanceof vt?a=`shift/reduce conflict between
  ${s}
and
  ${t[0].rule}`:a=`reduce/reduce conflict between
  ${s.rule}
and
  ${t[0].rule}`,a+=`
With input:
  ${t[0].trail(70)}  ${e.term} `,n instanceof vt&&(a+=mk(t[0],n.term,i.first)),a+=pk(s,t[0]),i.conflicts.push(new dk(a,o))}}getGoto(e){return this.goto.find(t=>t.term==e)}hasSet(e){return es(this.set,e)}actionsByTerm(){let e=this._actionsByTerm;if(!e){this._actionsByTerm=e=Object.create(null);for(let t of this.actions)(e[t.term.id]||(e[t.term.id]=[])).push(t)}return e}finish(){if(this.actions.length){let e=this.actions[0];if(e instanceof mi){let{rule:t}=e;this.actions.every(i=>i instanceof mi&&i.rule.sameReduce(t))&&(this.defaultReduce=t)}}this.actions.sort((e,t)=>e.cmp(t)),this.goto.sort((e,t)=>e.cmp(t))}eq(e){let t=this.defaultReduce,i=e.defaultReduce;return t||i?t&&i?t.sameReduce(i):!1:this.skip==e.skip&&this.tokenGroup==e.tokenGroup&&es(this.actions,e.actions)&&es(this.goto,e.goto)}}function ck(r,e){let t=[],i=[];function n(o,a,l,h,c){for(let f of o.rules){let u=t.find(d=>d.rule==f);if(!u){let d=r.find(p=>p.pos==0&&p.rule==f);u=d?new pi(f,0,d.ahead.slice(),d.ambigAhead,d.skipAhead,d.via):new pi(f,0,[],Ha,h,c),t.push(u)}if(u.skipAhead!=h)throw new Ut("Inconsistent skip sets after "+c.trail());u.ambigAhead=As(u.ambigAhead,l);for(let d of a)u.ahead.includes(d)||(u.ahead.push(d),u.rule.parts.length&&!u.rule.parts[0].terminal&&Di(u,i))}}for(let o of r){let a=o.next;a&&!a.terminal&&n(a,Kc(o.rule,o.pos,o.ahead,e),o.conflicts(o.pos+1).ambigGroups,o.pos==o.rule.parts.length-1?o.skipAhead:o.rule.skip,o)}for(;i.length;){let o=i.pop();n(o.rule.parts[0],Kc(o.rule,0,o.ahead,e),As(o.rule.conflicts[1].ambigGroups,o.rule.parts.length==1?o.ambigAhead:Ha),o.rule.parts.length==1?o.skipAhead:o.rule.skip,o)}let s=r.slice();for(let o of t){o.ahead.sort((l,h)=>l.hash-h.hash),o.finish();let a=r.findIndex(l=>l.pos==0&&l.rule==o.rule);a>-1?s[a]=o:s.push(o)}return s.sort((o,a)=>o.cmp(a))}function Di(r,e){e.includes(r)||e.push(r)}function fk(r){let e=Object.create(null);for(let t of r.terms)t.terminal||(e[t.name]=[]);for(;;){let t=!1;for(let i of r.terms)if(!i.terminal)for(let n of i.rules){let s=e[i.name],o=!1,a=s.length;for(let l of n.parts){if(o=!0,l.terminal)Di(l,s);else for(let h of e[l.name])h==null?o=!1:Di(h,s);if(o)break}o||Di(null,s),s.length>a&&(t=!0)}if(!t)return e}}class uk{constructor(e,t){this.set=e,this.state=t}}class dk{constructor(e,t){this.error=e,this.rules=t}}function pk(r,e){if(r.eqSimple(e))return"";function t(i,n){let s=[];for(let o=n.via;!o.eqSimple(i);o=o.via)s.push(o);return s.length?(s.unshift(n),s.reverse().map((o,a)=>`
`+"  ".repeat(a+1)+(o==n?"":"via ")+o).join("")):""}for(let i=r;i;i=i.via)for(let n=e;n;n=n.via)if(i.eqSimple(n))return`
Shared origin: `+i+t(i,r)+t(i,e);return""}function mk(r,e,t){let i=r,n=[];for(;;){for(let a=i.pos-1;a>=0;a--)n.push(i.rule.parts[a]);if(!i.via)break;i=i.via}n.reverse();let s=new Set;function o(a,l,h){if(l==n.length&&h&&!a.next)return`
The reduction of ${r.rule.name} is allowed before ${e} because of this rule:
  ${h}`;for(let c;c=a.next;){if(l<n.length&&c==n[l]){let d=o(a.advance(),l+1,h);if(d)return d}let f=a.rule.parts[a.pos+1],u=a.pos+1==a.rule.parts.length?h:null;f&&(f.terminal?f==e:t[f.name].includes(e))&&(u=a.advance());for(let d of c.rules){let p=(d.id<<5)+l+(u?555:0);if(!s.has(p)){s.add(p);let m=o(new pi(d,0,[],[],c,a),l,u);if(m)return m}}if(!c.terminal&&t[c.name].includes(null))a=a.advance();else break}return""}return o(i,0,null)}function gk(r,e,t){let i=[],n={},s={},o=Date.now();function a(h,c){if(h.length==0)return null;let f=Wa(h),u=s[f],d;for(let y of h)if(!d)d=y.skip;else if(d!=y.skip)throw new Ut("Inconsistent skip sets after "+y.trail());if(u){for(let y of u)if(es(h,y.set)){if(y.state.skip!=d)throw new Ut("Inconsistent skip sets after "+y.set[0].trail());return y.state}}let p=ck(h,t),m=Wa(p),g=n[m]||(n[m]=[]),b;if(!c)for(let y of g)y.hasSet(p)&&(b=y);return b||(b=new Ip(i.length,p,0,d,m,c),g.push(b),i.push(b),nr&&i.length%500==0&&console.log(`${i.length} states after ${((Date.now()-o)/1e3).toFixed(2)}s`)),(s[f]||(s[f]=[])).push(new uk(h,b)),b}for(const h of e){const c=h.rules.length?h.rules[0].skip:r.names["%noskip"];a(h.rules.map(f=>new pi(f,0,[r.eof],Ha,c,null).finish()),h)}let l=new hk(t);for(let h=0;h<i.length;h++){let c=i[h],f=[],u=[],d=[];for(let m of c.set)if(m.pos==m.rule.parts.length)m.rule.name.top||d.push(m);else{let g=m.rule.parts[m.pos],b=f.indexOf(g);b<0?(f.push(g),u.push([m])):u[b].push(m)}for(let m=0;m<f.length;m++){let g=f[m],b=u[m].map(y=>y.advance());if(g.terminal){let y=bk(b),x=a(y);x&&c.addAction(new vt(g,x),u[m],l)}else{let y=a(b);y&&c.goto.push(new vt(g,y))}}let p=!1;for(let m of d)for(let g of m.ahead){let b=c.actions.length;c.addAction(new mi(g,m.rule),[m],l),c.actions.length==b&&(p=!0)}if(p)for(let m=0;m<c.goto.length;m++)t[c.goto[m].term.name].some(b=>c.actions.some(y=>y.term==b&&y instanceof vt))||c.goto.splice(m--,1)}if(l.conflicts.length)throw new Ut(l.conflicts.map(h=>h.error).join(`

`));for(let h of i)h.finish();return nr&&console.log(`${i.length} states total.`),i}function bk(r){let e=null,t=1;for(let i of r){let n=i.rule.conflicts[i.pos-1].cut;n<t||((!e||n>t)&&(t=n,e=[]),e.push(i))}return e||r}function Yc(r,e,t){for(let n of r.goto)for(let s of e.goto)if(n.term==s.term&&t[n.target.id]!=t[s.target.id])return!1;let i=e.actionsByTerm();for(let n of r.actions){let s=i[n.term.id];if(s&&s.some(o=>!o.matches(n,t))){if(s.length==1)return!1;let o=r.actionsByTerm()[n.term.id];if(o.length!=s.length||o.some(a=>!s.some(l=>a.matches(l,t))))return!1}}return!0}function yk(r,e){let t=[];for(let i of r){let n=e[i.id];t[n]||(t[n]=new Ip(n,i.set,0,i.skip,i.hash,i.startRule),t[n].tokenGroup=i.tokenGroup,t[n].defaultReduce=i.defaultReduce)}for(let i of r){let n=e[i.id],s=t[n];s.flags|=i.flags;for(let o=0;o<i.actions.length;o++){let a=i.actions[o].map(e,t);s.actions.some(l=>l.eq(a))||(s.actions.push(a),s.actionPositions.push(i.actionPositions[o]))}for(let o of i.goto){let a=o.map(e,t);s.goto.some(l=>l.eq(a))||s.goto.push(a)}}return t}class Xc{constructor(e,t){this.origin=e,this.members=[t]}}function vk(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].eqSimple(e[t]))return!1;return!0}function xk(r){let e=[],t=[];e:for(let n=0;n<r.length;n++){let s=r[n];if(!s.startRule)for(let o=0;o<t.length;o++){let a=t[o],l=r[a.members[0]];if(s.tokenGroup==l.tokenGroup&&s.skip==l.skip&&!l.startRule&&vk(s.set,l.set)){a.members.push(n),e.push(o);continue e}}e.push(t.length),t.push(new Xc(t.length,n))}function i(n,s){let o=t[n],a=r[o.members[s]],l=o.members.pop();s!=o.members.length&&(o.members[s]=l);for(let h=n+1;h<t.length;h++)if(e[a.id]=h,t[h].origin==o.origin&&t[h].members.every(c=>Yc(a,r[c],e))){t[h].members.push(a.id);return}e[a.id]=t.length,t.push(new Xc(o.origin,a.id))}for(let n=1;;n++){let s=!1,o=Date.now();for(let a=0,l=t.length;a<l;a++){let h=t[a];for(let c=0;c<h.members.length-1;c++)for(let f=c+1;f<h.members.length;f++){let u=h.members[c],d=h.members[f];Yc(r[u],r[d],e)||(s=!0,i(a,f--))}}if(nr&&console.log(`Collapse pass ${n}${s?"":", done"} (${((Date.now()-o)/1e3).toFixed(2)}s)`),!s)return yk(r,e)}}function kk(r){for(let e=1;;e++){let t=[],i=!1,n=Date.now(),s=[];for(let o=0;o<r.length;o++){let a=r[o],l=s.findIndex(h=>a.eq(h));if(l<0)t[o]=s.length,s.push(a);else{t[o]=l,i=!0;let h=s[l],c=null;for(let f of a.set)h.set.some(u=>u.eqSimple(f))||(c||(c=[])).push(f);c&&(h.set=c.concat(h.set).sort((f,u)=>f.cmp(u)))}}if(nr&&console.log(`Merge identical pass ${e}${i?"":", done"} (${((Date.now()-n)/1e3).toFixed(2)}s)`),!i)return r;for(let o of s)o.defaultReduce||(o.actions=o.actions.map(a=>a.map(t,s)),o.goto=o.goto.map(a=>a.map(t,s)));for(let o=0;o<s.length;o++)s[o].id=o;r=s}}const Ha=[];function wk(r){return kk(xk(r))}function Sk(r){let e=r+32;return e>=34&&e++,e>=92&&e++,String.fromCharCode(e)}function Qc(r,e=65535){if(r>e)throw new Error("Trying to encode a number that's too big: "+r);if(r==65535)return"~";let t="";for(let i=46;;i=0){let n=r%46,s=r-n;if(t=Sk(n+i)+t,s==0)break;r=s/46}return t}function Tn(r,e=65535){let t='"'+Qc(r.length,4294967295);for(let i=0;i<r.length;i++)t+=Qc(r[i],e);return t+='"',t}const Le=[];class Ct{constructor(e,t){this.terms=e,this.conflicts=t}concat(e){if(this==Ct.none)return e;if(e==Ct.none)return this;let t=null;if(this.conflicts||e.conflicts){t=this.conflicts?this.conflicts.slice():this.ensureConflicts();let i=e.ensureConflicts();t[t.length-1]=t[t.length-1].join(i[0]);for(let n=1;n<i.length;n++)t.push(i[n])}return new Ct(this.terms.concat(e.terms),t)}withConflicts(e,t){if(t==Fe.none)return this;let i=this.conflicts?this.conflicts.slice():this.ensureConflicts();return i[e]=i[e].join(t),new Ct(this.terms,i)}ensureConflicts(){if(this.conflicts)return this.conflicts;let e=[];for(let t=0;t<=this.terms.length;t++)e.push(Fe.none);return e}}Ct.none=new Ct(Le,null);function dt(...r){return new Ct(r,null)}class Es{constructor(e,t,i){this.id=e,this.args=t,this.term=i}matches(e){return this.id==e.id.name&&pr(e.args,this.args)}matchesRepeat(e){return this.id=="+"&&di(e.expr,this.args[0])}}class Ck{constructor(e,t){this.options=t,this.terms=new Fx,this.specialized=Object.create(null),this.tokenOrigins=Object.create(null),this.rules=[],this.built=[],this.ruleNames=Object.create(null),this.namespaces=Object.create(null),this.namedTerms=Object.create(null),this.termTable=Object.create(null),this.knownProps=Object.create(null),this.dynamicRulePrecedences=[],this.definedGroups=[],this.astRules=[],this.currentSkip=[],ki("Parse",()=>{this.input=new Kx(e,t.fileName),this.ast=this.input.parse()});let i=U;for(let n in i)i[n]instanceof U&&!i[n].perNode&&(this.knownProps[n]={prop:i[n],source:{name:n,from:null}});for(let n of this.ast.externalProps)this.knownProps[n.id.name]={prop:this.options.externalProp?this.options.externalProp(n.id.name):new U,source:{name:n.externalID.name,from:n.source}};this.dialects=this.ast.dialects.map(n=>n.name),this.tokens=new Lk(this,this.ast.tokens),this.localTokens=this.ast.localTokens.map(n=>new Ik(this,n)),this.externalTokens=this.ast.externalTokens.map(n=>new qa(this,n)),this.externalSpecializers=this.ast.externalSpecializers.map(n=>new Mo(this,n)),ki("Build rules",()=>{let n=this.newName("%noskip",!0);this.defineRule(n,[]);let s=this.ast.mainSkip?this.newName("%mainskip",!0):n,o=[],a=[];for(let l of this.ast.rules)this.astRules.push({skip:s,rule:l});for(let l of this.ast.topRules)a.push({skip:s,rule:l});for(let l of this.ast.scopedSkip){let h=n,c=this.ast.scopedSkip.findIndex((f,u)=>u<o.length&&di(f.expr,l.expr));c>-1?h=o[c]:this.ast.mainSkip&&di(l.expr,this.ast.mainSkip)?h=s:jp(l.expr)||(h=this.newName("%skip",!0)),o.push(h);for(let f of l.rules)this.astRules.push({skip:h,rule:f});for(let f of l.topRules)a.push({skip:h,rule:f})}for(let{rule:l}of this.astRules)this.unique(l.id);this.currentSkip.push(n),this.skipRules=s==n?[s]:[n,s],s!=n&&this.defineRule(s,this.normalizeExpr(this.ast.mainSkip));for(let l=0;l<this.ast.scopedSkip.length;l++){let h=o[l];this.skipRules.includes(h)||(this.skipRules.push(h),h!=n&&this.defineRule(h,this.normalizeExpr(this.ast.scopedSkip[l].expr)))}this.currentSkip.pop();for(let{rule:l,skip:h}of a.sort((c,f)=>c.rule.start-f.rule.start)){this.unique(l.id),this.used(l.id.name),this.currentSkip.push(h);let{name:c,props:f}=this.nodeInfo(l.props,"a",l.id.name,Le,Le,l.expr),u=this.terms.makeTop(c,f);this.namedTerms[c]=u,this.defineRule(u,this.normalizeExpr(l.expr)),this.currentSkip.pop()}for(let l of this.externalSpecializers)l.finish();for(let{skip:l,rule:h}of this.astRules)this.ruleNames[h.id.name]&&Hk(h)&&!h.params.length&&(this.buildRule(h,[],l,!1),h.expr instanceof ct&&h.expr.exprs.length==0&&this.used(h.id.name))});for(let n in this.ruleNames){let s=this.ruleNames[n];s&&this.warn(`Unused rule '${s.name}'`,s.start)}this.tokens.takePrecedences(),this.tokens.takeConflicts();for(let n of this.localTokens)n.takePrecedences();for(let{name:n,group:s,rule:o}of this.definedGroups)this.defineGroup(n,s,o);this.checkGroups()}unique(e){e.name in this.ruleNames&&this.raise(`Duplicate definition of rule '${e.name}'`,e.start),this.ruleNames[e.name]=e}used(e){this.ruleNames[e]=null}newName(e,t=null,i={}){for(let n=t?0:1;;n++){let s=n?`${e}-${n}`:e;if(!this.terms.names[s])return this.terms.makeNonTerminal(s,t===!0?null:t,i)}}prepareParser(){let e=ki("Simplify rules",()=>zk(this.rules,[...this.skipRules,...this.terms.tops])),{nodeTypes:t,names:i,minRepeatTerm:n,maxTerm:s}=this.terms.finish(e);for(let T in this.namedTerms)this.termTable[T]=this.namedTerms[T].id;/\bgrammar\b/.test(jn)&&console.log(e.join(`
`));let o=this.terms.tops.slice(),a=fk(this.terms),l=this.skipRules.map((T,F)=>{let V=[],H=[],ae=[];for(let le of T.rules){if(!le.parts.length)continue;let he=le.parts[0];for(let oe of he.terminal?[he]:a[he.name]||[])oe&&!H.includes(oe)&&H.push(oe);he.terminal&&le.parts.length==1&&!ae.some(oe=>oe!=le&&oe.parts[0]==he)?V.push(he):ae.push(le)}return T.rules=ae,ae.length&&o.push(T),{skip:V,rule:ae.length?T:null,startTokens:H,id:F}}),h=ki("Build full automaton",()=>gk(this.terms,o,a)),c=this.localTokens.map((T,F)=>T.buildLocalGroup(h,l,F)),{tokenGroups:f,tokenPrec:u,tokenData:d}=ki("Build token groups",()=>this.tokens.buildTokenGroups(h,l,c.length));for(let T of this.externalTokens)T.checkConflicts(h,l);let p=ki("Finish automaton",()=>wk(h)),m=Ek(p,this.terms.tops);/\blr\b/.test(jn)&&console.log(p.join(`
`));let g=[];for(let T of this.externalSpecializers)g.push(T);for(let T in this.specialized)g.push({token:this.terms.names[T],table:Ak(this.specialized[T])});let b=T=>T instanceof qa?T.ast.start:this.tokens.ast?this.tokens.ast.start:-1,y=f.concat(this.externalTokens).sort((T,F)=>b(T)-b(F)).concat(c),x=new Np,E=l.map(T=>{let F=[];for(let V of T.skip)F.push(V.id,0,4);if(T.rule){let V=p.find(H=>H.startRule==T.rule);for(let H of V.actions)F.push(H.term.id,V.id,2)}return F.push(65535,0),x.storeArray(F)}),A=ki("Finish states",()=>{let T=new Uint32Array(p.length*6),F=this.computeForceReductions(p,l),V=new _k(y,x,T,E,l,p,this);for(let H of p)V.finish(H,m(H.id),F[H.id]);return T}),O=Object.create(null);for(let T=0;T<this.dialects.length;T++)O[this.dialects[T]]=x.storeArray((this.tokens.byDialect[T]||Le).map(F=>F.id).concat(65535));let R=null;if(this.dynamicRulePrecedences.length){R=Object.create(null);for(let{rule:T,prec:F}of this.dynamicRulePrecedences)R[T.id]=F}let K=Object.create(null);for(let T of this.terms.tops)K[T.nodeName]=[p.find(F=>F.startRule==T).id,T.id];let z=x.storeArray(u.concat(65535)),{nodeProps:Y,skippedTypes:W}=this.gatherNodeProps(t);return{states:A,stateData:x.finish(),goto:Ok(p),nodeNames:t.filter(T=>T.id<n).map(T=>T.nodeName).join(" "),nodeProps:Y,skippedTypes:W,maxTerm:s,repeatNodeCount:t.length-n,tokenizers:y,tokenData:d,topRules:K,dialects:O,dynamicPrecedences:R,specialized:g,tokenPrec:z,termNames:i}}getParser(){let{states:e,stateData:t,goto:i,nodeNames:n,nodeProps:s,skippedTypes:o,maxTerm:a,repeatNodeCount:l,tokenizers:h,tokenData:c,topRules:f,dialects:u,dynamicPrecedences:d,specialized:p,tokenPrec:m,termNames:g}=this.prepareParser(),b=p.map(y=>{if(y instanceof Mo){let x=this.options.externalSpecializer(y.ast.id.name,this.termTable);return{term:y.term.id,get:(E,A)=>x(E,A)<<1|(y.ast.type=="extend"?1:0),external:x,extend:y.ast.type=="extend"}}else return{term:y.token.id,get:x=>y.table[x]||-1}});return Cs.deserialize({version:14,states:e,stateData:t,goto:i,nodeNames:n,maxTerm:a,repeatNodeCount:l,nodeProps:s.map(({prop:y,terms:x})=>[this.knownProps[y].prop,...x]),propSources:this.options.externalPropSource?this.ast.externalPropSources.map(y=>this.options.externalPropSource(y.id.name)):void 0,skippedNodes:o,tokenData:c,tokenizers:h.map(y=>y.create()),context:this.ast.context?typeof this.options.contextTracker=="function"?this.options.contextTracker(this.termTable):this.options.contextTracker:void 0,topRules:f,dialects:u,dynamicPrecedences:d,specialized:b,tokenPrec:m,termNames:g})}getParserFile(){let{states:e,stateData:t,goto:i,nodeNames:n,nodeProps:s,skippedTypes:o,maxTerm:a,repeatNodeCount:l,tokenizers:h,tokenData:c,topRules:f,dialects:u,dynamicPrecedences:d,specialized:p,tokenPrec:m,termNames:g}=this.prepareParser(),b=this.options.moduleStyle||"es",y=`// This file was generated by lezer-generator. You probably shouldn't edit it.
`,x=y,E={},A=Object.create(null),O=Object.create(null);for(let w of rf)O[w]=!0;let R=this.options.exportName||"parser";O[R]=!0;let K=w=>{for(let M=0;;M++){let j=w+(M?"_"+M:"");if(!O[j])return j}},z=(w,M,j=w)=>{let q=w+" from "+M;if(A[q])return A[q];let G=JSON.stringify(M),Q=w;return w in O&&(Q=K(j),w+=`${b=="cjs"?":":" as"} ${Q}`),O[Q]=!0,(E[G]||(E[G]=[])).push(w),A[q]=Q},Y=z("LRParser","@lezer/lr"),W=h.map(w=>w.createSource(z)),T=this.ast.context?z(this.ast.context.id.name,this.ast.context.source):null,F=s.map(({prop:w,terms:M})=>{let{source:j}=this.knownProps[w];return`[${j.from?z(j.name,j.from):JSON.stringify(j.name)}, ${M.map(he).join(",")}]`});function V(w){return"{__proto__:null,"+Object.keys(w).map(M=>`${/^(\d+|[a-zA-Z_]\w*)$/.test(M)?M:JSON.stringify(M)}:${w[M]}`).join(", ")+"}"}let H="",ae=p.map(w=>{if(w instanceof Mo){let M=z(w.ast.id.name,w.ast.source),j=this.options.typeScript?": any":"";return`{term: ${w.term.id}, get: (value${j}, stack${j}) => (${M}(value, stack) << 1)${w.ast.type=="extend"?" | 1":""}, external: ${M}${w.ast.type=="extend"?", extend: true":""}}`}else{let M=K("spec_"+w.token.name.replace(/\W/g,""));O[M]=!0,H+=`const ${M} = ${V(w.table)}
`;let j=this.options.typeScript?`: keyof typeof ${M}`:"";return`{term: ${w.token.id}, get: (value${j}) => ${M}[value] || -1}`}}),le=this.ast.externalPropSources.map(w=>z(w.id.name,w.source));for(let w in E)b=="cjs"?x+=`const {${E[w].join(", ")}} = require(${w})
`:x+=`import {${E[w].join(", ")}} from ${w}
`;x+=H;function he(w){return typeof w!="string"||/^(true|false|\d+(\.\d+)?|\.\d+)$/.test(w)?w:JSON.stringify(w)}let oe=Object.keys(u).map(w=>`${w}: ${u[w]}`),ke=`${Y}.deserialize({
  version: 14,
  states: ${Tn(e,4294967295)},
  stateData: ${Tn(t)},
  goto: ${Tn(i)},
  nodeNames: ${JSON.stringify(n)},
  maxTerm: ${a}${T?`,
  context: ${T}`:""}${F.length?`,
  nodeProps: [
    ${F.join(`,
    `)}
  ]`:""}${le.length?`,
  propSources: [${le.join()}]`:""}${o.length?`,
  skippedNodes: ${JSON.stringify(o)}`:""},
  repeatNodeCount: ${l},
  tokenData: ${Tn(c)},
  tokenizers: [${W.join(", ")}],
  topRules: ${JSON.stringify(f)}${oe.length?`,
  dialects: {${oe.join(", ")}}`:""}${d?`,
  dynamicPrecedences: ${JSON.stringify(d)}`:""}${ae.length?`,
  specialized: [${ae.join(",")}]`:""},
  tokenPrec: ${m}${this.options.includeNames?`,
  termNames: ${JSON.stringify(g)}`:""}
})`,Te=[];for(let w in this.termTable){let M=w;if(rf.includes(M))for(let j=1;M="_".repeat(j)+w,M in this.termTable;j++);else if(!/^[\w$]+$/.test(w))continue;Te.push(`${M}${b=="cjs"?":":" ="} ${this.termTable[w]}`)}for(let w=0;w<this.dialects.length;w++)Te.push(`Dialect_${this.dialects[w]}${b=="cjs"?":":" ="} ${w}`);return{parser:x+(b=="cjs"?`exports.${R} = ${ke}
`:`export const ${R} = ${ke}
`),terms:b=="cjs"?`${y}module.exports = {
  ${Te.join(`,
  `)}
}`:`${y}export const
  ${Te.join(`,
  `)}
`}}gatherNonSkippedNodes(){let e=Object.create(null),t=[],i=n=>{e[n.id]||(e[n.id]=!0,t.push(n))};this.terms.tops.forEach(i);for(let n=0;n<t.length;n++)for(let s of t[n].rules)for(let o of s.parts)i(o);return e}gatherNodeProps(e){let t=this.gatherNonSkippedNodes(),i=[],n=[];for(let s of e){!t[s.id]&&!s.error&&i.push(s.id);for(let o in s.props){let a=this.knownProps[o];if(!a)throw new Ut("No known prop type for "+o);if(a.source.from==null&&(a.source.name=="repeated"||a.source.name=="error"))continue;let l=n.find(h=>h.prop==o);l||n.push(l={prop:o,values:{}}),(l.values[s.props[o]]||(l.values[s.props[o]]=[])).push(s.id)}}return{nodeProps:n.map(({prop:s,values:o})=>{let a=[];for(let l in o){let h=o[l];if(h.length==1)a.push(h[0],l);else{a.push(-h.length);for(let c of h)a.push(c);a.push(l)}}return{prop:s,terms:a}}),skippedTypes:i}}makeTerminal(e,t,i){return this.terms.makeTerminal(this.terms.uniqueName(e),t,i)}computeForceReductions(e,t){let i=[],n=[],s=Object.create(null);for(let l of e){i.push(0);for(let h of l.goto){let c=s[h.term.id]||(s[h.term.id]=[]),f=c.find(u=>u.target==h.target.id);f?f.parents.push(l.id):c.push({parents:[l.id],target:h.target.id})}n[l.id]=l.set.filter(h=>h.pos>0&&!h.rule.name.top).sort((h,c)=>c.pos-h.pos||h.rule.parts.length-c.rule.parts.length)}let o=Object.create(null);function a(l,h,c=null){let f=s[l];return f?f.some(u=>{let d=c?c.filter(m=>u.parents.includes(m)):u.parents;if(d.length==0)return!1;if(u.target==h)return!0;let p=o[u.target];return p!=null&&a(p,h,d)}):!1}for(let l of e)l.defaultReduce&&l.defaultReduce.parts.length>0&&(i[l.id]=Fn(l.defaultReduce,t),l.defaultReduce.parts.length==1&&(o[l.id]=l.defaultReduce.name.id));for(let l=1;;l++){let h=!0;for(let c of e){if(c.defaultReduce)continue;let f=n[c.id];if(f.length!=l){f.length>l&&(h=!1);continue}for(let u of f)if(u.pos!=1||!a(u.rule.name.id,c.id)){i[c.id]=Fn(u.rule,t,u.pos),u.pos==1&&(o[c.id]=u.rule.name.id);break}}if(h)break}return i}substituteArgs(e,t,i){return t.length==0?e:e.walk(n=>{let s;if(n instanceof Ke&&(s=i.findIndex(o=>o.name==n.id.name))>-1){let o=t[s];if(n.args.length){if(o instanceof Ke&&!o.args.length)return new Ke(n.start,o.id,n.args);this.raise("Passing arguments to a parameter that already has arguments",n.start)}return o}else if(n instanceof Ri){let o=n.rule,a=this.substituteArgsInProps(o.props,t,i);return a==o.props?n:new Ri(n.start,new Rl(o.start,o.id,a,o.params,o.expr))}else if(n instanceof Qi){let o=this.substituteArgsInProps(n.props,t,i);return o==n.props?n:new Qi(n.start,n.type,o,n.token,n.content)}return n})}substituteArgsInProps(e,t,i){let n=o=>{let a=o;for(let l=0;l<o.length;l++){let h=o[l];if(!h.name)continue;let c=i.findIndex(u=>u.name==h.name);if(c<0)continue;a==o&&(a=o.slice());let f=t[c];f instanceof Ke&&!f.args.length?a[l]=new In(h.start,f.id.name,null):f instanceof mt?a[l]=new In(h.start,f.value,null):this.raise(`Trying to interpolate expression '${f}' into a prop`,h.start)}return a},s=e;for(let o=0;o<e.length;o++){let a=e[o],l=n(a.value);l!=a.value&&(s==e&&(s=e.slice()),s[o]=new Ws(a.start,a.at,a.name,l))}return s}conflictsFor(e){let t=Fe.none,i=Fe.none;for(let n of e)if(n.type=="ambig")t=t.join(new Fe(0,[n.id.name]));else{let s=this.ast.precedences,o=s?s.items.findIndex(h=>h.id.name==n.id.name):-1;o<0&&this.raise(`Reference to unknown precedence: '${n.id.name}'`,n.id.start);let a=s.items[o],l=s.items.length-o;a.type=="cut"?t=t.join(new Fe(0,Le,l)):(t=t.join(new Fe(l<<2)),i=i.join(new Fe((l<<2)+(a.type=="left"?1:a.type=="right"?-1:0))))}return{here:t,atEnd:i}}raise(e,t=1){return this.input.raise(e,t)}warn(e,t=-1){let i=this.input.message(e,t);this.options.warn?this.options.warn(i):console.warn(i)}defineRule(e,t){let i=this.currentSkip[this.currentSkip.length-1];for(let n of t)this.rules.push(new Ll(e,n.terms,n.ensureConflicts(),i))}resolve(e){for(let n of this.built)if(n.matches(e))return[dt(n.term)];let t=this.tokens.getToken(e);if(t)return[dt(t)];for(let n of this.localTokens){let s=n.getToken(e);if(s)return[dt(s)]}for(let n of this.externalTokens){let s=n.getToken(e);if(s)return[dt(s)]}for(let n of this.externalSpecializers){let s=n.getToken(e);if(s)return[dt(s)]}let i=this.astRules.find(n=>n.rule.id.name==e.id.name);return i?(i.rule.params.length!=e.args.length&&this.raise(`Wrong number or arguments for '${e.id.name}'`,e.start),this.used(i.rule.id.name),[dt(this.buildRule(i.rule,e.args,i.skip))]):this.raise(`Reference to undefined rule '${e.id.name}'`,e.start)}normalizeRepeat(e){let t=this.built.find(s=>s.matchesRepeat(e));if(t)return dt(t.term);let i=e.expr.prec<e.prec?`(${e.expr})+`:`${e.expr}+`,n=this.terms.makeRepeat(this.terms.uniqueName(i));return this.built.push(new Es("+",[e.expr],n)),this.defineRule(n,this.normalizeExpr(e.expr).concat(dt(n,n))),dt(n)}normalizeSequence(e){let t=e.exprs.map(s=>this.normalizeExpr(s)),i=this;function n(s,o,a){let{here:l,atEnd:h}=i.conflictsFor(e.markers[o]);if(o==t.length)return[s.withConflicts(s.terms.length,l.join(a))];let c=[];for(let f of t[o])for(let u of n(s.concat(f).withConflicts(s.terms.length,l),o+1,a.join(h)))c.push(u);return c}return n(Ct.none,0,Fe.none)}normalizeExpr(e){if(e instanceof Ni&&e.kind=="?")return[Ct.none,...this.normalizeExpr(e.expr)];if(e instanceof Ni){let t=this.normalizeRepeat(e);return e.kind=="+"?[t]:[Ct.none,t]}else return e instanceof oi?e.exprs.reduce((t,i)=>t.concat(this.normalizeExpr(i)),[]):e instanceof ct?this.normalizeSequence(e):e instanceof mt?[dt(this.tokens.getLiteral(e))]:e instanceof Ke?this.resolve(e):e instanceof Qi?[dt(this.resolveSpecialization(e))]:e instanceof Ri?[dt(this.buildRule(e.rule,Le,this.currentSkip[this.currentSkip.length-1],!0))]:this.raise(`This type of expression ('${e}') may not occur in non-token rules`,e.start)}buildRule(e,t,i,n=!1){let s=this.substituteArgs(e.expr,t,e.params),{name:o,props:a,dynamicPrec:l,inline:h,group:c,exported:f}=this.nodeInfo(e.props||Le,n?"pg":"pgi",e.id.name,t,e.params,e.expr);f&&e.params.length&&this.warn("Can't export parameterized rules",e.start),f&&n&&this.warn("Can't export inline rule",e.start);let u=this.newName(e.id.name+(t.length?"<"+t.join(",")+">":""),o||!0,a);h&&(u.inline=!0),l&&this.registerDynamicPrec(u,l),(u.nodeType||f)&&e.params.length==0&&(o||(u.preserve=!0),n||(this.namedTerms[f||e.id.name]=u)),n||this.built.push(new Es(e.id.name,t,u)),this.currentSkip.push(i);let d=this.normalizeExpr(s);return d.length>100*(s instanceof oi?s.exprs.length:1)&&this.warn(`Rule ${e.id.name} is generating a lot (${d.length}) of choices.
  Consider splitting it up or reducing the amount of ? or | operator uses.`,e.start),/\brulesize\b/.test(jn)&&d.length>10&&console.log(`Rule ${e.id.name}: ${d.length} variants`),this.defineRule(u,d),this.currentSkip.pop(),c&&this.definedGroups.push({name:u,group:c,rule:e}),u}nodeInfo(e,t,i=null,n=Le,s=Le,o,a){let l={},h=i&&(t.indexOf("a")>-1||!Wk(i))&&!/ /.test(i)?i:null,c=null,f=0,u=!1,d=null,p=null;for(let m of e)if(m.at)if(m.name=="name")h=this.finishProp(m,n,s),/ /.test(h)&&this.raise(`Node names cannot have spaces ('${h}')`,m.start);else if(m.name=="dialect"){t.indexOf("d")<0&&this.raise("Can't specify a dialect on non-token rules",e[0].start),m.value.length!=1&&!m.value[0].value&&this.raise("The '@dialect' rule prop must hold a plain string value");let g=this.dialects.indexOf(m.value[0].value);g<0&&this.raise(`Unknown dialect '${m.value[0].value}'`,m.value[0].start),c=g}else m.name=="dynamicPrecedence"?(t.indexOf("p")<0&&this.raise("Dynamic precedence can only be specified on nonterminals"),(m.value.length!=1||!/^-?(?:10|\d)$/.test(m.value[0].value))&&this.raise("The '@dynamicPrecedence' rule prop must hold an integer between -10 and 10"),f=+m.value[0].value):m.name=="inline"?(m.value.length&&this.raise("'@inline' doesn't take a value",m.value[0].start),t.indexOf("i")<0&&this.raise("Inline can only be specified on nonterminals"),u=!0):m.name=="isGroup"?(t.indexOf("g")<0&&this.raise("'@isGroup' can only be specified on nonterminals"),d=m.value.length?this.finishProp(m,n,s):i):m.name=="export"?m.value.length?p=this.finishProp(m,n,s):p=i:this.raise(`Unknown built-in prop name '@${m.name}'`,m.start);else{if(!this.knownProps[m.name]){let g=["name","dialect","dynamicPrecedence","export","isGroup"].includes(m.name)?` (did you mean '@${m.name}'?)`:"";this.raise(`Unknown prop name '${m.name}'${g}`,m.start)}l[m.name]=this.finishProp(m,n,s)}if(o&&this.ast.autoDelim&&(h||_n(l))){let m=this.findDelimiters(o);m&&(Zc(m[0],"closedBy",m[1].nodeName),Zc(m[1],"openedBy",m[0].nodeName))}if(a&&_n(a))for(let m in a)m in l||(l[m]=a[m]);return _n(l)&&!h&&this.raise("Node has properties but no name",e.length?e[0].start:o.start),u&&(_n(l)||c||f)&&this.raise("Inline nodes can't have props, dynamic precedence, or a dialect",e[0].start),u&&h&&(h=null),{name:h,props:l,dialect:c,dynamicPrec:f,inline:u,group:d,exported:p}}finishProp(e,t,i){return e.value.map(n=>{if(n.value)return n.value;let s=i.findIndex(a=>a.name==n.name);s<0&&this.raise(`Property refers to '${n.name}', but no parameter by that name is in scope`,n.start);let o=t[s];return o instanceof Ke&&!o.args.length?o.id.name:o instanceof mt?o.value:this.raise(`Expression '${o}' can not be used as part of a property value`,n.start)}).join("")}resolveSpecialization(e){let t=e.type,{name:i,props:n,dialect:s,exported:o}=this.nodeInfo(e.props,"d"),a=this.normalizeExpr(e.token);(a.length!=1||a[0].terms.length!=1||!a[0].terms[0].terminal)&&this.raise(`The first argument to '${t}' must resolve to a token`,e.token.start);let l,h;if((h=ts(e.content))!=null)l=[h];else if(e.content instanceof oi&&e.content.exprs.every(d=>ts(d)!=null))l=e.content.exprs.map(ts);else return this.raise(`The second argument to '${e.type}' must be a literal or choice of literals`,e.content.start);let c=a[0].terms[0],f=null,u=this.specialized[c.name]||(this.specialized[c.name]=[]);for(let d of l){let p=u.find(m=>m.value==d);p==null?(f||(f=this.makeTerminal(c.name+"/"+JSON.stringify(d),i,n),s!=null&&(this.tokens.byDialect[s]||(this.tokens.byDialect[s]=[])).push(f)),u.push({value:d,term:f,type:t,dialect:s,name:i}),this.tokenOrigins[f.name]={spec:c},(i||o)&&(i||(f.preserve=!0),this.namedTerms[o||i]=f)):(p.type!=t&&this.raise(`Conflicting specialization types for ${JSON.stringify(d)} of ${c.name} (${t} vs ${p.type})`,e.start),p.dialect!=s&&this.raise(`Conflicting dialects for specialization ${JSON.stringify(d)} of ${c.name}`,e.start),p.name!=i&&this.raise(`Conflicting names for specialization ${JSON.stringify(d)} of ${c.name}`,e.start),f&&p.term!=f&&this.raise(`Conflicting specialization tokens for ${JSON.stringify(d)} of ${c.name}`,e.start),f=p.term)}return f}findDelimiters(e){if(!(e instanceof ct)||e.exprs.length<2)return null;let t=a=>{if(a instanceof mt)return{term:this.tokens.getLiteral(a),str:a.value};if(a instanceof Ke&&a.args.length==0){let l=this.ast.rules.find(c=>c.id.name==a.id.name);if(l)return t(l.expr);let h=this.tokens.rules.find(c=>c.id.name==a.id.name);if(h&&h.expr instanceof mt)return{term:this.tokens.getToken(a),str:h.expr.value}}return null},i=t(e.exprs[e.exprs.length-1]);if(!i||!i.term.nodeName)return null;let s=["()","[]","{}","<>"].find(a=>i.str.indexOf(a[1])>-1&&i.str.indexOf(a[0])<0);if(!s)return null;let o=t(e.exprs[0]);return!o||!o.term.nodeName||o.str.indexOf(s[0])<0||o.str.indexOf(s[1])>-1?null:[o.term,i.term]}registerDynamicPrec(e,t){this.dynamicRulePrecedences.push({rule:e,prec:t}),e.preserve=!0}defineGroup(e,t,i){var n;let s=[],o=a=>{if(a.nodeName)return[a];s.includes(a)&&this.raise(`Rule '${i.id.name}' cannot define a group because it contains a non-named recursive rule ('${a.name}')`,i.start);let l=[];s.push(a);for(let h of this.rules)if(h.name==a){let c=h.parts.map(o).filter(f=>f.length);if(c.length>1&&this.raise(`Rule '${i.id.name}' cannot define a group because some choices produce multiple named nodes`,i.start),c.length==1)for(let f of c[0])l.push(f)}return s.pop(),l};for(let a of o(e))a.props.group=(((n=a.props.group)===null||n===void 0?void 0:n.split(" "))||[]).concat(t).sort().join(" ")}checkGroups(){let e=Object.create(null),t=Object.create(null);for(let n of this.terms.terms)if(n.nodeName&&(t[n.nodeName]=!0,n.props.group))for(let s of n.props.group.split(" "))(e[s]||(e[s]=[])).push(n);let i=Object.keys(e);for(let n=0;n<i.length;n++){let s=i[n],o=e[s];t[s]&&this.warn(`Group name '${s}' conflicts with a node of the same name`);for(let a=n+1;a<i.length;a++){let l=e[i[a]];o.some(h=>l.includes(h))&&(o.length>l.length?l.some(h=>!o.includes(h)):o.some(h=>!l.includes(h)))&&this.warn(`Groups '${s}' and '${i[a]}' overlap without one being a superset of the other`)}}}}function ts(r){if(r instanceof mt)return r.value;if(r instanceof ct){let e="";for(let t of r.exprs){let i=ts(t);if(i==null)return null;e+=i}return e}return null}const _o=5;class _k{constructor(e,t,i,n,s,o,a){this.tokenizers=e,this.data=t,this.stateArray=i,this.skipData=n,this.skipInfo=s,this.states=o,this.builder=a,this.sharedActions=[]}findSharedActions(e){if(e.actions.length<_o)return null;let t=null;for(let o of this.sharedActions)(!t||o.actions.length>t.actions.length)&&o.actions.every(a=>e.actions.some(l=>l.eq(a)))&&(t=o);if(t)return t;let i=null,n=[];for(let o=e.id+1;o<this.states.length;o++){let a=this.states[o],l=0;if(!(a.defaultReduce||a.actions.length<_o)){for(let h of e.actions)for(let c of a.actions)h.eq(c)&&(n[l++]=h);l>=_o&&(!i||i.length<l)&&(i=n,n=[])}}if(!i)return null;let s={actions:i,addr:this.storeActions(i,-1,null)};return this.sharedActions.push(s),s}storeActions(e,t,i){if(t<0&&i&&i.actions.length==e.length)return i.addr;let n=[];for(let s of e)if(!(i&&i.actions.some(o=>o.eq(s))))if(s instanceof vt)n.push(s.term.id,s.target.id,0);else{let o=Fn(s.rule,this.skipInfo);o!=t&&n.push(s.term.id,o&65535,o>>16)}return n.push(65535),t>-1?n.push(2,t&65535,t>>16):i?n.push(1,i.addr&65535,i.addr>>16):n.push(0),this.data.storeArray(n)}finish(e,t,i){let n=this.builder,s=n.skipRules.indexOf(e.skip),o=this.skipData[s],a=this.skipInfo[s].startTokens,l=e.defaultReduce?Fn(e.defaultReduce,this.skipInfo):0,h=t?1:0,c=-1,f=null;if(l==0){if(t)for(const m of e.actions)m instanceof mi&&m.term.eof&&(c=Fn(m.rule,this.skipInfo));c<0&&(f=this.findSharedActions(e))}e.set.some(m=>m.rule.name.top&&m.pos==m.rule.parts.length)&&(h|=2);let u=[];for(let m=0;m<e.actions.length+a.length;m++){let g=m<e.actions.length?e.actions[m].term:a[m-e.actions.length];for(;;){let b=n.tokenOrigins[g.name];if(b&&b.spec){g=b.spec;continue}b&&b.external instanceof qa&&En(u,b.external);break}}let d=0;for(let m=0;m<this.tokenizers.length;m++){let g=this.tokenizers[m];(u.includes(g)||g.groupID==e.tokenGroup)&&(d|=1<<m)}let p=e.id*6;this.stateArray[p+0]=h,this.stateArray[p+1]=this.storeActions(l?Le:e.actions,c,f),this.stateArray[p+2]=o,this.stateArray[p+3]=d,this.stateArray[p+4]=l,this.stateArray[p+5]=i}}function Zc(r,e,t){let i=r.props[e];(!i||i.split(" ").indexOf(t)<0)&&(r.props[e]=i?i+" "+t:t)}function Ak(r){let e=Object.create(null);for(let{value:t,term:i,type:n}of r){let s=n=="specialize"?0:1;e[t]=i.id<<1|s}return e}function Fn(r,e,t=r.parts.length){return r.name.id|65536|(r.isRepeatWrap&&t==r.parts.length?131072:0)|(e.some(i=>i.rule==r.name)?262144:0)|t<<19}function Tk(r,e){e:for(let t=0;;){let i=r.indexOf(e[0],t);if(i==-1||i+e.length>r.length)break;for(let n=1;n<e.length;n++)if(e[n]!=r[i+n]){t=i+1;continue e}return i}return-1}function Ek(r,e){let t=Object.create(null),i=[],n=s=>{t[s.id]||(t[s.id]=!0,i.push(s))};for(let s of r)s.startRule&&e.includes(s.startRule)&&n(s);for(let s=0;s<i.length;s++){for(let o of i[s].actions)o instanceof vt&&n(o.target);for(let o of i[s].goto)n(o.target)}return s=>!t[s]}class Np{constructor(){this.data=[]}storeArray(e){let t=Tk(this.data,e);if(t>-1)return t;let i=this.data.length;for(let n of e)this.data.push(n);return i}finish(){return Uint16Array.from(this.data)}}function Ok(r){let e={},t=0;for(let o of r)for(let a of o.goto){t=Math.max(a.term.id,t);let l=e[a.term.id]||(e[a.term.id]={});(l[a.target.id]||(l[a.target.id]=[])).push(o.id)}let i=new Np,n=[],s=t+2;for(let o=0;o<=t;o++){let a=e[o];if(!a){n.push(1);continue}let l=[],h=Object.keys(a);for(let c of h){let f=a[c];l.push((c==h[h.length-1]?1:0)+(f.length<<1)),l.push(+c);for(let u of f)l.push(u)}n.push(i.storeArray(l)+s)}if(n.some(o=>o>65535))throw new Ut("Goto table too large");return Uint16Array.from([t+1,...n,...i.data])}class Mk{constructor(e,t){this.tokens=e,this.groupID=t}create(){return this.groupID}createSource(){return String(this.groupID)}}function En(r,e){r.includes(e)||r.push(e)}function Rk(r){let e=Object.create(null);for(let t of r){let i=1<<t.groupID;for(let n of t.tokens)e[n.id]=(e[n.id]||0)|i}return e}class Dk{constructor(e,t,i){this.name=e,this.expr=t,this.scope=i}}class Pk{constructor(e,t,i,n){this.name=e,this.start=t,this.to=i,this.args=n}}class Bp{constructor(e,t){this.b=e,this.ast=t,this.startState=new ht,this.built=[],this.building=[],this.byDialect=Object.create(null),this.precedenceRelations=[],this.rules=t?t.rules:Le;for(let i of this.rules)e.unique(i.id)}getToken(e){for(let h of this.built)if(h.matches(e))return h.term;let t=e.id.name,i=this.rules.find(h=>h.id.name==t);if(!i)return null;let{name:n,props:s,dialect:o,exported:a}=this.b.nodeInfo(i.props,"d",t,e.args,i.params.length!=e.args.length?Le:i.params),l=this.b.makeTerminal(e.toString(),n,s);return o!=null&&(this.byDialect[o]||(this.byDialect[o]=[])).push(l),(l.nodeType||a)&&i.params.length==0&&(l.nodeType||(l.preserve=!0),this.b.namedTerms[a||t]=l),this.buildRule(i,e,this.startState,new ht([l])),this.built.push(new Es(t,e.args,l)),l}buildRule(e,t,i,n,s=Le){let o=t.id.name;e.params.length!=t.args.length&&this.b.raise(`Incorrect number of arguments for token '${o}'`,t.start);let a=this.building.find(h=>h.name==o&&pr(t.args,h.args));if(a){if(a.to==n){i.nullEdge(a.start);return}let h=this.building.length-1;for(;this.building[h].name!=o;)h--;this.b.raise(`Invalid (non-tail) recursion in token rules: ${this.building.slice(h).map(c=>c.name).join(" -> ")}`,t.start)}this.b.used(e.id.name);let l=new ht;i.nullEdge(l),this.building.push(new Pk(o,l,n,t.args)),this.build(this.b.substituteArgs(e.expr,t.args,e.params),l,n,t.args.map((h,c)=>new Dk(e.params[c].name,h,s))),this.building.pop()}build(e,t,i,n){if(e instanceof Ke){let s=e.id.name,o=n.find(l=>l.name==s);if(o)return this.build(o.expr,t,i,o.scope);let a;for(let l=0,h=this.b.localTokens;l<=h.length&&(a=(l==h.length?this.b.tokens:h[l]).rules.find(f=>f.id.name==s),!a);l++);if(!a)return this.b.raise(`Reference to token rule '${s}', which isn't found`,e.start);this.buildRule(a,e,t,i,n)}else if(e instanceof $a)for(let[s,o]of Fa[e.type])t.edge(s,o,i);else if(e instanceof oi)for(let s of e.exprs)this.build(s,t,i,n);else if(jp(e))t.nullEdge(i);else if(e instanceof ct){let s=e.markers.find(o=>o.length>0);s&&this.b.raise("Conflict marker in token expression",s[0].start);for(let o=0;o<e.exprs.length;o++){let a=o==e.exprs.length-1?i:new ht;this.build(e.exprs[o],t,a,n),t=a}}else if(e instanceof Ni)if(e.kind=="*"){let s=new ht;t.nullEdge(s),this.build(e.expr,s,s,n),s.nullEdge(i)}else if(e.kind=="+"){let s=new ht;this.build(e.expr,t,s,n),this.build(e.expr,s,s,n),s.nullEdge(i)}else t.nullEdge(i),this.build(e.expr,t,i,n);else if(e instanceof Ep)for(let[s,o]of e.inverted?Bk(e.ranges):e.ranges)jk(t,i,s,o);else if(e instanceof mt)for(let s=0;s<e.value.length;s++){let o=e.value.charCodeAt(s),a=s==e.value.length-1?i:new ht;t.edge(o,o+1,a),t=a}else if(e instanceof Op){let s=new ht;t.edge(0,56320,i),t.edge(56320,Il+1,i),t.edge(55296,56320,s),s.edge(56320,57344,i)}else return this.b.raise("Unrecognized expression type in token",e.start)}takePrecedences(){let e=this.precedenceRelations=[];if(this.ast)for(let t of this.ast.precedences){let i=[];for(let n of t.items){let s=[];if(n instanceof Ke)for(let o of this.built)(n.args.length?o.matches(n):o.id==n.id.name)&&s.push(o.term);else{let o=JSON.stringify(n.value),a=this.built.find(l=>l.id==o);a&&s.push(a.term)}s.length||this.b.warn(`Precedence specified for unknown token ${n}`,n.start);for(let o of s)Oo(e,o,i);i=i.concat(s)}}}precededBy(e,t){let i=this.precedenceRelations.find(n=>n.term==e);return i&&i.after.includes(t)}buildPrecTable(e){let t=[],i=this.precedenceRelations.slice();for(let{a:n,b:s,soft:o}of e)if(o){if(!i.some(a=>a.term==n)||!i.some(a=>a.term==s))continue;o<0&&([n,s]=[s,n]),Oo(i,s,[n]),Oo(i,n,[])}e:for(;i.length;){for(let n=0;n<i.length;n++){let s=i[n];if(s.after.every(o=>t.includes(o.id))){if(t.push(s.term.id),i.length==1)break e;i[n]=i.pop();continue e}}this.b.raise(`Cyclic token precedence relation between ${i.map(n=>n.term).join(", ")}`)}return t}}class Lk extends Bp{constructor(){super(...arguments),this.explicitConflicts=[]}getLiteral(e){let t=JSON.stringify(e.value);for(let h of this.built)if(h.id==t)return h.term;let i=null,n={},s=null,o=null,a=this.ast?this.ast.literals.find(h=>h.literal==e.value):null;a&&({name:i,props:n,dialect:s,exported:o}=this.b.nodeInfo(a.props,"da",e.value));let l=this.b.makeTerminal(t,i,n);return s!=null&&(this.byDialect[s]||(this.byDialect[s]=[])).push(l),o&&(this.b.namedTerms[o]=l),this.build(e,this.startState,new ht([l]),Le),this.built.push(new Es(t,Le,l)),l}takeConflicts(){var e;let t=i=>{if(i instanceof Ke){for(let n of this.built)if(n.matches(i))return n.term}else{let n=JSON.stringify(i.value),s=this.built.find(o=>o.id==n);if(s)return s.term}return this.b.warn(`Conflict specified for unknown token ${i}`,i.start),null};for(let i of((e=this.ast)===null||e===void 0?void 0:e.conflicts)||[]){let n=t(i.a),s=t(i.b);n&&s&&(n.id<s.id&&([n,s]=[s,n]),this.explicitConflicts.push({a:n,b:s}))}}buildTokenGroups(e,t,i){let n=this.startState.compile();n.accepting.length&&this.b.raise(`Grammar contains zero-length tokens (in '${n.accepting[0].name}')`,this.rules.find(f=>f.id.name==n.accepting[0].name).start),/\btokens\b/.test(jn)&&console.log(n.toString());let s=n.findConflicts(Nk(e,this.b,t)).filter(({a:f,b:u})=>!this.precededBy(f,u)&&!this.precededBy(u,f));for(let{a:f,b:u}of this.explicitConflicts)s.some(d=>d.a==f&&d.b==u)||s.push(new Dp(f,u,0,"",""));let o=s.filter(f=>f.soft),a=s.filter(f=>!f.soft),l=[],h=[];for(let f of e){if(f.defaultReduce||f.tokenGroup>-1)continue;let u=[],d=[],p=t[this.b.skipRules.indexOf(f.skip)].startTokens;for(let b of p)f.actions.some(y=>y.term==b)&&this.b.raise(`Use of token ${b.name} conflicts with skip rule`);let m=[];for(let b=0;b<f.actions.length+(p?p.length:0);b++){let y=b<f.actions.length?f.actions[b].term:p[b-f.actions.length],x=this.b.tokenOrigins[y.name];if(x&&x.spec)y=x.spec;else if(x&&x.external)continue;En(m,y)}if(m.length==0)continue;for(let b of m)for(let y of a){let x=y.a==b?y.b:y.b==b?y.a:null;if(x){if(m.includes(x)&&!l.some(E=>E.conflict==y)){let E=y.exampleA?` (example: ${JSON.stringify(y.exampleA)}${y.exampleB?` vs ${JSON.stringify(y.exampleB)}`:""})`:"";l.push({error:`Overlapping tokens ${b.name} and ${x.name} used in same context${E}
After: ${f.set[0].trail()}`,conflict:y})}En(u,b),En(d,x)}}let g=null;for(let b of h)if(!d.some(y=>b.tokens.includes(y))){for(let y of u)En(b.tokens,y);g=b;break}g||(g=new Mk(u,h.length+i),h.push(g)),f.tokenGroup=g.groupID}l.length&&this.b.raise(l.map(f=>f.error).join(`

`)),h.length+i>16&&this.b.raise(`Too many different token groups (${h.length}) to represent them as a 16-bit bitfield`);let c=this.buildPrecTable(o);return{tokenGroups:h,tokenPrec:c,tokenData:n.toArray(Rk(h),c)}}}class Ik extends Bp{constructor(e,t){super(e,t),this.fallback=null,t.fallback&&e.unique(t.fallback.id)}getToken(e){let t=null;if(this.ast.fallback&&this.ast.fallback.id.name==e.id.name){if(e.args.length&&this.b.raise(`Incorrect number of arguments for ${e.id.name}`,e.start),!this.fallback){let{name:i,props:n,exported:s}=this.b.nodeInfo(this.ast.fallback.props,"",e.id.name,Le,Le),o=this.fallback=this.b.makeTerminal(e.id.name,i,n);(o.nodeType||s)&&(o.nodeType||(o.preserve=!0),this.b.namedTerms[s||e.id.name]=o),this.b.used(e.id.name)}t=this.fallback}else t=super.getToken(e);return t&&!this.b.tokenOrigins[t.name]&&(this.b.tokenOrigins[t.name]={group:this}),t}buildLocalGroup(e,t,i){let n=this.startState.compile();n.accepting.length&&this.b.raise(`Grammar contains zero-length tokens (in '${n.accepting[0].name}')`,this.rules.find(h=>h.id.name==n.accepting[0].name).start);for(let{a:h,b:c,exampleA:f}of n.findConflicts(()=>!0))!this.precededBy(h,c)&&!this.precededBy(c,h)&&this.b.raise(`Overlapping tokens ${h.name} and ${c.name} in local token group${f?` (example: ${JSON.stringify(f)})`:""}`);for(let h of e){if(h.defaultReduce)continue;let c=null,f=t[this.b.skipRules.indexOf(h.skip)].startTokens[0];for(let{term:u}of h.actions){let d=this.b.tokenOrigins[u.name];for(;d?.spec;)d=this.b.tokenOrigins[d.spec.name];d?.group==this?c=u:f=u}c&&(f&&this.b.raise(`Tokens from a local token group used together with other tokens (${c.name} with ${f.name})`),h.tokenGroup=i)}let s=this.buildPrecTable(Le),o=n.toArray({[i]:65535},s),a=o.length,l=new Uint16Array(o.length+s.length+1);return l.set(o,0),l.set(s,a),l[l.length-1]=65535,{groupID:i,create:()=>new _p(l,a,this.fallback?this.fallback.id:void 0),createSource:h=>`new ${h("LocalTokenGroup","@lezer/lr")}(${Tn(l)}, ${a}${this.fallback?`, ${this.fallback.id}`:""})`}}}function Nk(r,e,t){let i=Object.create(null);function n(s,o){return s.actions.some(a=>a.term==o)||t[e.skipRules.indexOf(s.skip)].startTokens.includes(o)}return(s,o)=>{s.id<o.id&&([s,o]=[o,s]);let a=s.id|o.id<<16,l=i[a];return l??(i[a]=r.some(h=>n(h,s)&&n(h,o)))}}function Bk(r){let e=0,t=[];for(let[i,n]of r)i>e&&t.push([e,i]),e=n;return e<=nf&&t.push([e,nf+1]),t}const Ao=65536,ef=55296,tf=57344,nf=1114111,To=56320,Eo=57343;function jk(r,e,t,i){if(t<Ao&&(t<ef&&r.edge(t,Math.min(i,ef),e),i>tf&&r.edge(Math.max(t,tf),Math.min(i,Il+1),e),t=Ao),i<=Ao)return;let n=String.fromCodePoint(t),s=String.fromCodePoint(i-1),o=n.charCodeAt(0),a=n.charCodeAt(1),l=s.charCodeAt(0),h=s.charCodeAt(1);if(o==l){let c=new ht;r.edge(o,o+1,c),c.edge(a,h+1,e)}else{let c=o,f=l;if(a>To){c++;let u=new ht;r.edge(o,o+1,u),u.edge(a,Eo+1,e)}if(h<Eo){f--;let u=new ht;r.edge(l,l+1,u),u.edge(To,h+1,e)}if(c<=f){let u=new ht;r.edge(c,f+1,u),u.edge(To,Eo+1,e)}}}function jp(r){return r instanceof ct&&r.exprs.length==0}function Fp(r,e){let t=Object.create(null);for(let i of e){r.unique(i.id);let{name:n,props:s,dialect:o}=r.nodeInfo(i.props,"d",i.id.name),a=r.makeTerminal(i.id.name,n,s);o!=null&&(r.tokens.byDialect[o]||(r.tokens.byDialect[o]=[])).push(a),r.namedTerms[i.id.name]=t[i.id.name]=a}return t}function $p(r,e,t){let i=e[t.id.name];return i?(t.args.length&&r.raise("External tokens cannot take arguments",t.args[0].start),r.used(t.id.name),i):null}function Oo(r,e,t){let i=r.findIndex(n=>n.term==e);i<0?r.push({term:e,after:t}):r[i]={term:e,after:r[i].after.concat(t)}}class qa{constructor(e,t){this.b=e,this.ast=t,this.tokens=Fp(e,t.tokens);for(let i in this.tokens)this.b.tokenOrigins[this.tokens[i].name]={external:this}}getToken(e){return $p(this.b,this.tokens,e)}checkConflicts(e,t){let i=[];for(let n of this.ast.conflicts){let s=this.b.namedTerms[n.name];s?s.terminal?this.tokens[n.name]?this.b.warn(`External token set specifying a conflict with one of its own tokens ('${n.name}')`):i.push(s):this.b.warn(`Term '${n.name}' isn't a terminal and cannot be used in a token conflict.`):this.b.warn(`Unknown conflict term '${n.name}'`)}if(i.length)for(let n of e){let s=t[this.b.skipRules.indexOf(n.skip)].startTokens,o=!1,a=null;for(let l=0;l<n.actions.length+s.length;l++){let h=l<n.actions.length?n.actions[l].term:s[l-n.actions.length];h.name in this.tokens?o=!0:i.indexOf(h)>-1&&(a=h)}o&&a&&this.b.raise(`Tokens from external group used together with conflicting token '${a.name}'
After: ${n.set[0].trail()}`,this.ast.start)}}create(){return this.b.options.externalTokenizer(this.ast.id.name,this.b.termTable)}createSource(e){let{source:t,id:{name:i}}=this.ast;return e(i,t)}}class Mo{constructor(e,t){this.b=e,this.ast=t,this.term=null,this.tokens=Fp(e,t.tokens)}finish(){let e=this.b.normalizeExpr(this.ast.token);(e.length!=1||e[0].terms.length!=1||!e[0].terms[0].terminal)&&this.b.raise(`The token expression to '@external ${this.ast.type}' must resolve to a token`,this.ast.token.start),this.term=e[0].terms[0];for(let t in this.tokens)this.b.tokenOrigins[this.tokens[t].name]={spec:this.term,external:this}}getToken(e){return $p(this.b,this.tokens,e)}}function Fk(r,e){for(let t=0;;t++){let i=Object.create(null),n;if(t==0){for(let o of r)if(o.name.inline&&!i[o.name.name]){let a=r.filter(l=>l.name==o.name);if(a.some(l=>l.parts.includes(o.name)))continue;n=i[o.name.name]=a}}for(let o=0;o<r.length;o++){let a=r[o];!a.name.interesting&&!a.parts.includes(a.name)&&a.parts.length<3&&!e.includes(a.name)&&(a.parts.length==1||r.every(l=>l.skip==a.skip||!l.parts.includes(a.name)))&&!a.parts.some(l=>!!i[l.name])&&!r.some((l,h)=>h!=o&&l.name==a.name)&&(n=i[a.name.name]=[a])}if(!n)return r;let s=[];for(let o of r){let a=function(l,h,c){if(l==o.parts.length){s.push(new Ll(o.name,c,h,o.skip));return}let f=o.parts[l],u=i[f.name];if(!u){a(l+1,h.concat(o.conflicts[l+1]),c.concat(f));return}for(let d of u)a(l+1,h.slice(0,h.length-1).concat(h[l].join(d.conflicts[0])).concat(d.conflicts.slice(1,d.conflicts.length-1)).concat(o.conflicts[l+1].join(d.conflicts[d.conflicts.length-1])),c.concat(d.parts))};if(!i[o.name.name]){if(!o.parts.some(l=>!!i[l.name])){s.push(o);continue}a(0,[o.conflicts[0]],[])}}r=s}}function $k(r){let e=Object.create(null),t;for(let n=0;n<r.length;){let s=n,o=r[n++].name;for(;n<r.length&&r[n].name==o;)n++;let a=n-s;if(!o.interesting)for(let l=n;l<r.length;){let h=l,c=r[l++].name;for(;l<r.length&&r[l].name==c;)l++;if(l-h!=a||c.interesting)continue;let f=!0;for(let u=0;u<a&&f;u++){let d=r[s+u],p=r[h+u];d.cmpNoName(p)!=0&&(f=!1)}f&&(t=e[o.name]=c)}}if(!t)return r;let i=[];for(let n of r)e[n.name.name]||i.push(n.parts.every(s=>!e[s.name])?n:new Ll(n.name,n.parts.map(s=>e[s.name]||s),n.conflicts,n.skip));return i}function zk(r,e){return $k(Fk(r,e))}function Vk(r,e={}){let t=new Ck(r,e),i=t.getParser();return i.termTable=t.termTable,i}const rf=["arguments","await","break","case","catch","continue","debugger","default","do","else","eval","finally","for","function","if","return","switch","throw","try","var","while","with","null","true","false","instanceof","typeof","void","delete","new","in","this","const","class","extends","export","import","super","enum","implements","interface","let","package","private","protected","public","static","yield","require"];function Wk(r){let e=r[0];return e=="_"||e.toUpperCase()!=e}function Hk(r){return r.props.some(e=>e.at&&e.name=="export")}const qk=N.theme({"&":{background:"var(--jp-layout-color0)",color:"var(--jp-content-font-color1)"},".cm-panels":{color:"var(--jp-ui-font-color2)",backgroundColor:"var(--jp-layout-color2)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--jp-border-color2)"},".cm-button":{background:"var(--jp-layout-color2)",border:"var(--jp-border-width) solid var(--jp-border-color1)",color:"var(--jp-ui-font-color1)",borderRadius:"var(--jp-border-radius)"},".cm-button:hover":{background:"var(--jp-layout-color1)"},".cm-panel.cm-search > label":{color:"var(--jp-ui-font-color1)"},".cm-textfield":{backgroundColor:"var(--jp-layout-color2)",color:"var(--jp-ui-font-color1)",border:"var(--jp-border-width) solid var(--jp-border-color1)"},".jp-CodeConsole &, .jp-Notebook &":{background:"transparent"},".cm-content":{caretColor:"var(--jp-editor-cursor-color)"},".cm-scroller":{fontFamily:"inherit"},".cm-cursor, .cm-dropCursor":{borderLeft:"var(--jp-code-cursor-width0) solid var(--jp-editor-cursor-color)"},".cm-selectionBackground, .cm-content ::selection":{backgroundColor:"var(--jp-editor-selected-background)"},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"var(--jp-editor-selected-focused-background)"},".cm-gutters":{borderRight:"1px solid var(--jp-border-color2)",backgroundColor:"var(--jp-layout-color2)"},".cm-gutter":{backgroundColor:"var(--jp-layout-color2)"},".cm-activeLine":{backgroundColor:"color-mix(in srgb, var(--jp-layout-color3) 25%, transparent)"},".cm-lineNumbers":{color:"var(--jp-ui-font-color2)"},".cm-searchMatch":{backgroundColor:"var(--jp-search-unselected-match-background-color)",color:"var(--jp-search-unselected-match-color)"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"var(--jp-search-selected-match-background-color) !important",color:"var(--jp-search-selected-match-color) !important"},".cm-tooltip":{backgroundColor:"var(--jp-layout-color1)"}}),Hs=cr.define([{tag:C.meta,color:"var(--jp-mirror-editor-meta-color)"},{tag:C.heading,color:"var(--jp-mirror-editor-header-color)"},{tag:[C.heading1,C.heading2,C.heading3,C.heading4],color:"var(--jp-mirror-editor-header-color)",fontWeight:"bold"},{tag:C.keyword,color:"var(--jp-mirror-editor-keyword-color)",fontWeight:"bold"},{tag:C.atom,color:"var(--jp-mirror-editor-atom-color)"},{tag:C.number,color:"var(--jp-mirror-editor-number-color)"},{tag:[C.definition(C.name),C.function(C.definition(C.variableName))],color:"var(--jp-mirror-editor-def-color)"},{tag:C.standard(C.variableName),color:"var(--jp-mirror-editor-builtin-color)"},{tag:[C.special(C.variableName),C.self],color:"var(--jp-mirror-editor-variable-2-color)"},{tag:C.punctuation,color:"var(--jp-mirror-editor-punctuation-color)"},{tag:C.propertyName,color:"var(--jp-mirror-editor-property-color)"},{tag:C.operator,color:"var(--jp-mirror-editor-operator-color)",fontWeight:"bold"},{tag:C.comment,color:"var(--jp-mirror-editor-comment-color)",fontStyle:"italic"},{tag:C.string,color:"var(--jp-mirror-editor-string-color)"},{tag:[C.labelName,C.monospace,C.special(C.string)],color:"var(--jp-mirror-editor-string-2-color)"},{tag:C.bracket,color:"var(--jp-mirror-editor-bracket-color)"},{tag:C.tagName,color:"var(--jp-mirror-editor-tag-color)"},{tag:C.attributeName,color:"var(--jp-mirror-editor-attribute-color)"},{tag:C.quote,color:"var(--jp-mirror-editor-quote-color)"},{tag:C.link,color:"var(--jp-mirror-editor-link-color)",textDecoration:"underline"},{tag:[C.separator,C.derefOperator,C.paren],color:""},{tag:C.strong,fontWeight:"bold"},{tag:C.emphasis,fontStyle:"italic"},{tag:C.strikethrough,textDecoration:"line-through"},{tag:C.bool,color:"var(--jp-mirror-editor-keyword-color)",fontWeight:"bold"}]),Gk=[qk,Sd(Hs)];class sf{constructor(){this._themeMap=new Map([["jupyter",Object.freeze({name:"jupyter",theme:Gk})]])}get themes(){return Array.from(this._themeMap.values())}defaultTheme(){return this._themeMap.get("jupyter").theme}addTheme(e){if(this._themeMap.has(e.name))throw new Error(`A theme named '${e.name}' is already registered.`);this._themeMap.set(e.name,{displayName:e.name,...e})}getTheme(e){var t;const i=(t=this._themeMap.get(e))===null||t===void 0?void 0:t.theme;return i??this.defaultTheme()}}(function(r){function e(t){const i=(t??Os).load("jupyterlab");return[Object.freeze({name:"codemirror",displayName:i.__("codemirror"),theme:[N.baseTheme({}),Sd(J1)]})]}r.getDefaultThemes=e})(sf||(sf={}));class Uk{constructor(e,t){this.langPython=t,this.tree=De(e.state),this.mark=J.mark({class:"cm-builtin"}),this.decorations=this.buildDeco(e),this.decoratedTo=e.viewport.to}update(e){let t=De(e.state),{viewport:i}=e.view,n=e.changes.mapPos(this.decoratedTo,1);t.length<i.to&&t.type==this.tree.type&&n>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=n):(t!=this.tree||e.viewportChanged)&&(this.tree=t,this.decorations=this.buildDeco(e.view),this.decoratedTo=i.to)}buildDeco(e){if(!this.tree.length)return J.none;let t=new Kt;const i=n=>{var s;const o=n.node.cursor(),a=o.tree&&o.tree.prop(U.mounted);if(a&&a.overlay&&((s=n.node.enter(a.overlay[0].from+n.from,1))===null||s===void 0||s.cursor().iterate(i)),this.langPython.isActiveAt(e.state,n.from+1)&&n.name==="VariableName"){const l=e.state.sliceDoc(n.from,n.to);Kk.includes(l)&&t.add(n.from,n.to,this.mark)}};for(let{from:n,to:s}of e.visibleRanges)this.tree.iterate({enter:i,from:n,to:s});return t.finish()}}function of(r){return Ce.define(e=>new Uk(e,r),{decorations:e=>e.decorations})}const Kk=["abs","aiter","all","any","anext","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__"];class af{constructor(){this._modeList=[],this.addLanguage({name:"none",mime:"text/plain",support:new Xr(ps.define({parser:Vk("@top Program { }")}))})}addLanguage(e){var t;if((t=this.findByName(e.name))!==null&&t!==void 0?t:this.findByMIME(e.mime,!0))throw new Error(`${e.mime} already registered`);this._modeList.push(this.makeSpec(e))}async getLanguage(e){const t=this.findBest(e);return t&&!t.support&&(t.support=await t.load()),t}getLanguages(){return[...this._modeList]}findByMIME(e,t=!1){if(Array.isArray(e)){for(let i=0;i<e.length;i++){const n=this.findByMIME(e[i]);if(n)return n}return null}e=e.toLowerCase();for(let i=0;i<this._modeList.length;i++){let n=this._modeList[i];if(Array.isArray(n.mime)){for(let s=0;s<n.mime.length;s++)if(n.mime[s]==e)return n}else if(n.mime==e)return n}if(!t){if(/\+xml$/.test(e))return this.findByMIME("application/xml");if(/\+json$/.test(e))return this.findByMIME("application/json")}return null}findByName(e){e=e.toLowerCase();for(let t=0;t<this._modeList.length;t++){let i=this._modeList[t];if(i.name.toLowerCase()==e)return i;if(i.alias){for(let n=0;n<i.alias.length;n++)if(i.alias[n].toLowerCase()==e)return i}}return null}findByExtension(e){if(Array.isArray(e)){for(let t=0;t<e.length;t++){const i=this.findByExtension(e[t]);if(i)return i}return null}e=e.toLowerCase();for(let t=0;t<this._modeList.length;t++){let i=this._modeList[t];for(let n=0;n<i.extensions.length;n++)if(i.extensions[n].toLowerCase()==e)return i}return null}findByFileName(e){const t=Ef.PathExt.basename(e);for(let s=0;s<this._modeList.length;s++){let o=this._modeList[s];if(o.filename&&o.filename.test(t))return o}let i=t.lastIndexOf("."),n=i>-1&&t.substring(i+1,t.length);return n?this.findByExtension(n):null}findBest(e,t=!0){var i,n,s,o;const a=typeof e=="string"?e:e.name,l=typeof e!="string"?e.mime:a,h=typeof e!="string"?(i=e.extensions)!==null&&i!==void 0?i:[]:[];return(o=(s=(n=a?this.findByName(a):null)!==null&&n!==void 0?n:l?this.findByMIME(l):null)!==null&&s!==void 0?s:this.findByExtension(h))!==null&&o!==void 0?o:t?this.findByMIME(Ho.defaultMimeType):null}async highlight(e,t,i){var n;t&&await this.getLanguage(t);const s=(n=t?.support)===null||n===void 0?void 0:n.language;if(!s){i.appendChild(document.createTextNode(e));return}const o=s.parser.parse(e);let a=0;dd(o,Hs,(l,h,c)=>{l>a&&i.appendChild(document.createTextNode(e.slice(a,l)));const f=i.appendChild(document.createElement("span"));f.className=c,f.appendChild(document.createTextNode(e.slice(l,h))),a=h}),a<o.length-1&&i.appendChild(document.createTextNode(e.slice(a,o.length)))}makeSpec(e){let t=ul.of(e);return t.mime=e.mime,t.displayName=e.displayName,t}}(function(r){function e(n){return new Xr(gl.define(n))}r.legacy=e;async function t(n){const s=await S(()=>import("./index-DpA4kskq.js"),__vite__mapDeps([0,1,2]));return s.sql({dialect:s[n]})}function i(n){const s=(n??Os).load("jupyterlab");return[{name:"C",displayName:s.__("C"),mime:"text/x-csrc",extensions:["c","h","ino"],async load(){return(await S(()=>import("./index-CEWaqLPw.js"),__vite__mapDeps([3,1,2]))).cpp()}},{name:"C++",displayName:s.__("C++"),mime:"text/x-c++src",extensions:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],async load(){return(await S(()=>import("./index-CEWaqLPw.js"),__vite__mapDeps([3,1,2]))).cpp()}},{name:"CQL",displayName:s.__("CQL"),mime:"text/x-cassandra",extensions:["cql"],load(){return t("Cassandra")}},{name:"CSS",displayName:s.__("CSS"),mime:"text/css",extensions:["css"],async load(){return(await S(()=>import("./index-B9ZcXFYD.js"),__vite__mapDeps([4,1,2]))).css()}},{name:"HTML",displayName:s.__("HTML"),alias:["xhtml"],mime:"text/html",extensions:["html","htm","handlebars","hbs"],async load(){return(await S(()=>import("./index-CqXAStKb.js"),__vite__mapDeps([5,4,1,2,6]))).html()}},{name:"Java",displayName:s.__("Java"),mime:"text/x-java",extensions:["java"],async load(){return(await S(()=>import("./index-DBtHm1U6.js"),__vite__mapDeps([7,1,2]))).java()}},{name:"Javascript",displayName:s.__("Javascript"),alias:["ecmascript","js","node"],mime:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],extensions:["js","mjs","cjs"],async load(){return(await S(()=>import("./index-QgvgPLsJ.js"),__vite__mapDeps([6,1,2]))).javascript()}},{name:"JSON",displayName:s.__("JSON"),alias:["json5"],mime:["application/json","application/x-json"],extensions:["json","map"],async load(){return(await S(()=>import("./index-CUy69ErP.js"),__vite__mapDeps([8,1,2]))).json()}},{name:"JSX",displayName:s.__("JSX"),mime:"text/jsx",extensions:["jsx"],async load(){return(await S(()=>import("./index-QgvgPLsJ.js"),__vite__mapDeps([6,1,2]))).javascript({jsx:!0})}},{name:"MariaDB SQL",displayName:s.__("MariaDB SQL"),mime:"text/x-mariadb",load(){return t("MariaSQL")}},{name:"Markdown",displayName:s.__("Markdown"),mime:"text/x-markdown",extensions:["md","markdown","mkd"],async load(){return(await S(()=>import("./index-B_ud9Ues.js"),__vite__mapDeps([9,5,4,1,2,6]))).markdown({codeLanguages:this._modeList})}},{name:"MS SQL",displayName:s.__("MS SQL"),mime:"text/x-mssql",load(){return t("MSSQL")}},{name:"MySQL",displayName:s.__("MySQL"),mime:"text/x-mysql",load(){return t("MySQL")}},{name:"PHP",displayName:s.__("PHP"),mime:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],extensions:["php","php3","php4","php5","php7","phtml"],async load(){return(await S(()=>import("./index-xzdjK3O5.js"),__vite__mapDeps([10,5,4,1,2,6]))).php()}},{name:"PLSQL",displayName:s.__("PLSQL"),mime:"text/x-plsql",extensions:["pls"],load(){return t("PLSQL")}},{name:"PostgreSQL",displayName:s.__("PostgreSQL"),mime:"text/x-pgsql",load(){return t("PostgreSQL")}},{name:"Python",displayName:s.__("Python"),mime:"text/x-python",extensions:["BUILD","bzl","py","pyw"],filename:/^(BUCK|BUILD)$/,async load(){const o=await S(()=>import("./index-Cxr3E9bt.js"),__vite__mapDeps([11,1,2]));return new Xr(o.pythonLanguage,of(o.pythonLanguage))}},{name:"ipython",displayName:s.__("ipython"),mime:"text/x-ipython",async load(){const o=await S(()=>import("./index-Cxr3E9bt.js"),__vite__mapDeps([11,1,2]));return new Xr(o.pythonLanguage,of(o.pythonLanguage))}},{name:"Rust",displayName:s.__("Rust"),mime:"text/x-rustsrc",extensions:["rs"],async load(){return(await S(()=>import("./index-BZc4-Gui.js"),__vite__mapDeps([12,1,2]))).rust()}},{name:"SQL",displayName:s.__("SQL"),mime:["application/sql","text/x-sql"],extensions:["sql"],load(){return t("StandardSQL")}},{name:"SQLite",displayName:s.__("SQLite"),mime:"text/x-sqlite",load(){return t("SQLite")}},{name:"TSX",displayName:s.__("TSX"),alias:["TypeScript-JSX"],mime:"text/typescript-jsx",extensions:["tsx"],async load(){return(await S(()=>import("./index-QgvgPLsJ.js"),__vite__mapDeps([6,1,2]))).javascript({jsx:!0,typescript:!0})}},{name:"TypeScript",displayName:s.__("TypeScript"),alias:["ts"],mime:"application/typescript",extensions:["ts"],async load(){return(await S(()=>import("./index-QgvgPLsJ.js"),__vite__mapDeps([6,1,2]))).javascript({typescript:!0})}},{name:"WebAssembly",displayName:s.__("WebAssembly"),mime:"text/webassembly",extensions:["wat","wast"],async load(){return(await S(()=>import("./index-CQnBVDN3.js"),__vite__mapDeps([13,1,2]))).wast()}},{name:"XML",displayName:s.__("XML"),alias:["rss","wsdl","xsd"],mime:["application/xml","text/xml"],extensions:["xml","xsl","xsd","svg"],async load(){return(await S(()=>import("./index-B5Fb3rON.js"),__vite__mapDeps([14,1,2]))).xml()}},{name:"APL",displayName:s.__("APL"),mime:"text/apl",extensions:["dyalog","apl"],async load(){const o=await S(()=>import("./apl-B4CMkyY2.js"),[]);return e(o.apl)}},{name:"PGP",displayName:s.__("PGP"),alias:["asciiarmor"],mime:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],extensions:["asc","pgp","sig"],async load(){const o=await S(()=>import("./asciiarmor-Df11BRmG.js"),[]);return e(o.asciiArmor)}},{name:"ASN.1",displayName:s.__("ASN.1"),mime:"text/x-ttcn-asn",extensions:["asn","asn1"],async load(){const o=await S(()=>import("./asn1-EdZsLKOL.js"),[]);return e(o.asn1({}))}},{name:"Asterisk",displayName:s.__("Asterisk"),mime:"text/x-asterisk",filename:/^extensions\.conf$/i,async load(){const o=await S(()=>import("./asterisk-B-8jnY81.js"),[]);return e(o.asterisk)}},{name:"Brainfuck",displayName:s.__("Brainfuck"),mime:"text/x-brainfuck",extensions:["b","bf"],async load(){const o=await S(()=>import("./brainfuck-C4LP7Hcl.js"),[]);return e(o.brainfuck)}},{name:"Cobol",displayName:s.__("Cobol"),mime:"text/x-cobol",extensions:["cob","cpy"],async load(){const o=await S(()=>import("./cobol-CWcv1MsR.js"),[]);return e(o.cobol)}},{name:"C#",displayName:s.__("C#"),alias:["csharp","cs"],mime:"text/x-csharp",extensions:["cs"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.csharp)}},{name:"Clojure",displayName:s.__("Clojure"),mime:"text/x-clojure",extensions:["clj","cljc","cljx"],async load(){const o=await S(()=>import("./clojure-BMjYHr_A.js"),[]);return e(o.clojure)}},{name:"ClojureScript",displayName:s.__("ClojureScript"),mime:"text/x-clojurescript",extensions:["cljs"],async load(){const o=await S(()=>import("./clojure-BMjYHr_A.js"),[]);return e(o.clojure)}},{name:"Closure Stylesheets (GSS)",displayName:s.__("Closure Stylesheets (GSS)"),mime:"text/x-gss",extensions:["gss"],async load(){const o=await S(()=>import("./css-BnMrqG3P.js"),[]);return e(o.gss)}},{name:"CMake",displayName:s.__("CMake"),mime:"text/x-cmake",extensions:["cmake","cmake.in"],filename:/^CMakeLists\.txt$/,async load(){const o=await S(()=>import("./cmake-BQqOBYOt.js"),[]);return e(o.cmake)}},{name:"CoffeeScript",displayName:s.__("CoffeeScript"),alias:["coffee","coffee-script"],mime:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],extensions:["coffee"],async load(){const o=await S(()=>import("./coffeescript-S37ZYGWr.js"),[]);return e(o.coffeeScript)}},{name:"Common Lisp",displayName:s.__("Common Lisp"),alias:["lisp"],mime:"text/x-common-lisp",extensions:["cl","lisp","el"],async load(){const o=await S(()=>import("./commonlisp-DBKNyK5s.js"),[]);return e(o.commonLisp)}},{name:"Cypher",displayName:s.__("Cypher"),mime:"application/x-cypher-query",extensions:["cyp","cypher"],async load(){const o=await S(()=>import("./cypher-C_CwsFkJ.js"),[]);return e(o.cypher)}},{name:"Cython",displayName:s.__("Cython"),mime:"text/x-cython",extensions:["pyx","pxd","pxi"],async load(){const o=await S(()=>import("./python-Cso5vRIg.js"),[]);return e(o.cython)}},{name:"Crystal",displayName:s.__("Crystal"),mime:"text/x-crystal",extensions:["cr"],async load(){const o=await S(()=>import("./crystal-SjHAIU92.js"),[]);return e(o.crystal)}},{name:"D",displayName:s.__("D"),mime:"text/x-d",extensions:["d"],async load(){const o=await S(()=>import("./d-pRatUO7H.js"),[]);return e(o.d)}},{name:"Dart",displayName:s.__("Dart"),mime:["application/dart","text/x-dart"],extensions:["dart"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.dart)}},{name:"diff",displayName:s.__("diff"),mime:"text/x-diff",extensions:["diff","patch"],async load(){const o=await S(()=>import("./diff-DbItnlRl.js"),[]);return e(o.diff)}},{name:"Dockerfile",displayName:s.__("Dockerfile"),mime:"text/x-dockerfile",filename:/^Dockerfile$/,async load(){const o=await S(()=>import("./dockerfile-BKs6k2Af.js"),__vite__mapDeps([15,16]));return e(o.dockerFile)}},{name:"DTD",displayName:s.__("DTD"),mime:"application/xml-dtd",extensions:["dtd"],async load(){const o=await S(()=>import("./dtd-DF_7sFjM.js"),[]);return e(o.dtd)}},{name:"Dylan",displayName:s.__("Dylan"),mime:"text/x-dylan",extensions:["dylan","dyl","intr"],async load(){const o=await S(()=>import("./dylan-DwRh75JA.js"),[]);return e(o.dylan)}},{name:"EBNF",displayName:s.__("EBNF"),mime:"text/x-ebnf",async load(){const o=await S(()=>import("./ebnf-CDyGwa7X.js"),[]);return e(o.ebnf)}},{name:"ECL",displayName:s.__("ECL"),mime:"text/x-ecl",extensions:["ecl"],async load(){const o=await S(()=>import("./ecl-Cabwm37j.js"),[]);return e(o.ecl)}},{name:"edn",displayName:s.__("edn"),mime:"application/edn",extensions:["edn"],async load(){const o=await S(()=>import("./clojure-BMjYHr_A.js"),[]);return e(o.clojure)}},{name:"Eiffel",displayName:s.__("Eiffel"),mime:"text/x-eiffel",extensions:["e"],async load(){const o=await S(()=>import("./eiffel-CnydiIhH.js"),[]);return e(o.eiffel)}},{name:"Elm",displayName:s.__("Elm"),mime:"text/x-elm",extensions:["elm"],async load(){const o=await S(()=>import("./elm-vLlmbW-K.js"),[]);return e(o.elm)}},{name:"Erlang",displayName:s.__("Erlang"),mime:"text/x-erlang",extensions:["erl"],async load(){const o=await S(()=>import("./erlang-BNw1qcRV.js"),[]);return e(o.erlang)}},{name:"Esper",displayName:s.__("Esper"),mime:"text/x-esper",async load(){const o=await S(()=>import("./sql-D0XecflT.js"),[]);return e(o.esper)}},{name:"Factor",displayName:s.__("Factor"),mime:"text/x-factor",extensions:["factor"],async load(){const o=await S(()=>import("./factor-kuTfRLto.js"),__vite__mapDeps([17,16]));return e(o.factor)}},{name:"FCL",displayName:s.__("FCL"),mime:"text/x-fcl",async load(){const o=await S(()=>import("./fcl-Kvtd6kyn.js"),[]);return e(o.fcl)}},{name:"Forth",displayName:s.__("Forth"),mime:"text/x-forth",extensions:["forth","fth","4th"],async load(){const o=await S(()=>import("./forth-Ffai-XNe.js"),[]);return e(o.forth)}},{name:"Fortran",displayName:s.__("Fortran"),mime:"text/x-fortran",extensions:["f","for","f77","f90","f95"],async load(){const o=await S(()=>import("./fortran-DYz_wnZ1.js"),[]);return e(o.fortran)}},{name:"F#",displayName:s.__("F#"),alias:["fsharp"],mime:"text/x-fsharp",extensions:["fs"],async load(){const o=await S(()=>import("./mllike-BO34x3tv.js"),[]);return e(o.fSharp)}},{name:"Gas",displayName:s.__("Gas"),mime:"text/x-gas",extensions:["s"],async load(){const o=await S(()=>import("./gas-Bneqetm1.js"),[]);return e(o.gas)}},{name:"Gherkin",displayName:s.__("Gherkin"),mime:"text/x-feature",extensions:["feature"],async load(){const o=await S(()=>import("./gherkin-heZmZLOM.js"),[]);return e(o.gherkin)}},{name:"Go",displayName:s.__("Go"),mime:"text/x-go",extensions:["go"],async load(){const o=await S(()=>import("./go-CTD25R5P.js"),[]);return e(o.go)}},{name:"Groovy",displayName:s.__("Groovy"),mime:"text/x-groovy",extensions:["groovy","gradle"],filename:/^Jenkinsfile$/,async load(){const o=await S(()=>import("./groovy-D9Dt4D0W.js"),[]);return e(o.groovy)}},{name:"Haskell",displayName:s.__("Haskell"),mime:"text/x-haskell",extensions:["hs"],async load(){const o=await S(()=>import("./haskell-Cw1EW3IL.js"),[]);return e(o.haskell)}},{name:"Haxe",displayName:s.__("Haxe"),mime:"text/x-haxe",extensions:["hx"],async load(){const o=await S(()=>import("./haxe-H-WmDvRZ.js"),[]);return e(o.haxe)}},{name:"HXML",displayName:s.__("HXML"),mime:"text/x-hxml",extensions:["hxml"],async load(){const o=await S(()=>import("./haxe-H-WmDvRZ.js"),[]);return e(o.hxml)}},{name:"HTTP",displayName:s.__("HTTP"),mime:"message/http",async load(){const o=await S(()=>import("./http-DBlCnlav.js"),[]);return e(o.http)}},{name:"IDL",displayName:s.__("IDL"),mime:"text/x-idl",extensions:["pro"],async load(){const o=await S(()=>import("./idl-BEugSyMb.js"),[]);return e(o.idl)}},{name:"JSON-LD",displayName:s.__("JSON-LD"),alias:["jsonld"],mime:"application/ld+json",extensions:["jsonld"],async load(){const o=await S(()=>import("./javascript-BO_2ioGC.js"),[]);return e(o.jsonld)}},{name:"Jinja2",displayName:s.__("Jinja2"),mime:"text/jinja2",extensions:["j2","jinja","jinja2"],async load(){const o=await S(()=>import("./jinja2-C4DGRd-O.js"),[]);return e(o.jinja2)}},{name:"Julia",displayName:s.__("Julia"),mime:"text/x-julia",extensions:["jl"],async load(){const o=await S(()=>import("./julia-DuME0IfC.js"),[]);return e(o.julia)}},{name:"Kotlin",displayName:s.__("Kotlin"),mime:"text/x-kotlin",extensions:["kt"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.kotlin)}},{name:"LESS",displayName:s.__("LESS"),mime:"text/x-less",extensions:["less"],async load(){const o=await S(()=>import("./css-BnMrqG3P.js"),[]);return e(o.less)}},{name:"LiveScript",displayName:s.__("LiveScript"),alias:["ls"],mime:"text/x-livescript",extensions:["ls"],async load(){const o=await S(()=>import("./livescript-BwQOo05w.js"),[]);return e(o.liveScript)}},{name:"Lua",displayName:s.__("Lua"),mime:"text/x-lua",extensions:["lua"],async load(){const o=await S(()=>import("./lua-BgMRiT3U.js"),[]);return e(o.lua)}},{name:"mIRC",displayName:s.__("mIRC"),mime:"text/mirc",async load(){const o=await S(()=>import("./mirc-CjQqDB4T.js"),[]);return e(o.mirc)}},{name:"Mathematica",displayName:s.__("Mathematica"),mime:"text/x-mathematica",extensions:["m","nb","wl","wls"],async load(){const o=await S(()=>import("./mathematica-DTrFuWx2.js"),[]);return e(o.mathematica)}},{name:"Modelica",displayName:s.__("Modelica"),mime:"text/x-modelica",extensions:["mo"],async load(){const o=await S(()=>import("./modelica-Dc1JOy9r.js"),[]);return e(o.modelica)}},{name:"MUMPS",displayName:s.__("MUMPS"),mime:"text/x-mumps",extensions:["mps"],async load(){const o=await S(()=>import("./mumps-BT43cFF4.js"),[]);return e(o.mumps)}},{name:"mbox",displayName:s.__("mbox"),mime:"application/mbox",extensions:["mbox"],async load(){const o=await S(()=>import("./mbox-CNhZ1qSd.js"),[]);return e(o.mbox)}},{name:"Nginx",displayName:s.__("Nginx"),mime:"text/x-nginx-conf",filename:/nginx.*\.conf$/i,async load(){const o=await S(()=>import("./nginx-DdIZxoE0.js"),[]);return e(o.nginx)}},{name:"NSIS",displayName:s.__("NSIS"),mime:"text/x-nsis",extensions:["nsh","nsi"],async load(){const o=await S(()=>import("./nsis-LdVXkNf5.js"),__vite__mapDeps([18,16]));return e(o.nsis)}},{name:"NTriples",displayName:s.__("NTriples"),mime:["application/n-triples","application/n-quads","text/n-triples"],extensions:["nt","nq"],async load(){const o=await S(()=>import("./ntriples-BfvgReVJ.js"),[]);return e(o.ntriples)}},{name:"Objective-C",displayName:s.__("Objective-C"),alias:["objective-c","objc"],mime:"text/x-objectivec",extensions:["m"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.objectiveC)}},{name:"Objective-C++",displayName:s.__("Objective-C++"),alias:["objective-c++","objc++"],mime:"text/x-objectivec++",extensions:["mm"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.objectiveCpp)}},{name:"OCaml",displayName:s.__("OCaml"),mime:"text/x-ocaml",extensions:["ml","mli","mll","mly"],async load(){const o=await S(()=>import("./mllike-BO34x3tv.js"),[]);return e(o.oCaml)}},{name:"Octave",displayName:s.__("Octave"),mime:"text/x-octave",extensions:["m"],async load(){const o=await S(()=>import("./octave-CWZ4xMHY.js"),[]);return e(o.octave)}},{name:"Oz",displayName:s.__("Oz"),mime:"text/x-oz",extensions:["oz"],async load(){const o=await S(()=>import("./oz-BzwKVEFT.js"),[]);return e(o.oz)}},{name:"Pascal",displayName:s.__("Pascal"),mime:"text/x-pascal",extensions:["p","pas"],async load(){const o=await S(()=>import("./pascal--L3eBynH.js"),[]);return e(o.pascal)}},{name:"Perl",displayName:s.__("Perl"),mime:"text/x-perl",extensions:["pl","pm"],async load(){const o=await S(()=>import("./perl-CdXCOZ3F.js"),[]);return e(o.perl)}},{name:"Pig",displayName:s.__("Pig"),mime:"text/x-pig",extensions:["pig"],async load(){const o=await S(()=>import("./pig-CevX1Tat.js"),[]);return e(o.pig)}},{name:"PowerShell",displayName:s.__("PowerShell"),mime:"application/x-powershell",extensions:["ps1","psd1","psm1"],async load(){const o=await S(()=>import("./powershell-CFHJl5sT.js"),[]);return e(o.powerShell)}},{name:"Properties files",displayName:s.__("Properties files"),alias:["ini","properties"],mime:"text/x-properties",extensions:["properties","ini","in"],async load(){const o=await S(()=>import("./properties-C78fOPTZ.js"),[]);return e(o.properties)}},{name:"ProtoBuf",displayName:s.__("ProtoBuf"),mime:"text/x-protobuf",extensions:["proto"],async load(){const o=await S(()=>import("./protobuf-ChK-085T.js"),[]);return e(o.protobuf)}},{name:"Pug",displayName:s.__("Pug"),mime:"text/x-pug",extensions:["pug"],async load(){const o=await S(()=>import("./pug-CIGw5rlb.js"),__vite__mapDeps([19,20]));return e(o.pug)}},{name:"Puppet",displayName:s.__("Puppet"),mime:"text/x-puppet",extensions:["pp"],async load(){const o=await S(()=>import("./puppet-DMA9R1ak.js"),[]);return e(o.puppet)}},{name:"Q",displayName:s.__("Q"),mime:"text/x-q",extensions:["q"],async load(){const o=await S(()=>import("./q-pXgVlZs6.js"),[]);return e(o.q)}},{name:"R",displayName:s.__("R"),alias:["rscript"],mime:"text/x-rsrc",extensions:["r","R"],async load(){const o=await S(()=>import("./r-B6wPVr8A.js"),[]);return e(o.r)}},{name:"RPM Changes",displayName:s.__("RPM Changes"),mime:"text/x-rpm-changes",async load(){const o=await S(()=>import("./rpm-CTu-6PCP.js"),[]);return e(o.rpmChanges)}},{name:"RPM Spec",displayName:s.__("RPM Spec"),mime:"text/x-rpm-spec",extensions:["spec"],async load(){const o=await S(()=>import("./rpm-CTu-6PCP.js"),[]);return e(o.rpmSpec)}},{name:"Ruby",displayName:s.__("Ruby"),alias:["jruby","macruby","rake","rb","rbx"],mime:"text/x-ruby",extensions:["rb"],async load(){const o=await S(()=>import("./ruby-B2Rjki9n.js"),[]);return e(o.ruby)}},{name:"SAS",displayName:s.__("SAS"),mime:"text/x-sas",extensions:["sas"],async load(){const o=await S(()=>import("./sas-B4kiWyti.js"),[]);return e(o.sas)}},{name:"Scala",displayName:s.__("Scala"),mime:"text/x-scala",extensions:["scala"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.scala)}},{name:"Scheme",displayName:s.__("Scheme"),mime:"text/x-scheme",extensions:["scm","ss"],async load(){const o=await S(()=>import("./scheme-C41bIUwD.js"),[]);return e(o.scheme)}},{name:"SCSS",displayName:s.__("SCSS"),mime:"text/x-scss",extensions:["scss"],async load(){const o=await S(()=>import("./css-BnMrqG3P.js"),[]);return e(o.sCSS)}},{name:"Shell",displayName:s.__("Shell"),alias:["bash","sh","zsh"],mime:["text/x-sh","application/x-sh"],extensions:["sh","ksh","bash"],filename:/^PKGBUILD$/,async load(){const o=await S(()=>import("./shell-CjFT_Tl9.js"),[]);return e(o.shell)}},{name:"Sieve",displayName:s.__("Sieve"),mime:"application/sieve",extensions:["siv","sieve"],async load(){const o=await S(()=>import("./sieve-C3Gn_uJK.js"),[]);return e(o.sieve)}},{name:"Smalltalk",displayName:s.__("Smalltalk"),mime:"text/x-stsrc",extensions:["st"],async load(){const o=await S(()=>import("./smalltalk-CnHTOXQT.js"),[]);return e(o.smalltalk)}},{name:"Solr",displayName:s.__("Solr"),mime:"text/x-solr",async load(){const o=await S(()=>import("./solr-DehyRSwq.js"),[]);return e(o.solr)}},{name:"SML",displayName:s.__("SML"),mime:"text/x-sml",extensions:["sml","sig","fun","smackspec"],async load(){const o=await S(()=>import("./mllike-BO34x3tv.js"),[]);return e(o.sml)}},{name:"SPARQL",displayName:s.__("SPARQL"),alias:["sparul"],mime:"application/sparql-query",extensions:["rq","sparql"],async load(){const o=await S(()=>import("./sparql-DkYu6x3z.js"),[]);return e(o.sparql)}},{name:"Spreadsheet",displayName:s.__("Spreadsheet"),alias:["excel","formula"],mime:"text/x-spreadsheet",async load(){const o=await S(()=>import("./spreadsheet-BCZA_wO0.js"),[]);return e(o.spreadsheet)}},{name:"Squirrel",displayName:s.__("Squirrel"),mime:"text/x-squirrel",extensions:["nut"],async load(){const o=await S(()=>import("./clike-B9uivgTg.js"),[]);return e(o.squirrel)}},{name:"Stylus",displayName:s.__("Stylus"),mime:"text/x-styl",extensions:["styl"],async load(){const o=await S(()=>import("./stylus-B533Al4x.js"),[]);return e(o.stylus)}},{name:"Swift",displayName:s.__("Swift"),mime:"text/x-swift",extensions:["swift"],async load(){const o=await S(()=>import("./swift-BzpIVaGY.js"),[]);return e(o.swift)}},{name:"sTeX",displayName:s.__("sTeX"),mime:"text/x-stex",async load(){const o=await S(()=>import("./stex-C3f8Ysf7.js"),[]);return e(o.stex)}},{name:"LaTeX",displayName:s.__("LaTeX"),alias:["tex"],mime:"text/x-latex",extensions:["text","ltx","tex"],async load(){const o=await S(()=>import("./stex-C3f8Ysf7.js"),[]);return e(o.stex)}},{name:"SystemVerilog",displayName:s.__("SystemVerilog"),mime:"text/x-systemverilog",extensions:["v","sv","svh"],async load(){const o=await S(()=>import("./verilog-C6RDOZhf.js"),[]);return e(o.verilog)}},{name:"Tcl",displayName:s.__("Tcl"),mime:"text/x-tcl",extensions:["tcl"],async load(){const o=await S(()=>import("./tcl-DVfN8rqt.js"),[]);return e(o.tcl)}},{name:"Textile",displayName:s.__("Textile"),mime:"text/x-textile",extensions:["textile"],async load(){const o=await S(()=>import("./textile-CnDTJFAw.js"),[]);return e(o.textile)}},{name:"TiddlyWiki",displayName:s.__("TiddlyWiki"),mime:"text/x-tiddlywiki",async load(){const o=await S(()=>import("./tiddlywiki-DO-Gjzrf.js"),[]);return e(o.tiddlyWiki)}},{name:"Tiki wiki",displayName:s.__("Tiki wiki"),mime:"text/tiki",async load(){const o=await S(()=>import("./tiki-DGYXhP31.js"),[]);return e(o.tiki)}},{name:"TOML",displayName:s.__("TOML"),mime:"text/x-toml",extensions:["toml"],async load(){const o=await S(()=>import("./toml-Bm5Em-hy.js"),[]);return e(o.toml)}},{name:"troff",displayName:s.__("troff"),mime:"text/troff",extensions:["1","2","3","4","5","6","7","8","9"],async load(){const o=await S(()=>import("./troff-wAsdV37c.js"),[]);return e(o.troff)}},{name:"TTCN",displayName:s.__("TTCN"),mime:"text/x-ttcn",extensions:["ttcn","ttcn3","ttcnpp"],async load(){const o=await S(()=>import("./ttcn-CfJYG6tj.js"),[]);return e(o.ttcn)}},{name:"TTCN_CFG",displayName:s.__("TTCN_CFG"),mime:"text/x-ttcn-cfg",extensions:["cfg"],async load(){const o=await S(()=>import("./ttcn-cfg-B9xdYoR4.js"),[]);return e(o.ttcnCfg)}},{name:"Turtle",displayName:s.__("Turtle"),mime:"text/turtle",extensions:["ttl"],async load(){const o=await S(()=>import("./turtle-B1tBg_DP.js"),[]);return e(o.turtle)}},{name:"Web IDL",displayName:s.__("Web IDL"),mime:"text/x-webidl",extensions:["webidl"],async load(){const o=await S(()=>import("./webidl-ZXfAyPTL.js"),[]);return e(o.webIDL)}},{name:"VB.NET",displayName:s.__("VB.NET"),mime:"text/x-vb",extensions:["vb"],async load(){const o=await S(()=>import("./vb-CmGdzxic.js"),[]);return e(o.vb)}},{name:"VBScript",displayName:s.__("VBScript"),mime:"text/vbscript",extensions:["vbs"],async load(){const o=await S(()=>import("./vbscript-BuJXcnF6.js"),[]);return e(o.vbScript)}},{name:"Velocity",displayName:s.__("Velocity"),mime:"text/velocity",extensions:["vtl"],async load(){const o=await S(()=>import("./velocity-D8B20fx6.js"),[]);return e(o.velocity)}},{name:"Verilog",displayName:s.__("Verilog"),mime:"text/x-verilog",extensions:["v"],async load(){const o=await S(()=>import("./verilog-C6RDOZhf.js"),[]);return e(o.verilog)}},{name:"VHDL",displayName:s.__("VHDL"),mime:"text/x-vhdl",extensions:["vhd","vhdl"],async load(){const o=await S(()=>import("./vhdl-lSbBsy5d.js"),[]);return e(o.vhdl)}},{name:"XQuery",displayName:s.__("XQuery"),mime:"application/xquery",extensions:["xy","xquery"],async load(){const o=await S(()=>import("./xquery-DzFWVndE.js"),[]);return e(o.xQuery)}},{name:"Yacas",displayName:s.__("Yacas"),mime:"text/x-yacas",extensions:["ys"],async load(){const o=await S(()=>import("./yacas-BJ4BC0dw.js"),[]);return e(o.yacas)}},{name:"YAML",displayName:s.__("YAML"),alias:["yml"],mime:["text/x-yaml","text/yaml"],extensions:["yaml","yml"],async load(){const o=await S(()=>import("./yaml-DsCXHVTH.js"),[]);return e(o.yaml)}},{name:"Z80",displayName:s.__("Z80"),mime:"text/x-z80",extensions:["z80"],async load(){const o=await S(()=>import("./z80-Hz9HOZM7.js"),[]);return e(o.z80)}},{name:"mscgen",displayName:s.__("mscgen"),mime:"text/x-mscgen",extensions:["mscgen","mscin","msc"],async load(){const o=await S(()=>import("./mscgen-BA5vi2Kp.js"),[]);return e(o.mscgen)}},{name:"xu",displayName:s.__("xu"),mime:"text/x-xu",extensions:["xu"],async load(){const o=await S(()=>import("./mscgen-BA5vi2Kp.js"),[]);return e(o.xu)}},{name:"msgenny",displayName:s.__("msgenny"),mime:"text/x-msgenny",extensions:["msgenny"],async load(){const o=await S(()=>import("./mscgen-BA5vi2Kp.js"),[]);return e(o.msgenny)}}]}r.getDefaultLanguages=i})(af||(af={}));var lf;(function(r){function e(t,i,n,s){const o=i.getInitialExtensions();return o.push(...n),new N({state:ie.create({doc:s,extensions:o}),parent:t})}r.createEditor=e})(lf||(lf={}));var hf;(function(r){function e(t,i,n=0,s=1/0){for(s=Math.min(t.length-1,s);n<=s;){let l=Math.floor(.5*(n+s));const h=t[l].position;if(h<i){if(n=l+1,n<t.length&&t[n].position>i)return n}else if(h>i){if(s=l-1,s>0&&t[s].position<i)return l}else return l}const o=n>0?n-1:0;return t[o].position>=i?o:null}r.findNext=e})(hf||(hf={}));var Ro={exports:{}},cf;function Jk(){return cf||(cf=1,(function(r){r.exports=(function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}return i.m=e,i.c=t,i.p="",i(0)})([(function(e,t,i){e.exports=i(1)}),(function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});function n(a){return a&&a.__esModule?a:{default:a}}var s=i(2),o=n(s);t.default=o.default,e.exports=t.default}),(function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(p){for(var m=1;m<arguments.length;m++){var g=arguments[m];for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(p[b]=g[b])}return p};t.default=d;function s(p){return p&&p.__esModule?p:{default:p}}function o(p,m){var g={};for(var b in p)m.indexOf(b)>=0||Object.prototype.hasOwnProperty.call(p,b)&&(g[b]=p[b]);return g}var a=i(3),l=i(4),h=s(l),c=i(14),f=i(15),u=s(f);d.propTypes={activeClassName:h.default.string,activeIndex:h.default.number,activeStyle:h.default.object,autoEscape:h.default.bool,className:h.default.string,findChunks:h.default.func,highlightClassName:h.default.oneOfType([h.default.object,h.default.string]),highlightStyle:h.default.object,highlightTag:h.default.oneOfType([h.default.node,h.default.func,h.default.string]),sanitize:h.default.func,searchWords:h.default.arrayOf(h.default.oneOfType([h.default.string,h.default.instanceOf(RegExp)])).isRequired,textToHighlight:h.default.string.isRequired,unhighlightTag:h.default.oneOfType([h.default.node,h.default.func,h.default.string]),unhighlightClassName:h.default.string,unhighlightStyle:h.default.object};function d(p){var m=p.activeClassName,g=m===void 0?"":m,b=p.activeIndex,y=b===void 0?-1:b,x=p.activeStyle,E=p.autoEscape,A=p.caseSensitive,O=A===void 0?!1:A,R=p.className,K=p.findChunks,z=p.highlightClassName,Y=z===void 0?"":z,W=p.highlightStyle,T=W===void 0?{}:W,F=p.highlightTag,V=F===void 0?"mark":F,H=p.sanitize,ae=p.searchWords,le=p.textToHighlight,he=p.unhighlightTag,oe=he===void 0?"span":he,ke=p.unhighlightClassName,Te=ke===void 0?"":ke,w=p.unhighlightStyle,M=o(p,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightTag","unhighlightClassName","unhighlightStyle"]),j=(0,a.findAll)({autoEscape:E,caseSensitive:O,findChunks:K,sanitize:H,searchWords:ae,textToHighlight:le}),q=V,G=-1,Q="",ne=void 0,Z=function(ce){var Be={};for(var He in ce)Be[He.toLowerCase()]=ce[He];return Be},te=(0,u.default)(Z);return(0,c.createElement)("span",n({className:R},M,{children:j.map(function(re,ce){var Be=le.substr(re.start,re.end-re.start);if(re.highlight){G++;var He=void 0;typeof Y=="object"?O?He=Y[Be]:(Y=te(Y),He=Y[Be.toLowerCase()]):He=Y;var gr=G===+y;Q=He+" "+(gr?g:""),ne=gr===!0&&x!=null?Object.assign({},T,x):T;var br={children:Be,className:Q,key:ce,style:ne};return typeof q!="string"&&(br.highlightIndex=G),(0,c.createElement)(q,br)}else return(0,c.createElement)(oe,{children:Be,className:Te,key:ce,style:w})})}))}e.exports=t.default}),(function(e,t){e.exports=(function(i){var n={};function s(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return i[o].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}return s.m=i,s.c=n,s.p="",s(0)})([(function(i,n,s){i.exports=s(1)}),(function(i,n,s){Object.defineProperty(n,"__esModule",{value:!0});var o=s(2);Object.defineProperty(n,"combineChunks",{enumerable:!0,get:function(){return o.combineChunks}}),Object.defineProperty(n,"fillInChunks",{enumerable:!0,get:function(){return o.fillInChunks}}),Object.defineProperty(n,"findAll",{enumerable:!0,get:function(){return o.findAll}}),Object.defineProperty(n,"findChunks",{enumerable:!0,get:function(){return o.findChunks}})}),(function(i,n){Object.defineProperty(n,"__esModule",{value:!0}),n.findAll=function(f){var u=f.autoEscape,d=f.caseSensitive,p=d===void 0?!1:d,m=f.findChunks,g=m===void 0?o:m,b=f.sanitize,y=f.searchWords,x=f.textToHighlight;return a({chunksToHighlight:s({chunks:g({autoEscape:u,caseSensitive:p,sanitize:b,searchWords:y,textToHighlight:x})}),totalLength:x?x.length:0})};var s=n.combineChunks=function(f){var u=f.chunks;return u=u.sort(function(d,p){return d.start-p.start}).reduce(function(d,p){if(d.length===0)return[p];var m=d.pop();if(p.start<=m.end){var g=Math.max(m.end,p.end);d.push({start:m.start,end:g})}else d.push(m,p);return d},[]),u},o=function(f){var u=f.autoEscape,d=f.caseSensitive,p=f.sanitize,m=p===void 0?l:p,g=f.searchWords,b=f.textToHighlight;return b=m(b),g.filter(function(y){return y}).reduce(function(y,x){x=m(x),u&&(x=h(x));for(var E=new RegExp(x,d?"g":"gi"),A=void 0;A=E.exec(b);){var O=A.index,R=E.lastIndex;R>O&&y.push({start:O,end:R}),A.index==E.lastIndex&&E.lastIndex++}return y},[])};n.findChunks=o;var a=n.fillInChunks=function(f){var u=f.chunksToHighlight,d=f.totalLength,p=[],m=function(y,x,E){x-y>0&&p.push({start:y,end:x,highlight:E})};if(u.length===0)m(0,d,!1);else{var g=0;u.forEach(function(b){m(g,b.start,!1),m(b.start,b.end,!0),g=b.end}),m(g,d,!1)}return p};function l(c){return c}function h(c){return c.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}})])}),(function(e,t,i){(function(n){if(n.env.NODE_ENV!=="production"){var s=typeof Symbol=="function"&&Symbol.for&&Symbol.for("react.element")||60103,o=function(l){return typeof l=="object"&&l!==null&&l.$$typeof===s},a=!0;e.exports=i(6)(o,a)}else e.exports=i(13)()}).call(t,i(5))}),(function(e,t){var i=e.exports={},n,s;function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?n=setTimeout:n=o}catch{n=o}try{typeof clearTimeout=="function"?s=clearTimeout:s=a}catch{s=a}})();function l(y){if(n===setTimeout)return setTimeout(y,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(y,0);try{return n(y,0)}catch{try{return n.call(null,y,0)}catch{return n.call(this,y,0)}}}function h(y){if(s===clearTimeout)return clearTimeout(y);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(y);try{return s(y)}catch{try{return s.call(null,y)}catch{return s.call(this,y)}}}var c=[],f=!1,u,d=-1;function p(){!f||!u||(f=!1,u.length?c=u.concat(c):d=-1,c.length&&m())}function m(){if(!f){var y=l(p);f=!0;for(var x=c.length;x;){for(u=c,c=[];++d<x;)u&&u[d].run();d=-1,x=c.length}u=null,f=!1,h(y)}}i.nextTick=function(y){var x=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)x[E-1]=arguments[E];c.push(new g(y,x)),c.length===1&&!f&&l(m)};function g(y,x){this.fun=y,this.array=x}g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function b(){}i.on=b,i.addListener=b,i.once=b,i.off=b,i.removeListener=b,i.removeAllListeners=b,i.emit=b,i.prependListener=b,i.prependOnceListener=b,i.listeners=function(y){return[]},i.binding=function(y){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(y){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}),(function(e,t,i){(function(n){var s=i(7),o=i(8),a=i(9),l=i(10),h=i(11),c=i(12);e.exports=function(f,u){var d=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function m(w){var M=w&&(d&&w[d]||w[p]);if(typeof M=="function")return M}var g="<<anonymous>>",b={array:A("array"),bool:A("boolean"),func:A("function"),number:A("number"),object:A("object"),string:A("string"),symbol:A("symbol"),any:O(),arrayOf:R,element:K(),instanceOf:z,node:F(),objectOf:W,oneOf:Y,oneOfType:T,shape:V,exact:H};function y(w,M){return w===M?w!==0||1/w===1/M:w!==w&&M!==M}function x(w){this.message=w,this.stack=""}x.prototype=Error.prototype;function E(w){if(n.env.NODE_ENV!=="production")var M={},j=0;function q(Q,ne,Z,te,re,ce,Be){if(te=te||g,ce=ce||Z,Be!==h){if(u)o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if(n.env.NODE_ENV!=="production"&&typeof console<"u"){var He=te+":"+Z;!M[He]&&j<3&&(a(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",ce,te),M[He]=!0,j++)}}return ne[Z]==null?Q?ne[Z]===null?new x("The "+re+" `"+ce+"` is marked as required "+("in `"+te+"`, but its value is `null`.")):new x("The "+re+" `"+ce+"` is marked as required in "+("`"+te+"`, but its value is `undefined`.")):null:w(ne,Z,te,re,ce)}var G=q.bind(null,!1);return G.isRequired=q.bind(null,!0),G}function A(w){function M(j,q,G,Q,ne,Z){var te=j[q],re=he(te);if(re!==w){var ce=oe(te);return new x("Invalid "+Q+" `"+ne+"` of type "+("`"+ce+"` supplied to `"+G+"`, expected ")+("`"+w+"`."))}return null}return E(M)}function O(){return E(s.thatReturnsNull)}function R(w){function M(j,q,G,Q,ne){if(typeof w!="function")return new x("Property `"+ne+"` of component `"+G+"` has invalid PropType notation inside arrayOf.");var Z=j[q];if(!Array.isArray(Z)){var te=he(Z);return new x("Invalid "+Q+" `"+ne+"` of type "+("`"+te+"` supplied to `"+G+"`, expected an array."))}for(var re=0;re<Z.length;re++){var ce=w(Z,re,G,Q,ne+"["+re+"]",h);if(ce instanceof Error)return ce}return null}return E(M)}function K(){function w(M,j,q,G,Q){var ne=M[j];if(!f(ne)){var Z=he(ne);return new x("Invalid "+G+" `"+Q+"` of type "+("`"+Z+"` supplied to `"+q+"`, expected a single ReactElement."))}return null}return E(w)}function z(w){function M(j,q,G,Q,ne){if(!(j[q]instanceof w)){var Z=w.name||g,te=Te(j[q]);return new x("Invalid "+Q+" `"+ne+"` of type "+("`"+te+"` supplied to `"+G+"`, expected ")+("instance of `"+Z+"`."))}return null}return E(M)}function Y(w){if(!Array.isArray(w))return n.env.NODE_ENV!=="production"&&a(!1,"Invalid argument supplied to oneOf, expected an instance of array."),s.thatReturnsNull;function M(j,q,G,Q,ne){for(var Z=j[q],te=0;te<w.length;te++)if(y(Z,w[te]))return null;var re=JSON.stringify(w);return new x("Invalid "+Q+" `"+ne+"` of value `"+Z+"` "+("supplied to `"+G+"`, expected one of "+re+"."))}return E(M)}function W(w){function M(j,q,G,Q,ne){if(typeof w!="function")return new x("Property `"+ne+"` of component `"+G+"` has invalid PropType notation inside objectOf.");var Z=j[q],te=he(Z);if(te!=="object")return new x("Invalid "+Q+" `"+ne+"` of type "+("`"+te+"` supplied to `"+G+"`, expected an object."));for(var re in Z)if(Z.hasOwnProperty(re)){var ce=w(Z,re,G,Q,ne+"."+re,h);if(ce instanceof Error)return ce}return null}return E(M)}function T(w){if(!Array.isArray(w))return n.env.NODE_ENV!=="production"&&a(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),s.thatReturnsNull;for(var M=0;M<w.length;M++){var j=w[M];if(typeof j!="function")return a(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",ke(j),M),s.thatReturnsNull}function q(G,Q,ne,Z,te){for(var re=0;re<w.length;re++){var ce=w[re];if(ce(G,Q,ne,Z,te,h)==null)return null}return new x("Invalid "+Z+" `"+te+"` supplied to "+("`"+ne+"`."))}return E(q)}function F(){function w(M,j,q,G,Q){return ae(M[j])?null:new x("Invalid "+G+" `"+Q+"` supplied to "+("`"+q+"`, expected a ReactNode."))}return E(w)}function V(w){function M(j,q,G,Q,ne){var Z=j[q],te=he(Z);if(te!=="object")return new x("Invalid "+Q+" `"+ne+"` of type `"+te+"` "+("supplied to `"+G+"`, expected `object`."));for(var re in w){var ce=w[re];if(ce){var Be=ce(Z,re,G,Q,ne+"."+re,h);if(Be)return Be}}return null}return E(M)}function H(w){function M(j,q,G,Q,ne){var Z=j[q],te=he(Z);if(te!=="object")return new x("Invalid "+Q+" `"+ne+"` of type `"+te+"` "+("supplied to `"+G+"`, expected `object`."));var re=l({},j[q],w);for(var ce in re){var Be=w[ce];if(!Be)return new x("Invalid "+Q+" `"+ne+"` key `"+ce+"` supplied to `"+G+"`.\nBad object: "+JSON.stringify(j[q],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(w),null,"  "));var He=Be(Z,ce,G,Q,ne+"."+ce,h);if(He)return He}return null}return E(M)}function ae(w){switch(typeof w){case"number":case"string":case"undefined":return!0;case"boolean":return!w;case"object":if(Array.isArray(w))return w.every(ae);if(w===null||f(w))return!0;var M=m(w);if(M){var j=M.call(w),q;if(M!==w.entries){for(;!(q=j.next()).done;)if(!ae(q.value))return!1}else for(;!(q=j.next()).done;){var G=q.value;if(G&&!ae(G[1]))return!1}}else return!1;return!0;default:return!1}}function le(w,M){return w==="symbol"||M["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&M instanceof Symbol}function he(w){var M=typeof w;return Array.isArray(w)?"array":w instanceof RegExp?"object":le(M,w)?"symbol":M}function oe(w){if(typeof w>"u"||w===null)return""+w;var M=he(w);if(M==="object"){if(w instanceof Date)return"date";if(w instanceof RegExp)return"regexp"}return M}function ke(w){var M=oe(w);switch(M){case"array":case"object":return"an "+M;case"boolean":case"date":case"regexp":return"a "+M;default:return M}}function Te(w){return!w.constructor||!w.constructor.name?g:w.constructor.name}return b.checkPropTypes=c,b.PropTypes=b,b}}).call(t,i(5))}),(function(e,t){function i(s){return function(){return s}}var n=function(){};n.thatReturns=i,n.thatReturnsFalse=i(!1),n.thatReturnsTrue=i(!0),n.thatReturnsNull=i(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(s){return s},e.exports=n}),(function(e,t,i){(function(n){var s=function(l){};n.env.NODE_ENV!=="production"&&(s=function(l){if(l===void 0)throw new Error("invariant requires an error message argument")});function o(a,l,h,c,f,u,d,p){if(s(l),!a){var m;if(l===void 0)m=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var g=[h,c,f,u,d,p],b=0;m=new Error(l.replace(/%s/g,function(){return g[b++]})),m.name="Invariant Violation"}throw m.framesToPop=1,m}}e.exports=o}).call(t,i(5))}),(function(e,t,i){(function(n){var s=i(7),o=s;if(n.env.NODE_ENV!=="production"){var a=function(h){for(var c=arguments.length,f=Array(c>1?c-1:0),u=1;u<c;u++)f[u-1]=arguments[u];var d=0,p="Warning: "+h.replace(/%s/g,function(){return f[d++]});typeof console<"u"&&console.error(p);try{throw new Error(p)}catch{}};o=function(h,c){if(c===void 0)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(c.indexOf("Failed Composite propType: ")!==0&&!h){for(var f=arguments.length,u=Array(f>2?f-2:0),d=2;d<f;d++)u[d-2]=arguments[d];a.apply(void 0,[c].concat(u))}}}e.exports=o}).call(t,i(5))}),(function(e,t){var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(l){if(l==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(l)}function a(){try{if(!Object.assign)return!1;var l=new String("abc");if(l[5]="de",Object.getOwnPropertyNames(l)[0]==="5")return!1;for(var h={},c=0;c<10;c++)h["_"+String.fromCharCode(c)]=c;var f=Object.getOwnPropertyNames(h).map(function(d){return h[d]});if(f.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function(d){u[d]=d}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}e.exports=a()?Object.assign:function(l,h){for(var c,f=o(l),u,d=1;d<arguments.length;d++){c=Object(arguments[d]);for(var p in c)n.call(c,p)&&(f[p]=c[p]);if(i){u=i(c);for(var m=0;m<u.length;m++)s.call(c,u[m])&&(f[u[m]]=c[u[m]])}}return f}}),(function(e,t){var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";e.exports=i}),(function(e,t,i){(function(n){if(n.env.NODE_ENV!=="production")var s=i(8),o=i(9),a=i(11),l={};function h(c,f,u,d,p){if(n.env.NODE_ENV!=="production"){for(var m in c)if(c.hasOwnProperty(m)){var g;try{s(typeof c[m]=="function","%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",d||"React class",u,m,typeof c[m]),g=c[m](f,m,d,u,null,a)}catch(y){g=y}if(o(!g||g instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",d||"React class",u,m,typeof g),g instanceof Error&&!(g.message in l)){l[g.message]=!0;var b=p?p():"";o(!1,"Failed %s type: %s%s",u,g.message,b??"")}}}}e.exports=h}).call(t,i(5))}),(function(e,t,i){var n=i(7),s=i(8),o=i(11);e.exports=function(){function a(c,f,u,d,p,m){m!==o&&s(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}a.isRequired=a;function l(){return a}var h={array:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:l,element:a,instanceOf:l,node:a,objectOf:l,oneOf:l,oneOfType:l,shape:l,exact:l};return h.checkPropTypes=n,h.PropTypes=h,h}}),(function(e,t){e.exports=Cm()}),(function(e,t){var i=function(o,a){return o===a};function n(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,a=void 0,l=[],h=void 0,c=!1,f=function(p,m){return o(p,l[m])},u=function(){for(var p=arguments.length,m=Array(p),g=0;g<p;g++)m[g]=arguments[g];return c&&a===this&&m.length===l.length&&m.every(f)||(c=!0,a=this,l=m,h=s.apply(this,m)),h};return u}e.exports=n})])})(Ro)),Ro.exports}var Yk=Jk();const ff=Ka(Yk);function Xk(r){const e=Object.prototype.toString.call(r).slice(8,-1);return e==="Object"&&typeof r[Symbol.iterator]=="function"?"Iterable":e==="Custom"&&r.constructor!==Object&&r instanceof Object?"Object":e}function zp(r){let{styling:e,arrowStyle:t="single",expanded:i,nodeType:n,onClick:s}=r;return B.createElement("div",Ge({},e("arrowContainer",t),{onClick:s}),B.createElement("div",e(["arrow","arrowSign"],n,i,t),"",t==="double"&&B.createElement("div",e(["arrowSign","arrowSignInner"]),"")))}function Qk(r,e){return r==="Object"?Object.keys(e).length:r==="Array"?e.length:1/0}function Zk(r){return typeof r.set=="function"}function ew(r,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1/0,s;if(r==="Object"){let o=Object.getOwnPropertyNames(e);t&&o.sort(t===!0?void 0:t),o=o.slice(i,n+1),s={entries:o.map(a=>({key:a,value:e[a]}))}}else if(r==="Array")s={entries:e.slice(i,n+1).map((o,a)=>({key:a+i,value:o}))};else{let o=0;const a=[];let l=!0;const h=Zk(e);for(const c of e){if(o>n){l=!1;break}i<=o&&(h&&Array.isArray(c)?typeof c[0]=="string"||typeof c[0]=="number"?a.push({key:c[0],value:c[1]}):a.push({key:`[entry ${o}]`,value:{"[key]":c[0],"[value]":c[1]}}):a.push({key:o,value:c})),o++}s={hasMore:!l,entries:a}}return s}function Do(r,e,t){const i=[];for(;e-r>t*t;)t=t*t;for(let n=r;n<=e;n+=t)i.push({from:n,to:Math.min(e,n+t-1)});return i}function tw(r,e,t,i){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0;const o=ew.bind(null,r,e,t);if(!i)return o().entries;const a=s<1/0,l=Math.min(s-n,Qk(r,e));if(r!=="Iterable"){if(l<=i||i<7)return o(n,s).entries}else if(l<=i&&!a)return o(n,s).entries;let h;if(r==="Iterable"){const{hasMore:c,entries:f}=o(n,n+i-1);h=c?[...f,...Do(n+i,n+2*i-1,i)]:f}else h=a?Do(n,s,i):[...o(0,i-5).entries,...Do(i-4,l-5,i),...o(l-4,l-1).entries];return h}function iw(r){const{styling:e,from:t,to:i,renderChildNodes:n,nodeType:s}=r,[o,a]=Ze.useState(!1),l=Ze.useCallback(()=>{a(!o)},[o]);return o?B.createElement("div",e("itemRange",o),n(r,t,i)):B.createElement("div",Ge({},e("itemRange",o),{onClick:l}),B.createElement(zp,{nodeType:s,styling:e,expanded:!1,onClick:l,arrowStyle:"double"}),`${t} ... ${i}`)}function nw(r){return r.to!==void 0}function Vp(r,e,t){const{nodeType:i,data:n,collectionLimit:s,circularCache:o,keyPath:a,postprocessValue:l,sortObjectKeys:h}=r,c=[];return tw(i,n,h,s,e,t).forEach(f=>{if(nw(f))c.push(B.createElement(iw,Ge({},r,{key:`ItemRange--${f.from}-${f.to}`,from:f.from,to:f.to,renderChildNodes:Vp})));else{const{key:u,value:d}=f,p=o.indexOf(d)!==-1;c.push(B.createElement(Wp,Ge({},r,{postprocessValue:l,collectionLimit:s,key:`Node--${u}`,keyPath:[u,...a],value:l(d),circularCache:[...o,d],isCircular:p,hideRoot:!1})))}}),c}function Bl(r){const{circularCache:e=[],collectionLimit:t,createItemString:i,data:n,expandable:s,getItemString:o,hideRoot:a,isCircular:l,keyPath:h,labelRenderer:c,level:f=0,nodeType:u,nodeTypeIndicator:d,shouldExpandNodeInitially:p,styling:m}=r,[g,b]=Ze.useState(l?!1:p(h,n,f)),y=Ze.useCallback(()=>{s&&b(!g)},[s,g]),x=g||a&&f===0?Vp({...r,circularCache:e,level:f+1}):null,E=B.createElement("span",m("nestedNodeItemType",g),d),A=o(u,n,E,i(n,t),h),O=[h,u,g,s];return a?B.createElement("li",m("rootNode",...O),B.createElement("ul",m("rootNodeChildren",...O),x)):B.createElement("li",m("nestedNode",...O),s&&B.createElement(zp,{styling:m,nodeType:u,expanded:g,onClick:y}),B.createElement("label",Ge({},m(["label","nestedNodeLabel"],...O),{onClick:y}),c(...O)),B.createElement("span",Ge({},m("nestedNodeItemString",...O),{onClick:y}),A),B.createElement("ul",m("nestedNodeChildren",...O),x))}function rw(r){const e=Object.getOwnPropertyNames(r).length;return`${e} ${e!==1?"keys":"key"}`}function sw(r){let{data:e,...t}=r;return B.createElement(Bl,Ge({},t,{data:e,nodeType:"Object",nodeTypeIndicator:t.nodeType==="Error"?"Error()":"{}",createItemString:rw,expandable:Object.getOwnPropertyNames(e).length>0}))}function ow(r){return`${r.length} ${r.length!==1?"items":"item"}`}function aw(r){let{data:e,...t}=r;return B.createElement(Bl,Ge({},t,{data:e,nodeType:"Array",nodeTypeIndicator:"[]",createItemString:ow,expandable:e.length>0}))}function lw(r,e){let t=0,i=!1;if(Number.isSafeInteger(r.size))t=r.size;else for(const n of r){if(e&&t+1>e){i=!0;break}t+=1}return`${i?">":""}${t} ${t!==1?"entries":"entry"}`}function hw(r){return B.createElement(Bl,Ge({},r,{nodeType:"Iterable",nodeTypeIndicator:"()",createItemString:lw,expandable:!0}))}function $t(r){let{nodeType:e,styling:t,labelRenderer:i,keyPath:n,valueRenderer:s,value:o,valueGetter:a=l=>l}=r;return B.createElement("li",t("value",e,n),B.createElement("label",t(["label","valueLabel"],e,n),i(n,e,!1,!1)),B.createElement("span",t("valueText",e,n),s(a(o),o,...n)))}function Wp(r){let{getItemString:e,keyPath:t,labelRenderer:i,styling:n,value:s,valueRenderer:o,isCustomNode:a,...l}=r;const h=a(s)?"Custom":Xk(s),c={getItemString:e,key:t[0],keyPath:t,labelRenderer:i,nodeType:h,styling:n,value:s,valueRenderer:o},f={...l,...c,data:s,isCustomNode:a};switch(h){case"Object":case"Error":case"WeakMap":case"WeakSet":return B.createElement(sw,f);case"Array":return B.createElement(aw,f);case"Iterable":case"Map":case"Set":return B.createElement(hw,f);case"String":return B.createElement($t,Ge({},c,{valueGetter:u=>`"${u}"`}));case"Number":return B.createElement($t,c);case"Boolean":return B.createElement($t,Ge({},c,{valueGetter:u=>u?"true":"false"}));case"Date":return B.createElement($t,Ge({},c,{valueGetter:u=>u.toISOString()}));case"Null":return B.createElement($t,Ge({},c,{valueGetter:()=>"null"}));case"Undefined":return B.createElement($t,Ge({},c,{valueGetter:()=>"undefined"}));case"Function":case"Symbol":return B.createElement($t,Ge({},c,{valueGetter:u=>u.toString()}));case"Custom":return B.createElement($t,c);default:return B.createElement($t,Ge({},c,{valueGetter:()=>`<${h}>`}))}}function cw(r){if(Array.isArray(r))return r}function fw(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,n,s,o,a=[],l=!0,h=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){h=!0,n=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw n}}return a}}function uw(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hp(r,e){return cw(r)||fw(r,e)||_m(r,e)||uw()}const dw={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},pw={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},mw={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},gw={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},bw={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},yw={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},vw={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},xw={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},kw={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},ww={scheme:"brewer",author:"timothe poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},Sw={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},Cw={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},_w={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},Aw={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},qp={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},Tw={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},Ew={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},Ow={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},Mw={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},Rw={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},Dw={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},Pw={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},Lw={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},Iw={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},Nw={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},Bw={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},jw={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},Fw={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},$w={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},zw={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},Vw={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},Ww={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},Hw={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},qw={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},Gw={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},Uw={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},Kw={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"},Jw=Object.freeze(Object.defineProperty({__proto__:null,apathy:pw,ashes:mw,atelierDune:gw,atelierForest:bw,atelierHeath:yw,atelierLakeside:vw,atelierSeaside:xw,bespin:kw,brewer:ww,bright:Sw,chalk:Cw,codeschool:_w,colors:Aw,default:qp,eighties:Tw,embers:Ew,flat:Ow,google:Mw,grayscale:Rw,greenscreen:Dw,harmonic:Pw,hopscotch:Lw,isotope:Iw,marrakesh:Nw,mocha:Bw,monokai:jw,ocean:Fw,paraiso:$w,pop:zw,railscasts:Vw,shapeshifter:Ww,solarized:Hw,summerfruit:qw,threezerotwofour:dw,tomorrow:Gw,tube:Uw,twilight:Kw},Symbol.toStringTag,{value:"Module"}));var Po={exports:{}},Lo,uf;function Yw(){return uf||(uf=1,Lo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Lo}var Io={exports:{}},No,df;function Xw(){return df||(df=1,No=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),No}var pf;function Qw(){if(pf)return Io.exports;pf=1;var r=Xw(),e=Array.prototype.concat,t=Array.prototype.slice,i=Io.exports=function(s){for(var o=[],a=0,l=s.length;a<l;a++){var h=s[a];r(h)?o=e.call(o,t.call(h)):o.push(h)}return o};return i.wrap=function(n){return function(){return n(i(arguments))}},Io.exports}var mf;function Zw(){if(mf)return Po.exports;mf=1;var r=Yw(),e=Qw(),t=Object.hasOwnProperty,i=Object.create(null);for(var n in r)t.call(r,n)&&(i[r[n]]=n);var s=Po.exports={to:{},get:{}};s.get=function(l){var h=l.substring(0,3).toLowerCase(),c,f;switch(h){case"hsl":c=s.get.hsl(l),f="hsl";break;case"hwb":c=s.get.hwb(l),f="hwb";break;default:c=s.get.rgb(l),f="rgb";break}return c?{model:f,value:c}:null},s.get.rgb=function(l){if(!l)return null;var h=/^#([a-f0-9]{3,4})$/i,c=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,f=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,u=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,d=/^(\w+)$/,p=[0,0,0,1],m,g,b;if(m=l.match(c)){for(b=m[2],m=m[1],g=0;g<3;g++){var y=g*2;p[g]=parseInt(m.slice(y,y+2),16)}b&&(p[3]=parseInt(b,16)/255)}else if(m=l.match(h)){for(m=m[1],b=m[3],g=0;g<3;g++)p[g]=parseInt(m[g]+m[g],16);b&&(p[3]=parseInt(b+b,16)/255)}else if(m=l.match(f)){for(g=0;g<3;g++)p[g]=parseInt(m[g+1],0);m[4]&&(m[5]?p[3]=parseFloat(m[4])*.01:p[3]=parseFloat(m[4]))}else if(m=l.match(u)){for(g=0;g<3;g++)p[g]=Math.round(parseFloat(m[g+1])*2.55);m[4]&&(m[5]?p[3]=parseFloat(m[4])*.01:p[3]=parseFloat(m[4]))}else return(m=l.match(d))?m[1]==="transparent"?[0,0,0,0]:t.call(r,m[1])?(p=r[m[1]],p[3]=1,p):null:null;for(g=0;g<3;g++)p[g]=o(p[g],0,255);return p[3]=o(p[3],0,1),p},s.get.hsl=function(l){if(!l)return null;var h=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(h);if(c){var f=parseFloat(c[4]),u=(parseFloat(c[1])%360+360)%360,d=o(parseFloat(c[2]),0,100),p=o(parseFloat(c[3]),0,100),m=o(isNaN(f)?1:f,0,1);return[u,d,p,m]}return null},s.get.hwb=function(l){if(!l)return null;var h=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(h);if(c){var f=parseFloat(c[4]),u=(parseFloat(c[1])%360+360)%360,d=o(parseFloat(c[2]),0,100),p=o(parseFloat(c[3]),0,100),m=o(isNaN(f)?1:f,0,1);return[u,d,p,m]}return null},s.to.hex=function(){var l=e(arguments);return"#"+a(l[0])+a(l[1])+a(l[2])+(l[3]<1?a(Math.round(l[3]*255)):"")},s.to.rgb=function(){var l=e(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},s.to.rgb.percent=function(){var l=e(arguments),h=Math.round(l[0]/255*100),c=Math.round(l[1]/255*100),f=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+h+"%, "+c+"%, "+f+"%)":"rgba("+h+"%, "+c+"%, "+f+"%, "+l[3]+")"},s.to.hsl=function(){var l=e(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},s.to.hwb=function(){var l=e(arguments),h="";return l.length>=4&&l[3]!==1&&(h=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+h+")"},s.to.keyword=function(l){return i[l.slice(0,3)]};function o(l,h,c){return Math.min(Math.max(h,l),c)}function a(l){var h=Math.round(l).toString(16).toUpperCase();return h.length<2?"0"+h:h}return Po.exports}var Bo={exports:{}},jo,gf;function e2(){return gf||(gf=1,jo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),jo}var bf;function Gp(){if(bf)return Bo.exports;bf=1;var r=e2(),e={};for(var t in r)r.hasOwnProperty(t)&&(e[r[t]]=t);var i=Bo.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var n in i)if(i.hasOwnProperty(n)){if(!("channels"in i[n]))throw new Error("missing channels property: "+n);if(!("labels"in i[n]))throw new Error("missing channel labels property: "+n);if(i[n].labels.length!==i[n].channels)throw new Error("channel and label counts mismatch: "+n);var s=i[n].channels,o=i[n].labels;delete i[n].channels,delete i[n].labels,Object.defineProperty(i[n],"channels",{value:s}),Object.defineProperty(i[n],"labels",{value:o})}i.rgb.hsl=function(l){var h=l[0]/255,c=l[1]/255,f=l[2]/255,u=Math.min(h,c,f),d=Math.max(h,c,f),p=d-u,m,g,b;return d===u?m=0:h===d?m=(c-f)/p:c===d?m=2+(f-h)/p:f===d&&(m=4+(h-c)/p),m=Math.min(m*60,360),m<0&&(m+=360),b=(u+d)/2,d===u?g=0:b<=.5?g=p/(d+u):g=p/(2-d-u),[m,g*100,b*100]},i.rgb.hsv=function(l){var h,c,f,u,d,p=l[0]/255,m=l[1]/255,g=l[2]/255,b=Math.max(p,m,g),y=b-Math.min(p,m,g),x=function(E){return(b-E)/6/y+1/2};return y===0?u=d=0:(d=y/b,h=x(p),c=x(m),f=x(g),p===b?u=f-c:m===b?u=1/3+h-f:g===b&&(u=2/3+c-h),u<0?u+=1:u>1&&(u-=1)),[u*360,d*100,b*100]},i.rgb.hwb=function(l){var h=l[0],c=l[1],f=l[2],u=i.rgb.hsl(l)[0],d=1/255*Math.min(h,Math.min(c,f));return f=1-1/255*Math.max(h,Math.max(c,f)),[u,d*100,f*100]},i.rgb.cmyk=function(l){var h=l[0]/255,c=l[1]/255,f=l[2]/255,u,d,p,m;return m=Math.min(1-h,1-c,1-f),u=(1-h-m)/(1-m)||0,d=(1-c-m)/(1-m)||0,p=(1-f-m)/(1-m)||0,[u*100,d*100,p*100,m*100]};function a(l,h){return Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)+Math.pow(l[2]-h[2],2)}return i.rgb.keyword=function(l){var h=e[l];if(h)return h;var c=1/0,f;for(var u in r)if(r.hasOwnProperty(u)){var d=r[u],p=a(l,d);p<c&&(c=p,f=u)}return f},i.keyword.rgb=function(l){return r[l]},i.rgb.xyz=function(l){var h=l[0]/255,c=l[1]/255,f=l[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92;var u=h*.4124+c*.3576+f*.1805,d=h*.2126+c*.7152+f*.0722,p=h*.0193+c*.1192+f*.9505;return[u*100,d*100,p*100]},i.rgb.lab=function(l){var h=i.rgb.xyz(l),c=h[0],f=h[1],u=h[2],d,p,m;return c/=95.047,f/=100,u/=108.883,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,d=116*f-16,p=500*(c-f),m=200*(f-u),[d,p,m]},i.hsl.rgb=function(l){var h=l[0]/360,c=l[1]/100,f=l[2]/100,u,d,p,m,g;if(c===0)return g=f*255,[g,g,g];f<.5?d=f*(1+c):d=f+c-f*c,u=2*f-d,m=[0,0,0];for(var b=0;b<3;b++)p=h+1/3*-(b-1),p<0&&p++,p>1&&p--,6*p<1?g=u+(d-u)*6*p:2*p<1?g=d:3*p<2?g=u+(d-u)*(2/3-p)*6:g=u,m[b]=g*255;return m},i.hsl.hsv=function(l){var h=l[0],c=l[1]/100,f=l[2]/100,u=c,d=Math.max(f,.01),p,m;return f*=2,c*=f<=1?f:2-f,u*=d<=1?d:2-d,m=(f+c)/2,p=f===0?2*u/(d+u):2*c/(f+c),[h,p*100,m*100]},i.hsv.rgb=function(l){var h=l[0]/60,c=l[1]/100,f=l[2]/100,u=Math.floor(h)%6,d=h-Math.floor(h),p=255*f*(1-c),m=255*f*(1-c*d),g=255*f*(1-c*(1-d));switch(f*=255,u){case 0:return[f,g,p];case 1:return[m,f,p];case 2:return[p,f,g];case 3:return[p,m,f];case 4:return[g,p,f];case 5:return[f,p,m]}},i.hsv.hsl=function(l){var h=l[0],c=l[1]/100,f=l[2]/100,u=Math.max(f,.01),d,p,m;return m=(2-c)*f,d=(2-c)*u,p=c*u,p/=d<=1?d:2-d,p=p||0,m/=2,[h,p*100,m*100]},i.hwb.rgb=function(l){var h=l[0]/360,c=l[1]/100,f=l[2]/100,u=c+f,d,p,m,g;u>1&&(c/=u,f/=u),d=Math.floor(6*h),p=1-f,m=6*h-d,(d&1)!==0&&(m=1-m),g=c+m*(p-c);var b,y,x;switch(d){default:case 6:case 0:b=p,y=g,x=c;break;case 1:b=g,y=p,x=c;break;case 2:b=c,y=p,x=g;break;case 3:b=c,y=g,x=p;break;case 4:b=g,y=c,x=p;break;case 5:b=p,y=c,x=g;break}return[b*255,y*255,x*255]},i.cmyk.rgb=function(l){var h=l[0]/100,c=l[1]/100,f=l[2]/100,u=l[3]/100,d,p,m;return d=1-Math.min(1,h*(1-u)+u),p=1-Math.min(1,c*(1-u)+u),m=1-Math.min(1,f*(1-u)+u),[d*255,p*255,m*255]},i.xyz.rgb=function(l){var h=l[0]/100,c=l[1]/100,f=l[2]/100,u,d,p;return u=h*3.2406+c*-1.5372+f*-.4986,d=h*-.9689+c*1.8758+f*.0415,p=h*.0557+c*-.204+f*1.057,u=u>.0031308?1.055*Math.pow(u,1/2.4)-.055:u*12.92,d=d>.0031308?1.055*Math.pow(d,1/2.4)-.055:d*12.92,p=p>.0031308?1.055*Math.pow(p,1/2.4)-.055:p*12.92,u=Math.min(Math.max(0,u),1),d=Math.min(Math.max(0,d),1),p=Math.min(Math.max(0,p),1),[u*255,d*255,p*255]},i.xyz.lab=function(l){var h=l[0],c=l[1],f=l[2],u,d,p;return h/=95.047,c/=100,f/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,u=116*c-16,d=500*(h-c),p=200*(c-f),[u,d,p]},i.lab.xyz=function(l){var h=l[0],c=l[1],f=l[2],u,d,p;d=(h+16)/116,u=c/500+d,p=d-f/200;var m=Math.pow(d,3),g=Math.pow(u,3),b=Math.pow(p,3);return d=m>.008856?m:(d-16/116)/7.787,u=g>.008856?g:(u-16/116)/7.787,p=b>.008856?b:(p-16/116)/7.787,u*=95.047,d*=100,p*=108.883,[u,d,p]},i.lab.lch=function(l){var h=l[0],c=l[1],f=l[2],u,d,p;return u=Math.atan2(f,c),d=u*360/2/Math.PI,d<0&&(d+=360),p=Math.sqrt(c*c+f*f),[h,p,d]},i.lch.lab=function(l){var h=l[0],c=l[1],f=l[2],u,d,p;return p=f/360*2*Math.PI,u=c*Math.cos(p),d=c*Math.sin(p),[h,u,d]},i.rgb.ansi16=function(l){var h=l[0],c=l[1],f=l[2],u=1 in arguments?arguments[1]:i.rgb.hsv(l)[2];if(u=Math.round(u/50),u===0)return 30;var d=30+(Math.round(f/255)<<2|Math.round(c/255)<<1|Math.round(h/255));return u===2&&(d+=60),d},i.hsv.ansi16=function(l){return i.rgb.ansi16(i.hsv.rgb(l),l[2])},i.rgb.ansi256=function(l){var h=l[0],c=l[1],f=l[2];if(h===c&&c===f)return h<8?16:h>248?231:Math.round((h-8)/247*24)+232;var u=16+36*Math.round(h/255*5)+6*Math.round(c/255*5)+Math.round(f/255*5);return u},i.ansi16.rgb=function(l){var h=l%10;if(h===0||h===7)return l>50&&(h+=3.5),h=h/10.5*255,[h,h,h];var c=(~~(l>50)+1)*.5,f=(h&1)*c*255,u=(h>>1&1)*c*255,d=(h>>2&1)*c*255;return[f,u,d]},i.ansi256.rgb=function(l){if(l>=232){var h=(l-232)*10+8;return[h,h,h]}l-=16;var c,f=Math.floor(l/36)/5*255,u=Math.floor((c=l%36)/6)/5*255,d=c%6/5*255;return[f,u,d]},i.rgb.hex=function(l){var h=((Math.round(l[0])&255)<<16)+((Math.round(l[1])&255)<<8)+(Math.round(l[2])&255),c=h.toString(16).toUpperCase();return"000000".substring(c.length)+c},i.hex.rgb=function(l){var h=l.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!h)return[0,0,0];var c=h[0];h[0].length===3&&(c=c.split("").map(function(m){return m+m}).join(""));var f=parseInt(c,16),u=f>>16&255,d=f>>8&255,p=f&255;return[u,d,p]},i.rgb.hcg=function(l){var h=l[0]/255,c=l[1]/255,f=l[2]/255,u=Math.max(Math.max(h,c),f),d=Math.min(Math.min(h,c),f),p=u-d,m,g;return p<1?m=d/(1-p):m=0,p<=0?g=0:u===h?g=(c-f)/p%6:u===c?g=2+(f-h)/p:g=4+(h-c)/p+4,g/=6,g%=1,[g*360,p*100,m*100]},i.hsl.hcg=function(l){var h=l[1]/100,c=l[2]/100,f=1,u=0;return c<.5?f=2*h*c:f=2*h*(1-c),f<1&&(u=(c-.5*f)/(1-f)),[l[0],f*100,u*100]},i.hsv.hcg=function(l){var h=l[1]/100,c=l[2]/100,f=h*c,u=0;return f<1&&(u=(c-f)/(1-f)),[l[0],f*100,u*100]},i.hcg.rgb=function(l){var h=l[0]/360,c=l[1]/100,f=l[2]/100;if(c===0)return[f*255,f*255,f*255];var u=[0,0,0],d=h%1*6,p=d%1,m=1-p,g=0;switch(Math.floor(d)){case 0:u[0]=1,u[1]=p,u[2]=0;break;case 1:u[0]=m,u[1]=1,u[2]=0;break;case 2:u[0]=0,u[1]=1,u[2]=p;break;case 3:u[0]=0,u[1]=m,u[2]=1;break;case 4:u[0]=p,u[1]=0,u[2]=1;break;default:u[0]=1,u[1]=0,u[2]=m}return g=(1-c)*f,[(c*u[0]+g)*255,(c*u[1]+g)*255,(c*u[2]+g)*255]},i.hcg.hsv=function(l){var h=l[1]/100,c=l[2]/100,f=h+c*(1-h),u=0;return f>0&&(u=h/f),[l[0],u*100,f*100]},i.hcg.hsl=function(l){var h=l[1]/100,c=l[2]/100,f=c*(1-h)+.5*h,u=0;return f>0&&f<.5?u=h/(2*f):f>=.5&&f<1&&(u=h/(2*(1-f))),[l[0],u*100,f*100]},i.hcg.hwb=function(l){var h=l[1]/100,c=l[2]/100,f=h+c*(1-h);return[l[0],(f-h)*100,(1-f)*100]},i.hwb.hcg=function(l){var h=l[1]/100,c=l[2]/100,f=1-c,u=f-h,d=0;return u<1&&(d=(f-u)/(1-u)),[l[0],u*100,d*100]},i.apple.rgb=function(l){return[l[0]/65535*255,l[1]/65535*255,l[2]/65535*255]},i.rgb.apple=function(l){return[l[0]/255*65535,l[1]/255*65535,l[2]/255*65535]},i.gray.rgb=function(l){return[l[0]/100*255,l[0]/100*255,l[0]/100*255]},i.gray.hsl=i.gray.hsv=function(l){return[0,0,l[0]]},i.gray.hwb=function(l){return[0,100,l[0]]},i.gray.cmyk=function(l){return[0,0,0,l[0]]},i.gray.lab=function(l){return[l[0],0,0]},i.gray.hex=function(l){var h=Math.round(l[0]/100*255)&255,c=(h<<16)+(h<<8)+h,f=c.toString(16).toUpperCase();return"000000".substring(f.length)+f},i.rgb.gray=function(l){var h=(l[0]+l[1]+l[2])/3;return[h/255*100]},Bo.exports}var Fo,yf;function t2(){if(yf)return Fo;yf=1;var r=Gp();function e(){for(var s={},o=Object.keys(r),a=o.length,l=0;l<a;l++)s[o[l]]={distance:-1,parent:null};return s}function t(s){var o=e(),a=[s];for(o[s].distance=0;a.length;)for(var l=a.pop(),h=Object.keys(r[l]),c=h.length,f=0;f<c;f++){var u=h[f],d=o[u];d.distance===-1&&(d.distance=o[l].distance+1,d.parent=l,a.unshift(u))}return o}function i(s,o){return function(a){return o(s(a))}}function n(s,o){for(var a=[o[s].parent,s],l=r[o[s].parent][s],h=o[s].parent;o[h].parent;)a.unshift(o[h].parent),l=i(r[o[h].parent][h],l),h=o[h].parent;return l.conversion=a,l}return Fo=function(s){for(var o=t(s),a={},l=Object.keys(o),h=l.length,c=0;c<h;c++){var f=l[c],u=o[f];u.parent!==null&&(a[f]=n(f,o))}return a},Fo}var $o,vf;function i2(){if(vf)return $o;vf=1;var r=Gp(),e=t2(),t={},i=Object.keys(r);function n(o){var a=function(l){return l==null?l:(arguments.length>1&&(l=Array.prototype.slice.call(arguments)),o(l))};return"conversion"in o&&(a.conversion=o.conversion),a}function s(o){var a=function(l){if(l==null)return l;arguments.length>1&&(l=Array.prototype.slice.call(arguments));var h=o(l);if(typeof h=="object")for(var c=h.length,f=0;f<c;f++)h[f]=Math.round(h[f]);return h};return"conversion"in o&&(a.conversion=o.conversion),a}return i.forEach(function(o){t[o]={},Object.defineProperty(t[o],"channels",{value:r[o].channels}),Object.defineProperty(t[o],"labels",{value:r[o].labels});var a=e(o),l=Object.keys(a);l.forEach(function(h){var c=a[h];t[o][h]=s(c),t[o][h].raw=n(c)})}),$o=t,$o}var zo,xf;function n2(){if(xf)return zo;xf=1;var r=Zw(),e=i2(),t=[].slice,i=["keyword","gray","hex"],n={};Object.keys(e).forEach(function(d){n[t.call(e[d].labels).sort().join("")]=d});var s={};function o(d,p){if(!(this instanceof o))return new o(d,p);if(p&&p in i&&(p=null),p&&!(p in e))throw new Error("Unknown model: "+p);var m,g;if(d==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(d instanceof o)this.model=d.model,this.color=d.color.slice(),this.valpha=d.valpha;else if(typeof d=="string"){var b=r.get(d);if(b===null)throw new Error("Unable to parse color from string: "+d);this.model=b.model,g=e[this.model].channels,this.color=b.value.slice(0,g),this.valpha=typeof b.value[g]=="number"?b.value[g]:1}else if(d.length){this.model=p||"rgb",g=e[this.model].channels;var y=t.call(d,0,g);this.color=u(y,g),this.valpha=typeof d[g]=="number"?d[g]:1}else if(typeof d=="number")d&=16777215,this.model="rgb",this.color=[d>>16&255,d>>8&255,d&255],this.valpha=1;else{this.valpha=1;var x=Object.keys(d);"alpha"in d&&(x.splice(x.indexOf("alpha"),1),this.valpha=typeof d.alpha=="number"?d.alpha:0);var E=x.sort().join("");if(!(E in n))throw new Error("Unable to parse color from object: "+JSON.stringify(d));this.model=n[E];var A=e[this.model].labels,O=[];for(m=0;m<A.length;m++)O.push(d[A[m]]);this.color=u(O)}if(s[this.model])for(g=e[this.model].channels,m=0;m<g;m++){var R=s[this.model][m];R&&(this.color[m]=R(this.color[m]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}o.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(d){var p=this.model in r.to?this:this.rgb();p=p.round(typeof d=="number"?d:1);var m=p.valpha===1?p.color:p.color.concat(this.valpha);return r.to[p.model](m)},percentString:function(d){var p=this.rgb().round(typeof d=="number"?d:1),m=p.valpha===1?p.color:p.color.concat(this.valpha);return r.to.rgb.percent(m)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var d={},p=e[this.model].channels,m=e[this.model].labels,g=0;g<p;g++)d[m[g]]=this.color[g];return this.valpha!==1&&(d.alpha=this.valpha),d},unitArray:function(){var d=this.rgb().color;return d[0]/=255,d[1]/=255,d[2]/=255,this.valpha!==1&&d.push(this.valpha),d},unitObject:function(){var d=this.rgb().object();return d.r/=255,d.g/=255,d.b/=255,this.valpha!==1&&(d.alpha=this.valpha),d},round:function(d){return d=Math.max(d||0,0),new o(this.color.map(l(d)).concat(this.valpha),this.model)},alpha:function(d){return arguments.length?new o(this.color.concat(Math.max(0,Math.min(1,d))),this.model):this.valpha},red:h("rgb",0,c(255)),green:h("rgb",1,c(255)),blue:h("rgb",2,c(255)),hue:h(["hsl","hsv","hsl","hwb","hcg"],0,function(d){return(d%360+360)%360}),saturationl:h("hsl",1,c(100)),lightness:h("hsl",2,c(100)),saturationv:h("hsv",1,c(100)),value:h("hsv",2,c(100)),chroma:h("hcg",1,c(100)),gray:h("hcg",2,c(100)),white:h("hwb",1,c(100)),wblack:h("hwb",2,c(100)),cyan:h("cmyk",0,c(100)),magenta:h("cmyk",1,c(100)),yellow:h("cmyk",2,c(100)),black:h("cmyk",3,c(100)),x:h("xyz",0,c(100)),y:h("xyz",1,c(100)),z:h("xyz",2,c(100)),l:h("lab",0,c(100)),a:h("lab",1),b:h("lab",2),keyword:function(d){return arguments.length?new o(d):e[this.model].keyword(this.color)},hex:function(d){return arguments.length?new o(d):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var d=this.rgb().color;return(d[0]&255)<<16|(d[1]&255)<<8|d[2]&255},luminosity:function(){for(var d=this.rgb().color,p=[],m=0;m<d.length;m++){var g=d[m]/255;p[m]=g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4)}return .2126*p[0]+.7152*p[1]+.0722*p[2]},contrast:function(d){var p=this.luminosity(),m=d.luminosity();return p>m?(p+.05)/(m+.05):(m+.05)/(p+.05)},level:function(d){var p=this.contrast(d);return p>=7.1?"AAA":p>=4.5?"AA":""},isDark:function(){var d=this.rgb().color,p=(d[0]*299+d[1]*587+d[2]*114)/1e3;return p<128},isLight:function(){return!this.isDark()},negate:function(){for(var d=this.rgb(),p=0;p<3;p++)d.color[p]=255-d.color[p];return d},lighten:function(d){var p=this.hsl();return p.color[2]+=p.color[2]*d,p},darken:function(d){var p=this.hsl();return p.color[2]-=p.color[2]*d,p},saturate:function(d){var p=this.hsl();return p.color[1]+=p.color[1]*d,p},desaturate:function(d){var p=this.hsl();return p.color[1]-=p.color[1]*d,p},whiten:function(d){var p=this.hwb();return p.color[1]+=p.color[1]*d,p},blacken:function(d){var p=this.hwb();return p.color[2]+=p.color[2]*d,p},grayscale:function(){var d=this.rgb().color,p=d[0]*.3+d[1]*.59+d[2]*.11;return o.rgb(p,p,p)},fade:function(d){return this.alpha(this.valpha-this.valpha*d)},opaquer:function(d){return this.alpha(this.valpha+this.valpha*d)},rotate:function(d){var p=this.hsl(),m=p.color[0];return m=(m+d)%360,m=m<0?360+m:m,p.color[0]=m,p},mix:function(d,p){if(!d||!d.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof d);var m=d.rgb(),g=this.rgb(),b=p===void 0?.5:p,y=2*b-1,x=m.alpha()-g.alpha(),E=((y*x===-1?y:(y+x)/(1+y*x))+1)/2,A=1-E;return o.rgb(E*m.red()+A*g.red(),E*m.green()+A*g.green(),E*m.blue()+A*g.blue(),m.alpha()*b+g.alpha()*(1-b))}},Object.keys(e).forEach(function(d){if(i.indexOf(d)===-1){var p=e[d].channels;o.prototype[d]=function(){if(this.model===d)return new o(this);if(arguments.length)return new o(arguments,d);var m=typeof arguments[p]=="number"?p:this.valpha;return new o(f(e[this.model][d].raw(this.color)).concat(m),d)},o[d]=function(m){return typeof m=="number"&&(m=u(t.call(arguments),p)),new o(m,d)}}});function a(d,p){return Number(d.toFixed(p))}function l(d){return function(p){return a(p,d)}}function h(d,p,m){return d=Array.isArray(d)?d:[d],d.forEach(function(g){(s[g]||(s[g]=[]))[p]=m}),d=d[0],function(g){var b;return arguments.length?(m&&(g=m(g)),b=this[d](),b.color[p]=g,b):(b=this[d]().color[p],m&&(b=m(b)),b)}}function c(d){return function(p){return Math.max(0,Math.min(d,p))}}function f(d){return Array.isArray(d)?d:[d]}function u(d,p){for(var m=0;m<p;m++)typeof d[m]!="number"&&(d[m]=0);return d}return zo=o,zo}var r2=n2();const kf=Ka(r2);var Vo,wf;function s2(){if(wf)return Vo;wf=1;var r="Expected a function",e="__lodash_placeholder__",t=1,i=2,n=4,s=8,o=16,a=32,l=64,h=128,c=256,f=512,u=1/0,d=9007199254740991,p=17976931348623157e292,m=NaN,g=[["ary",h],["bind",t],["bindKey",i],["curry",s],["curryRight",o],["flip",f],["partial",a],["partialRight",l],["rearg",c]],b="[object Function]",y="[object GeneratorFunction]",x="[object Symbol]",E=/[\\^$.*+?()[\]{}|]/g,A=/^\s+|\s+$/g,O=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,R=/\{\n\/\* \[wrapped with (.+)\] \*/,K=/,? & /,z=/^[-+]0x[0-9a-f]+$/i,Y=/^0b[01]+$/i,W=/^\[object .+?Constructor\]$/,T=/^0o[0-7]+$/i,F=/^(?:0|[1-9]\d*)$/,V=parseInt,H=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,ae=typeof self=="object"&&self&&self.Object===Object&&self,le=H||ae||Function("return this")();function he(v,k,D){switch(D.length){case 0:return v.call(k);case 1:return v.call(k,D[0]);case 2:return v.call(k,D[0],D[1]);case 3:return v.call(k,D[0],D[1],D[2])}return v.apply(k,D)}function oe(v,k){for(var D=-1,$=v?v.length:0;++D<$&&k(v[D],D,v)!==!1;);return v}function ke(v,k){var D=v?v.length:0;return!!D&&w(v,k,0)>-1}function Te(v,k,D,$){for(var X=v.length,ee=D+-1;++ee<X;)if(k(v[ee],ee,v))return ee;return-1}function w(v,k,D){if(k!==k)return Te(v,M,D);for(var $=D-1,X=v.length;++$<X;)if(v[$]===k)return $;return-1}function M(v){return v!==v}function j(v,k){for(var D=v.length,$=0;D--;)v[D]===k&&$++;return $}function q(v,k){return v?.[k]}function G(v){var k=!1;if(v!=null&&typeof v.toString!="function")try{k=!!(v+"")}catch{}return k}function Q(v,k){for(var D=-1,$=v.length,X=0,ee=[];++D<$;){var ue=v[D];(ue===k||ue===e)&&(v[D]=e,ee[X++]=D)}return ee}var ne=Function.prototype,Z=Object.prototype,te=le["__core-js_shared__"],re=(function(){var v=/[^.]+$/.exec(te&&te.keys&&te.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""})(),ce=ne.toString,Be=Z.hasOwnProperty,He=Z.toString,gr=RegExp("^"+ce.call(Be).replace(E,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),br=Object.create,yr=Math.max,Jp=Math.min,jl=(function(){var v=zl(Object,"defineProperty"),k=zl.name;return k&&k.length>2?v:void 0})();function Yp(v){return Fi(v)?br(v):{}}function Xp(v){if(!Fi(v)||lm(v))return!1;var k=um(v)||G(v)?gr:W;return k.test(cm(v))}function Qp(v,k,D,$){for(var X=-1,ee=v.length,ue=D.length,me=-1,we=k.length,Se=yr(ee-ue,0),xe=Array(we+Se),qe=!$;++me<we;)xe[me]=k[me];for(;++X<ue;)(qe||X<ee)&&(xe[D[X]]=v[X]);for(;Se--;)xe[me++]=v[X++];return xe}function Zp(v,k,D,$){for(var X=-1,ee=v.length,ue=-1,me=D.length,we=-1,Se=k.length,xe=yr(ee-me,0),qe=Array(xe+Se),Pe=!$;++X<xe;)qe[X]=v[X];for(var it=X;++we<Se;)qe[it+we]=k[we];for(;++ue<me;)(Pe||X<ee)&&(qe[it+D[ue]]=v[X++]);return qe}function em(v,k){var D=-1,$=v.length;for(k||(k=Array($));++D<$;)k[D]=v[D];return k}function tm(v,k,D){var $=k&t,X=dn(v);function ee(){var ue=this&&this!==le&&this instanceof ee?X:v;return ue.apply($?D:this,arguments)}return ee}function dn(v){return function(){var k=arguments;switch(k.length){case 0:return new v;case 1:return new v(k[0]);case 2:return new v(k[0],k[1]);case 3:return new v(k[0],k[1],k[2]);case 4:return new v(k[0],k[1],k[2],k[3]);case 5:return new v(k[0],k[1],k[2],k[3],k[4]);case 6:return new v(k[0],k[1],k[2],k[3],k[4],k[5]);case 7:return new v(k[0],k[1],k[2],k[3],k[4],k[5],k[6])}var D=Yp(v.prototype),$=v.apply(D,k);return Fi($)?$:D}}function im(v,k,D){var $=dn(v);function X(){for(var ee=arguments.length,ue=Array(ee),me=ee,we=$l(X);me--;)ue[me]=arguments[me];var Se=ee<3&&ue[0]!==we&&ue[ee-1]!==we?[]:Q(ue,we);if(ee-=Se.length,ee<D)return Fl(v,k,qs,X.placeholder,void 0,ue,Se,void 0,void 0,D-ee);var xe=this&&this!==le&&this instanceof X?$:v;return he(xe,this,ue)}return X}function qs(v,k,D,$,X,ee,ue,me,we,Se){var xe=k&h,qe=k&t,Pe=k&i,it=k&(s|o),Us=k&f,vr=Pe?void 0:dn(v);function xr(){for(var Qt=arguments.length,nt=Array(Qt),Ks=Qt;Ks--;)nt[Ks]=arguments[Ks];if(it)var Hl=$l(xr),vm=j(nt,Hl);if($&&(nt=Qp(nt,$,X,it)),ee&&(nt=Zp(nt,ee,ue,it)),Qt-=vm,it&&Qt<Se){var xm=Q(nt,Hl);return Fl(v,k,qs,xr.placeholder,D,nt,xm,me,we,Se-Qt)}var ql=qe?D:this,Js=Pe?ql[v]:v;return Qt=nt.length,me?nt=hm(nt,me):Us&&Qt>1&&nt.reverse(),xe&&we<Qt&&(nt.length=we),this&&this!==le&&this instanceof xr&&(Js=vr||dn(Js)),Js.apply(ql,nt)}return xr}function nm(v,k,D,$){var X=k&t,ee=dn(v);function ue(){for(var me=-1,we=arguments.length,Se=-1,xe=$.length,qe=Array(xe+we),Pe=this&&this!==le&&this instanceof ue?ee:v;++Se<xe;)qe[Se]=$[Se];for(;we--;)qe[Se++]=arguments[++me];return he(Pe,X?D:this,qe)}return ue}function Fl(v,k,D,$,X,ee,ue,me,we,Se){var xe=k&s,qe=xe?ue:void 0,Pe=xe?void 0:ue,it=xe?ee:void 0,Us=xe?void 0:ee;k|=xe?a:l,k&=~(xe?l:a),k&n||(k&=-4);var vr=D(v,k,X,it,qe,Us,Pe,me,we,Se);return vr.placeholder=$,Vl(vr,v,k)}function rm(v,k,D,$,X,ee,ue,me){var we=k&i;if(!we&&typeof v!="function")throw new TypeError(r);var Se=$?$.length:0;if(Se||(k&=-97,$=X=void 0),ue=ue===void 0?ue:yr(Wl(ue),0),me=me===void 0?me:Wl(me),Se-=X?X.length:0,k&l){var xe=$,qe=X;$=X=void 0}var Pe=[v,k,D,$,X,xe,qe,ee,ue,me];if(v=Pe[0],k=Pe[1],D=Pe[2],$=Pe[3],X=Pe[4],me=Pe[9]=Pe[9]==null?we?0:v.length:yr(Pe[9]-Se,0),!me&&k&(s|o)&&(k&=-25),!k||k==t)var it=tm(v,k,D);else k==s||k==o?it=im(v,k,me):(k==a||k==(t|a))&&!X.length?it=nm(v,k,D,$):it=qs.apply(void 0,Pe);return Vl(it,v,k)}function $l(v){var k=v;return k.placeholder}function zl(v,k){var D=q(v,k);return Xp(D)?D:void 0}function sm(v){var k=v.match(R);return k?k[1].split(K):[]}function om(v,k){var D=k.length,$=D-1;return k[$]=(D>1?"& ":"")+k[$],k=k.join(D>2?", ":" "),v.replace(O,`{
/* [wrapped with `+k+`] */
`)}function am(v,k){return k=k??d,!!k&&(typeof v=="number"||F.test(v))&&v>-1&&v%1==0&&v<k}function lm(v){return!!re&&re in v}function hm(v,k){for(var D=v.length,$=Jp(k.length,D),X=em(v);$--;){var ee=k[$];v[$]=am(ee,D)?X[ee]:void 0}return v}var Vl=jl?function(v,k,D){var $=k+"";return jl(v,"toString",{configurable:!0,enumerable:!1,value:bm(om($,fm(sm($),D)))})}:ym;function cm(v){if(v!=null){try{return ce.call(v)}catch{}try{return v+""}catch{}}return""}function fm(v,k){return oe(g,function(D){var $="_."+D[0];k&D[1]&&!ke(v,$)&&v.push($)}),v.sort()}function Gs(v,k,D){k=D?void 0:k;var $=rm(v,s,void 0,void 0,void 0,void 0,void 0,k);return $.placeholder=Gs.placeholder,$}function um(v){var k=Fi(v)?He.call(v):"";return k==b||k==y}function Fi(v){var k=typeof v;return!!v&&(k=="object"||k=="function")}function dm(v){return!!v&&typeof v=="object"}function pm(v){return typeof v=="symbol"||dm(v)&&He.call(v)==x}function mm(v){if(!v)return v===0?v:0;if(v=gm(v),v===u||v===-u){var k=v<0?-1:1;return k*p}return v===v?v:0}function Wl(v){var k=mm(v),D=k%1;return k===k?D?k-D:k:0}function gm(v){if(typeof v=="number")return v;if(pm(v))return m;if(Fi(v)){var k=typeof v.valueOf=="function"?v.valueOf():v;v=Fi(k)?k+"":k}if(typeof v!="string")return v===0?v:+v;v=v.replace(A,"");var D=Y.test(v);return D||T.test(v)?V(v.slice(2),D?2:8):z.test(v)?m:+v}function bm(v){return function(){return v}}function ym(v){return v}return Gs.placeholder={},Vo=Gs,Vo}var o2=s2();const Sf=Ka(o2);function a2(r){var e=r[0],t=r[1],i=r[2],n,s,o;return n=e*1+t*0+i*1.13983,s=e*1+t*-.39465+i*-.5806,o=e*1+t*2.02311+i*0,n=Math.min(Math.max(0,n),1),s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),[n*255,s*255,o*255]}function l2(r){var e=r[0]/255,t=r[1]/255,i=r[2]/255,n=e*.299+t*.587+i*.114,s=e*-.14713+t*-.28886+i*.436,o=e*.615+t*-.51499+i*-.10001;return[n,s,o]}function Cf(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function st(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cf(Object(t),!0).forEach(function(i){Am(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Cf(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}var Up=qp,_f=Object.keys(Up),h2=function(e){return e<.25?1:e<.5?.9-e:1.1-e},c2=function(e){var t=kf(e),i=l2(t.array()),n=Hp(i,3),s=n[0],o=n[1],a=n[2],l=[h2(s),o,a],h=a2(l);return kf.rgb(h).hex()},$i=function(e){return function(t){return{className:[t.className,e.className].filter(Boolean).join(" "),style:st(st({},t.style||{}),e.style||{})}}},f2=function(e,t){if(e===void 0)return t;if(t===void 0)return e;var i=Wo(e),n=Wo(t);switch(i){case"string":switch(n){case"string":return[t,e].filter(Boolean).join(" ");case"object":return $i({className:e,style:t});case"function":return function(s){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return $i({className:e})(t.apply(void 0,[s].concat(a)))}}break;case"object":switch(n){case"string":return $i({className:t,style:e});case"object":return st(st({},t),e);case"function":return function(s){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return $i({style:e})(t.apply(void 0,[s].concat(a)))}}break;case"function":switch(n){case"string":return function(s){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return e.apply(void 0,[$i(s)({className:t})].concat(a))};case"object":return function(s){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return e.apply(void 0,[$i(s)({style:t})].concat(a))};case"function":return function(s){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return e.apply(void 0,[t.apply(void 0,[s].concat(a))].concat(a))}}}},u2=function(e,t){var i=Object.keys(t);for(var n in e)i.indexOf(n)===-1&&i.push(n);return i.reduce(function(s,o){return s[o]=f2(e[o],t[o]),s},{})},d2=function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),s=2;s<i;s++)n[s-2]=arguments[s];if(t===null)return e;Array.isArray(t)||(t=[t]);var o=t.map(function(l){return e[l]}).filter(Boolean),a=o.reduce(function(l,h){return typeof h=="string"?l.className=[l.className,h].filter(Boolean).join(" "):Wo(h)==="object"?l.style=st(st({},l.style),h):typeof h=="function"&&(l=st(st({},l),h.apply(void 0,[l].concat(n)))),l},{className:"",style:{}});return a.className||delete a.className,Object.keys(a.style).length===0&&delete a.style,a},Ga=function(e){return Object.keys(e).reduce(function(t,i){return t[i]=/^base/.test(i)?c2(e[i]):i==="scheme"?e[i]+":inverted":e[i],t},{})},p2=Sf(function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=e.defaultBase16,n=i===void 0?Up:i,s=e.base16Themes,o=s===void 0?null:s,a=m2(t,o);a&&(t=st(st({},a),t));for(var l=_f.reduce(function(m,g){return m[g]=t[g]||n[g],m},{}),h=Object.keys(t).reduce(function(m,g){return _f.indexOf(g)===-1&&(m[g]=t[g]),m},{}),c=r(l),f=u2(h,c),u=arguments.length,d=new Array(u>3?u-3:0),p=3;p<u;p++)d[p-3]=arguments[p];return Sf(d2,2).apply(void 0,[f].concat(d))},3),Kp=function(e){return!!e.extend},m2=function(e,t){if(e&&Kp(e)&&e.extend&&(e=e.extend),typeof e=="string"){var i=e.split(":"),n=Hp(i,2),s=n[0],o=n[1];t?e=t[s]:e=Jw[s],o==="inverted"&&(e=Ga(e))}return e&&Object.prototype.hasOwnProperty.call(e,"base00")?e:void 0},g2=function(e){return typeof e=="string"?"".concat(e,":inverted"):e&&Kp(e)&&e.extend?typeof e.extend=="string"?st(st({},e),{},{extend:"".concat(e.extend,":inverted")}):st(st({},e),{},{extend:Ga(e.extend)}):e&&Ga(e)};const b2={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},y2=r=>({BACKGROUND_COLOR:r.base00,TEXT_COLOR:r.base07,STRING_COLOR:r.base0B,DATE_COLOR:r.base0B,NUMBER_COLOR:r.base09,BOOLEAN_COLOR:r.base09,NULL_COLOR:r.base08,UNDEFINED_COLOR:r.base08,FUNCTION_COLOR:r.base08,SYMBOL_COLOR:r.base08,LABEL_COLOR:r.base0D,ARROW_COLOR:r.base0D,ITEM_STRING_COLOR:r.base0B,ITEM_STRING_EXPANDED_COLOR:r.base03}),v2=r=>({String:r.STRING_COLOR,Date:r.DATE_COLOR,Number:r.NUMBER_COLOR,Boolean:r.BOOLEAN_COLOR,Null:r.NULL_COLOR,Undefined:r.UNDEFINED_COLOR,Function:r.FUNCTION_COLOR,Symbol:r.SYMBOL_COLOR}),x2=r=>{const e=y2(r);return{tree:{border:0,padding:0,marginTop:"0.5em",marginBottom:"0.5em",marginLeft:"0.125em",marginRight:0,listStyle:"none",MozUserSelect:"none",WebkitUserSelect:"none",backgroundColor:e.BACKGROUND_COLOR},value:(t,i,n)=>{let{style:s}=t;return{style:{...s,paddingTop:"0.25em",paddingRight:0,marginLeft:"0.875em",WebkitUserSelect:"text",MozUserSelect:"text",wordWrap:"break-word",paddingLeft:n.length>1?"2.125em":"1.25em",textIndent:"-0.5em",wordBreak:"break-all"}}},label:{display:"inline-block",color:e.LABEL_COLOR},valueLabel:{margin:"0 0.5em 0 0"},valueText:(t,i)=>{let{style:n}=t;return{style:{...n,color:v2(e)[i]}}},itemRange:(t,i)=>({style:{paddingTop:i?0:"0.25em",cursor:"pointer",color:e.LABEL_COLOR}}),arrow:(t,i,n)=>{let{style:s}=t;return{style:{...s,marginLeft:0,transition:"150ms",WebkitTransition:"150ms",MozTransition:"150ms",WebkitTransform:n?"rotateZ(90deg)":"rotateZ(0deg)",MozTransform:n?"rotateZ(90deg)":"rotateZ(0deg)",transform:n?"rotateZ(90deg)":"rotateZ(0deg)",transformOrigin:"45% 50%",WebkitTransformOrigin:"45% 50%",MozTransformOrigin:"45% 50%",position:"relative",lineHeight:"1.1em",fontSize:"0.75em"}}},arrowContainer:(t,i)=>{let{style:n}=t;return{style:{...n,display:"inline-block",paddingRight:"0.5em",paddingLeft:i==="double"?"1em":0,cursor:"pointer"}}},arrowSign:{color:e.ARROW_COLOR},arrowSignInner:{position:"absolute",top:0,left:"-0.4em"},nestedNode:(t,i,n,s,o)=>{let{style:a}=t;return{style:{...a,position:"relative",paddingTop:"0.25em",marginLeft:i.length>1?"0.875em":0,paddingLeft:o?0:"1.125em"}}},rootNode:{padding:0,margin:0},nestedNodeLabel:(t,i,n,s,o)=>{let{style:a}=t;return{style:{...a,margin:0,padding:0,WebkitUserSelect:o?"inherit":"text",MozUserSelect:o?"inherit":"text",cursor:o?"pointer":"default"}}},nestedNodeItemString:(t,i,n,s)=>{let{style:o}=t;return{style:{...o,paddingLeft:"0.5em",cursor:"default",color:s?e.ITEM_STRING_EXPANDED_COLOR:e.ITEM_STRING_COLOR}}},nestedNodeItemType:{marginLeft:"0.3em",marginRight:"0.3em"},nestedNodeChildren:(t,i,n)=>{let{style:s}=t;return{style:{...s,padding:0,margin:0,listStyle:"none",display:n?"block":"none"}}},rootNodeChildren:{padding:0,margin:0,listStyle:"none"}}},k2=p2(x2,{defaultBase16:b2}),Af=r=>r,w2=(r,e,t)=>t===0,S2=(r,e,t,i)=>B.createElement("span",null,t," ",i),C2=r=>{let[e]=r;return B.createElement("span",null,e,":")},_2=()=>!1;function A2(r){let{data:e,theme:t,invertTheme:i,keyPath:n=["root"],labelRenderer:s=C2,valueRenderer:o=Af,shouldExpandNodeInitially:a=w2,hideRoot:l=!1,getItemString:h=S2,postprocessValue:c=Af,isCustomNode:f=_2,collectionLimit:u=50,sortObjectKeys:d=!1}=r;const p=Ze.useMemo(()=>k2(i?g2(t):t),[t,i]);return B.createElement("ul",p("tree"),B.createElement(Wp,{keyPath:l?[]:n,value:c(e),isCustomNode:f,styling:p,labelRenderer:s,valueRenderer:o,shouldExpandNodeInitially:a,hideRoot:l,getItemString:h,postprocessValue:c,collectionLimit:u,sortObjectKeys:d}))}function wi(r){var e;return(e=Hs.style([r]))!==null&&e!==void 0?e:""}class T2 extends Ze.Component{constructor(){super(...arguments),this.state={filter:"",value:""},this.timer=0,this.handleChange=e=>{const{value:t}=e.target;this.setState({value:t}),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.setState({filter:t})},300)}}componentDidMount(){Jt.mount(document,Hs.module)}render(){const t=(this.props.translator||Os).load("jupyterlab"),{data:i,metadata:n,forwardedRef:s}=this.props,o=n&&n.root?n.root:"root",a=this.state.filter?Ua(i,this.state.filter,[o]):[o];return Ze.createElement("div",{className:"container",ref:s},Ze.createElement(Km,{className:"filter",type:"text",placeholder:t.__("Find"),onChange:this.handleChange,value:this.state.value,rightIcon:"ui-components:search"}),Ze.createElement(A2,{data:i,collectionLimit:100,theme:{extend:E2,valueLabel:wi(C.variableName),valueText:wi(C.string),nestedNodeItemString:wi(C.comment)},invertTheme:!1,keyPath:[o],getItemString:(l,h,c,f)=>Array.isArray(h)?Ze.createElement("span",null,c," ",f):Object.keys(h).length===0?Ze.createElement("span",null,c):null,labelRenderer:([l,h])=>Ze.createElement("span",{className:wi(C.keyword)},Ze.createElement(ff,{searchWords:[this.state.filter],textToHighlight:`${l}`,highlightClassName:"jp-mod-selected"})),valueRenderer:l=>{let h=wi(C.string);return typeof l=="number"&&(h=wi(C.number)),(l==="true"||l==="false")&&(h=wi(C.keyword)),Ze.createElement("span",{className:h},Ze.createElement(ff,{searchWords:[this.state.filter],textToHighlight:`${l}`,highlightClassName:"jp-mod-selected"}))},shouldExpandNodeInitially:(l,h,c)=>n&&n.expanded?!0:a.join(",").includes(l.join(","))}))}}const E2={scheme:"jupyter",base00:"invalid",base01:"invalid",base02:"invalid",base03:"invalid",base04:"invalid",base05:"invalid",base06:"invalid",base07:"invalid",base08:"invalid",base09:"invalid",base0A:"invalid",base0B:"invalid",base0C:"invalid",base0D:"invalid",base0E:"invalid",base0F:"invalid",author:"invalid"};function Tf(r,e){return JSON.stringify(r).includes(e)}function Ua(r,e,t=["root"]){return $n.isArray(r)?r.reduce((i,n,s)=>n&&typeof n=="object"&&Tf(n,e)?[...i,[s,...t].join(","),...Ua(n,e,[s,...t])]:i,[]):$n.isObject(r)?Object.keys(r).reduce((i,n)=>{const s=r[n];return s&&typeof s=="object"&&(n.includes(e)||Tf(s,e))?[...i,[n,...t].join(","),...Ua(s,e,[n,...t])]:i},[]):[]}const J2=Object.freeze(Object.defineProperty({__proto__:null,Component:T2},Symbol.toStringTag,{value:"Module"}));export{hn as A,I1 as B,U2 as C,Bi as D,G2 as E,Hi as F,ln as G,Oi as H,ye as I,z2 as J,ie as K,ps as L,ul as M,R2 as N,on as O,fl as P,J2 as Q,pt as T,Cs as a,Xr as b,j2 as c,W2 as d,V2 as e,N1 as f,De as g,N2 as h,gd as i,F2 as j,B2 as k,_p as l,N as m,_ as n,ny as o,D2 as p,H2 as q,S1 as r,v1 as s,C as t,pd as u,Xe as v,U as w,Bs as x,pe as y,yt as z};
